

============================== 2024-02-08 14:23:56.391417 | 17cbd183-99dc-4b04-8e82-06e7d88dba1d ==============================
[0m14:23:56.391417 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:23:56.397375 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:23:56.400493 [debug] [MainThread]: Tracking: tracking
[0m14:23:56.407796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f417d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f417d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f417d390>]}
[0m14:23:56.461094 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:23:56.478040 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:23:56.482744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '17cbd183-99dc-4b04-8e82-06e7d88dba1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f417ded0>]}
[0m14:23:59.099660 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m14:23:59.136243 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m14:23:59.152639 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m14:23:59.174489 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m14:23:59.590934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17cbd183-99dc-4b04-8e82-06e7d88dba1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f2898b20>]}
[0m14:23:59.645318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17cbd183-99dc-4b04-8e82-06e7d88dba1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f417fdf0>]}
[0m14:23:59.649205 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:23:59.653337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17cbd183-99dc-4b04-8e82-06e7d88dba1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f417fcd0>]}
[0m14:23:59.660501 [info ] [MainThread]: 
[0m14:23:59.669100 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:23:59.675466 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:23:59.717944 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:23:59.722235 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:23:59.725085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:59.813027 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m14:23:59.820029 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:23:59.828011 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:23:59.844545 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:23:59.847553 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:23:59.850625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:59.907939 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:23:59.910709 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:23:59.913435 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:23:59.924833 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m14:23:59.930949 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:23:59.940725 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:23:59.970252 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:59.973868 [debug] [MainThread]: On master: BEGIN
[0m14:23:59.978228 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:00.060141 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:24:00.063111 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:00.066456 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:24:00.083019 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:24:00.090459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17cbd183-99dc-4b04-8e82-06e7d88dba1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f28df8b0>]}
[0m14:24:00.095467 [debug] [MainThread]: On master: ROLLBACK
[0m14:24:00.107403 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:00.112124 [debug] [MainThread]: On master: BEGIN
[0m14:24:00.133770 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:24:00.139025 [debug] [MainThread]: On master: COMMIT
[0m14:24:00.143380 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:00.147765 [debug] [MainThread]: On master: COMMIT
[0m14:24:00.161509 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:24:00.171404 [debug] [MainThread]: On master: Close
[0m14:24:00.178518 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:24:00.190460 [info ] [MainThread]: 
[0m14:24:00.255216 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m14:24:00.258602 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m14:24:00.264464 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m14:24:00.271299 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m14:24:00.284819 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m14:24:00.357106 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 14:24:00.274228 => 2024-02-08 14:24:00.356550
[0m14:24:00.361767 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m14:24:00.512050 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m14:24:00.570265 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:24:00.574095 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m14:24:00.578240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:00.628303 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:24:00.632139 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:24:00.635329 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:24:00.651482 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:24:00.688780 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:24:00.694014 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m14:24:00.710282 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:24:00.723753 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:24:00.726974 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:24:00.737937 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:24:00.806803 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m14:24:00.809835 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:24:00.813219 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m14:24:00.840417 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:24:00.857797 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:24:00.866259 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m14:24:00.902217 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:24:00.910574 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 14:24:00.366022 => 2024-02-08 14:24:00.910307
[0m14:24:00.914713 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m14:24:00.924257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cbd183-99dc-4b04-8e82-06e7d88dba1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f2849b70>]}
[0m14:24:00.930760 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.66s]
[0m14:24:00.943211 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m14:24:00.948856 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m14:24:00.954122 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m14:24:00.966924 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m14:24:00.979004 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m14:24:01.009752 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m14:24:01.075702 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 14:24:00.993082 => 2024-02-08 14:24:01.075108
[0m14:24:01.081749 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m14:24:01.124000 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m14:24:01.160123 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:24:01.164482 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m14:24:01.169583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:01.236218 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:24:01.240332 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:24:01.244281 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:24:01.255497 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:24:01.281971 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:24:01.289167 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m14:24:01.300319 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:24:01.322433 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:24:01.326241 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:24:01.337634 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:24:01.346846 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m14:24:01.351249 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:24:01.355442 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m14:24:01.377814 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:24:01.391140 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:24:01.400904 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m14:24:01.422015 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:24:01.433680 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 14:24:01.086749 => 2024-02-08 14:24:01.433350
[0m14:24:01.439269 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m14:24:01.448751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cbd183-99dc-4b04-8e82-06e7d88dba1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f05f6b30>]}
[0m14:24:01.456503 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.48s]
[0m14:24:01.464555 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m14:24:01.475818 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m14:24:01.485409 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m14:24:01.500344 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m14:24:01.507452 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m14:24:01.527504 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m14:24:01.578660 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 14:24:01.513331 => 2024-02-08 14:24:01.578087
[0m14:24:01.583642 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m14:24:01.628716 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m14:24:01.664192 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:24:01.669620 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m14:24:01.673224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:01.719480 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:24:01.722749 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:24:01.725960 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:24:01.737229 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:24:01.754812 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:24:01.758729 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m14:24:01.768380 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:24:01.781981 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:24:01.788606 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:24:01.798077 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:24:01.810276 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m14:24:01.813390 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:24:01.817145 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m14:24:01.830869 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:24:01.840536 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:24:01.843948 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m14:24:01.860629 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:24:01.867262 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 14:24:01.591335 => 2024-02-08 14:24:01.867077
[0m14:24:01.870112 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m14:24:01.875460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cbd183-99dc-4b04-8e82-06e7d88dba1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f28d2c50>]}
[0m14:24:01.880803 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.38s]
[0m14:24:01.885615 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m14:24:01.892078 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m14:24:01.895016 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m14:24:01.900433 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_ratings'
[0m14:24:01.904440 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_ratings
[0m14:24:01.920110 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_ratings"
[0m14:24:01.942992 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (compile): 2024-02-08 14:24:01.908032 => 2024-02-08 14:24:01.942612
[0m14:24:01.946272 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_ratings
[0m14:24:01.971994 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_ratings"
[0m14:24:01.996369 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m14:24:01.999928 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: BEGIN
[0m14:24:02.003688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:02.053710 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:24:02.056460 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m14:24:02.059712 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excelent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.acotr_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m14:24:02.068703 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.acotr_id does not exist
LINE 32: ...tination_db"."public"."actors" a ON fa.actor_id = a.acotr_id
                                                              ^
HINT:  Perhaps you meant to reference the column "a.actor_id".

[0m14:24:02.073312 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: ROLLBACK
[0m14:24:02.084386 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (execute): 2024-02-08 14:24:01.950363 => 2024-02-08 14:24:02.083889
[0m14:24:02.091086 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: Close
[0m14:24:02.100129 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  column a.acotr_id does not exist
  LINE 32: ...tination_db"."public"."actors" a ON fa.actor_id = a.acotr_id
                                                                ^
  HINT:  Perhaps you meant to reference the column "a.actor_id".
  compiled Code at target/run/Custom_postgres/models/example/film_ratings.sql
[0m14:24:02.108650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cbd183-99dc-4b04-8e82-06e7d88dba1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f0630d60>]}
[0m14:24:02.112502 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.21s]
[0m14:24:02.116982 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m14:24:02.127685 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:24:02.130599 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:02.135006 [debug] [MainThread]: On master: BEGIN
[0m14:24:02.139393 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:24:02.196844 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:24:02.201218 [debug] [MainThread]: On master: COMMIT
[0m14:24:02.206635 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:02.210835 [debug] [MainThread]: On master: COMMIT
[0m14:24:02.220623 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:24:02.224891 [debug] [MainThread]: On master: Close
[0m14:24:02.230305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:02.236761 [debug] [MainThread]: Connection 'model.Custom_postgres.film_ratings' was properly closed.
[0m14:24:02.242474 [info ] [MainThread]: 
[0m14:24:02.247337 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 2.58 seconds (2.58s).
[0m14:24:02.253024 [debug] [MainThread]: Command end result
[0m14:24:02.319925 [info ] [MainThread]: 
[0m14:24:02.325360 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:24:02.330360 [info ] [MainThread]: 
[0m14:24:02.336509 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m14:24:02.342416 [error] [MainThread]:   column a.acotr_id does not exist
[0m14:24:02.347380 [error] [MainThread]:   LINE 32: ...tination_db"."public"."actors" a ON fa.actor_id = a.acotr_id
[0m14:24:02.354599 [error] [MainThread]:                                                                 ^
[0m14:24:02.360744 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "a.actor_id".
[0m14:24:02.365591 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/film_ratings.sql
[0m14:24:02.372344 [info ] [MainThread]: 
[0m14:24:02.378173 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m14:24:02.384870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f414d960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f064beb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f064bee0>]}
[0m14:24:02.388765 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 14:28:19.165498 | d7a68998-8a04-476c-bd56-bff9cd45836b ==============================
[0m14:28:19.165498 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:28:19.173115 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:28:19.177128 [debug] [MainThread]: Tracking: tracking
[0m14:28:19.185508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b1c7d360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b1c7d7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b1c7d3c0>]}
[0m14:28:19.275979 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:28:19.901109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:28:19.904797 [debug] [MainThread]: Partial parsing: updated file: Custom_postgres://models/example/film_ratings.sql
[0m14:28:19.955075 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m14:28:20.129592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7a68998-8a04-476c-bd56-bff9cd45836b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b0401600>]}
[0m14:28:20.177552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7a68998-8a04-476c-bd56-bff9cd45836b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b1c4e650>]}
[0m14:28:20.183106 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:28:20.187170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7a68998-8a04-476c-bd56-bff9cd45836b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b1c963b0>]}
[0m14:28:20.194184 [info ] [MainThread]: 
[0m14:28:20.204162 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:28:20.211846 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:28:20.248557 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:28:20.252037 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:28:20.254677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:20.321595 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m14:28:20.329545 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:28:20.340107 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:28:20.365773 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:28:20.369803 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:28:20.375644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:20.418596 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:28:20.421284 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:28:20.424495 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:28:20.440307 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m14:28:20.450538 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:28:20.460385 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:28:20.488946 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:20.493073 [debug] [MainThread]: On master: BEGIN
[0m14:28:20.497535 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:20.543680 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:28:20.547012 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:20.549258 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:28:20.568432 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:28:20.574452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7a68998-8a04-476c-bd56-bff9cd45836b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af44c850>]}
[0m14:28:20.583917 [debug] [MainThread]: On master: ROLLBACK
[0m14:28:20.593090 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:20.597970 [debug] [MainThread]: On master: BEGIN
[0m14:28:20.613668 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:28:20.616775 [debug] [MainThread]: On master: COMMIT
[0m14:28:20.619636 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:20.621870 [debug] [MainThread]: On master: COMMIT
[0m14:28:20.629906 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:28:20.634123 [debug] [MainThread]: On master: Close
[0m14:28:20.638868 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:28:20.645084 [info ] [MainThread]: 
[0m14:28:20.697318 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m14:28:20.700850 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m14:28:20.705436 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m14:28:20.708134 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m14:28:20.719312 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m14:28:20.733865 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 14:28:20.710700 => 2024-02-08 14:28:20.733487
[0m14:28:20.736517 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m14:28:20.845957 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m14:28:20.862382 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:28:20.864684 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m14:28:20.866875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:20.906079 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:28:20.909147 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:28:20.912093 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:28:20.922360 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:28:20.943104 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:28:20.947301 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m14:28:20.956259 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:28:20.967213 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:28:20.970247 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:28:20.982804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:28:21.032760 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m14:28:21.036131 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:28:21.038887 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m14:28:21.050861 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:28:21.063898 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:28:21.067108 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m14:28:21.088385 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:28:21.093835 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 14:28:20.740615 => 2024-02-08 14:28:21.093692
[0m14:28:21.097163 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m14:28:21.101166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7a68998-8a04-476c-bd56-bff9cd45836b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af4c2890>]}
[0m14:28:21.105149 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.40s]
[0m14:28:21.112891 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m14:28:21.116269 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m14:28:21.119519 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m14:28:21.125546 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m14:28:21.129132 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m14:28:21.141194 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m14:28:21.169250 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 14:28:21.131997 => 2024-02-08 14:28:21.168892
[0m14:28:21.173199 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m14:28:21.189770 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m14:28:21.213268 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:28:21.216079 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m14:28:21.218462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:21.256472 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:28:21.259595 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:28:21.262071 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:28:21.271202 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:28:21.285748 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:28:21.289773 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m14:28:21.299318 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:28:21.312139 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:28:21.315393 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:28:21.323519 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:28:21.331381 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m14:28:21.334311 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:28:21.337242 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m14:28:21.349026 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:28:21.356800 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:28:21.360287 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m14:28:21.373877 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:28:21.379727 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 14:28:21.176750 => 2024-02-08 14:28:21.379565
[0m14:28:21.383601 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m14:28:21.388227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7a68998-8a04-476c-bd56-bff9cd45836b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af4c2c20>]}
[0m14:28:21.392560 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.26s]
[0m14:28:21.396936 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m14:28:21.400233 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m14:28:21.403323 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m14:28:21.408550 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m14:28:21.411436 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m14:28:21.420334 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m14:28:21.449549 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 14:28:21.414978 => 2024-02-08 14:28:21.449222
[0m14:28:21.452266 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m14:28:21.467571 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m14:28:21.488943 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:28:21.491960 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m14:28:21.494889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:21.536704 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:28:21.539494 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:28:21.541809 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:28:21.551529 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:28:21.562359 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:28:21.567314 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m14:28:21.576342 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:28:21.588775 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:28:21.592409 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:28:21.601631 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:28:21.608582 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m14:28:21.611796 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:28:21.615142 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m14:28:21.626548 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:28:21.633795 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:28:21.636013 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m14:28:21.649514 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:28:21.654777 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 14:28:21.456414 => 2024-02-08 14:28:21.654630
[0m14:28:21.657305 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m14:28:21.661512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7a68998-8a04-476c-bd56-bff9cd45836b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af33cc70>]}
[0m14:28:21.668428 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.25s]
[0m14:28:21.672561 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m14:28:21.677641 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m14:28:21.680723 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m14:28:21.685021 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_ratings'
[0m14:28:21.687860 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_ratings
[0m14:28:21.698446 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_ratings"
[0m14:28:21.725729 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (compile): 2024-02-08 14:28:21.690165 => 2024-02-08 14:28:21.725077
[0m14:28:21.734159 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_ratings
[0m14:28:21.796765 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_ratings"
[0m14:28:21.820405 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m14:28:21.824400 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: BEGIN
[0m14:28:21.830108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:21.866997 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:28:21.869432 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m14:28:21.871395 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excelent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m14:28:21.899365 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:28:21.907296 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m14:28:21.911509 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m14:28:21.920898 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:28:21.930482 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: COMMIT
[0m14:28:21.933238 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m14:28:21.935720 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: COMMIT
[0m14:28:21.947504 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:28:21.954564 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m14:28:21.957467 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m14:28:21.964662 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:28:21.970099 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (execute): 2024-02-08 14:28:21.776275 => 2024-02-08 14:28:21.969949
[0m14:28:21.972658 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: Close
[0m14:28:21.976768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7a68998-8a04-476c-bd56-bff9cd45836b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af385d20>]}
[0m14:28:21.980434 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.29s]
[0m14:28:21.985289 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m14:28:21.991591 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:28:21.994244 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:21.997023 [debug] [MainThread]: On master: BEGIN
[0m14:28:21.999429 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:28:22.048944 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:28:22.051290 [debug] [MainThread]: On master: COMMIT
[0m14:28:22.053381 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:22.055653 [debug] [MainThread]: On master: COMMIT
[0m14:28:22.063086 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:28:22.066525 [debug] [MainThread]: On master: Close
[0m14:28:22.069933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:22.072693 [debug] [MainThread]: Connection 'model.Custom_postgres.film_ratings' was properly closed.
[0m14:28:22.076038 [info ] [MainThread]: 
[0m14:28:22.080807 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.88 seconds (1.88s).
[0m14:28:22.085920 [debug] [MainThread]: Command end result
[0m14:28:22.136761 [info ] [MainThread]: 
[0m14:28:22.145599 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:28:22.151772 [info ] [MainThread]: 
[0m14:28:22.156680 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:28:22.163561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af385d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af3660b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af367dc0>]}
[0m14:28:22.168246 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 14:38:48.131467 | 6052b568-e858-4f95-b40e-19e1e9a13249 ==============================
[0m14:38:48.131467 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:38:48.138078 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:38:48.141570 [debug] [MainThread]: Tracking: tracking
[0m14:38:48.148750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f710c701360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f710c7017e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f710c7013c0>]}
[0m14:38:48.227329 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:38:48.711205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:38:48.715795 [debug] [MainThread]: Partial parsing: added file: Custom_postgres://macros/film_ratings_macro.sql
[0m14:38:48.747376 [debug] [MainThread]: Partial parsing: updated file: Custom_postgres://models/example/film_ratings.sql
[0m14:38:48.797214 [debug] [MainThread]: 1603: static parser failed on example/film_ratings.sql
[0m14:38:48.830933 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/film_ratings.sql
[0m14:38:48.976619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6052b568-e858-4f95-b40e-19e1e9a13249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7109ca7eb0>]}
[0m14:38:49.034339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6052b568-e858-4f95-b40e-19e1e9a13249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f710c6d25c0>]}
[0m14:38:49.038546 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:38:49.043421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6052b568-e858-4f95-b40e-19e1e9a13249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f710c71a3b0>]}
[0m14:38:49.050469 [info ] [MainThread]: 
[0m14:38:49.058352 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:38:49.068073 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:38:49.099561 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:38:49.102501 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:38:49.105820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:49.150012 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m14:38:49.154842 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:38:49.162715 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:38:49.177992 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:38:49.181286 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:38:49.184020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:38:49.227723 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:38:49.231722 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:38:49.260386 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:38:49.276776 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m14:38:49.283486 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:38:49.291549 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:38:49.315267 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:49.318492 [debug] [MainThread]: On master: BEGIN
[0m14:38:49.321023 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:38:49.361663 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:38:49.364837 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:49.367045 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:38:49.384923 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:38:49.392398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6052b568-e858-4f95-b40e-19e1e9a13249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7109ccf4c0>]}
[0m14:38:49.395642 [debug] [MainThread]: On master: ROLLBACK
[0m14:38:49.406236 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:49.409995 [debug] [MainThread]: On master: BEGIN
[0m14:38:49.423274 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:38:49.426324 [debug] [MainThread]: On master: COMMIT
[0m14:38:49.429325 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:49.434147 [debug] [MainThread]: On master: COMMIT
[0m14:38:49.441657 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:38:49.444708 [debug] [MainThread]: On master: Close
[0m14:38:49.449419 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:38:49.454427 [info ] [MainThread]: 
[0m14:38:49.528353 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m14:38:49.532870 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m14:38:49.537261 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m14:38:49.539525 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m14:38:49.552087 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m14:38:49.573147 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 14:38:49.541773 => 2024-02-08 14:38:49.572742
[0m14:38:49.576871 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m14:38:49.667098 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m14:38:49.686698 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:38:49.689369 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m14:38:49.691840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:49.734233 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:38:49.737140 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:38:49.739740 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:38:49.764138 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:38:49.808655 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:38:49.811412 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m14:38:49.822847 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:38:49.838075 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:38:49.841642 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:38:49.850652 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:38:49.913510 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m14:38:49.915926 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:38:49.918332 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m14:38:49.928837 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:38:49.943668 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:38:49.946524 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m14:38:49.961920 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:38:49.967717 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 14:38:49.579070 => 2024-02-08 14:38:49.967561
[0m14:38:49.970752 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m14:38:49.976207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6052b568-e858-4f95-b40e-19e1e9a13249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f710c71bc10>]}
[0m14:38:49.980945 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.44s]
[0m14:38:49.989215 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m14:38:49.993019 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m14:38:49.997893 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m14:38:50.005144 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m14:38:50.008529 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m14:38:50.059370 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m14:38:50.081424 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 14:38:50.050159 => 2024-02-08 14:38:50.080999
[0m14:38:50.086040 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m14:38:50.101585 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m14:38:50.117251 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:38:50.119651 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m14:38:50.122100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:50.160894 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:38:50.163944 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:38:50.166812 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:38:50.177304 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:38:50.187769 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:38:50.192036 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m14:38:50.202625 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:38:50.212157 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:38:50.216737 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:38:50.226613 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:38:50.236204 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m14:38:50.239010 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:38:50.241578 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m14:38:50.254100 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:38:50.272669 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:38:50.284297 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m14:38:50.298654 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:38:50.303734 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 14:38:50.088378 => 2024-02-08 14:38:50.303597
[0m14:38:50.306424 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m14:38:50.310418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6052b568-e858-4f95-b40e-19e1e9a13249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7109d5ac80>]}
[0m14:38:50.314357 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.31s]
[0m14:38:50.318395 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m14:38:50.321905 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m14:38:50.324751 [info ] [Thread-1 (]: 3 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m14:38:50.330170 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_ratings'
[0m14:38:50.334533 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_ratings
[0m14:38:50.351708 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (compile): 2024-02-08 14:38:50.337581 => 2024-02-08 14:38:50.350961
[0m14:38:50.366789 [debug] [Thread-1 (]: Compilation Error in model film_ratings (models/example/film_ratings.sql)
  'generate_film_ratings' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:38:50.373223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6052b568-e858-4f95-b40e-19e1e9a13249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f710ae42a70>]}
[0m14:38:50.378735 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.04s]
[0m14:38:50.385746 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m14:38:50.391536 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m14:38:50.396475 [info ] [Thread-1 (]: 4 of 4 START sql table model public.films ...................................... [RUN]
[0m14:38:50.404348 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m14:38:50.409381 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m14:38:50.434226 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m14:38:50.534007 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 14:38:50.412206 => 2024-02-08 14:38:50.533082
[0m14:38:50.545132 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m14:38:50.560197 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m14:38:50.575858 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:38:50.578100 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m14:38:50.580079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:50.618424 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:38:50.620897 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:38:50.623115 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:38:50.631665 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:38:50.641027 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:38:50.645069 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m14:38:50.656141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:38:50.665420 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:38:50.669093 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:38:50.676882 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:38:50.686900 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m14:38:50.689334 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:38:50.691143 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m14:38:50.706125 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:38:50.714624 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:38:50.716865 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m14:38:50.730449 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:38:50.735836 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 14:38:50.548048 => 2024-02-08 14:38:50.735679
[0m14:38:50.738540 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m14:38:50.742289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6052b568-e858-4f95-b40e-19e1e9a13249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7109d35cf0>]}
[0m14:38:50.746307 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.34s]
[0m14:38:50.750771 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m14:38:50.757434 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:38:50.761003 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:50.765153 [debug] [MainThread]: On master: BEGIN
[0m14:38:50.768918 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:38:50.841534 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:38:50.844245 [debug] [MainThread]: On master: COMMIT
[0m14:38:50.846730 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:50.849289 [debug] [MainThread]: On master: COMMIT
[0m14:38:50.856199 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:38:50.858609 [debug] [MainThread]: On master: Close
[0m14:38:50.862031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:50.865540 [debug] [MainThread]: Connection 'model.Custom_postgres.films' was properly closed.
[0m14:38:50.870850 [info ] [MainThread]: 
[0m14:38:50.875638 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.82 seconds (1.82s).
[0m14:38:50.882370 [debug] [MainThread]: Command end result
[0m14:38:50.938594 [info ] [MainThread]: 
[0m14:38:50.943703 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:38:50.953556 [info ] [MainThread]: 
[0m14:38:50.959324 [error] [MainThread]: [33mCompilation Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m14:38:50.965217 [error] [MainThread]:   'generate_film_ratings' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:38:50.971530 [info ] [MainThread]: 
[0m14:38:50.976318 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m14:38:50.984623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7109c4f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7109c4fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7109c4f280>]}
[0m14:38:50.990231 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 14:39:44.515178 | 84504dac-2ed4-4100-a4f6-c9102d80b336 ==============================
[0m14:39:44.515178 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:39:44.521647 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:39:44.524794 [debug] [MainThread]: Tracking: tracking
[0m14:39:44.530656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08f18d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08f18d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08f18d390>]}
[0m14:39:44.577934 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:39:45.013669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:39:45.016382 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:39:45.033483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84504dac-2ed4-4100-a4f6-c9102d80b336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08d8d0c10>]}
[0m14:39:45.079157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84504dac-2ed4-4100-a4f6-c9102d80b336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08d81a260>]}
[0m14:39:45.083504 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:39:45.087228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84504dac-2ed4-4100-a4f6-c9102d80b336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08d81a290>]}
[0m14:39:45.094014 [info ] [MainThread]: 
[0m14:39:45.102327 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:39:45.108141 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:39:45.135576 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:39:45.139574 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:39:45.142760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:45.189262 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m14:39:45.195333 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:39:45.202731 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:39:45.218537 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:39:45.221480 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:39:45.224587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:45.265328 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:39:45.268116 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:39:45.271547 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:39:45.283475 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m14:39:45.289990 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:39:45.299947 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:39:45.318564 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:45.322871 [debug] [MainThread]: On master: BEGIN
[0m14:39:45.326636 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:39:45.372209 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:39:45.375145 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:45.378600 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:39:45.397479 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:39:45.404033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84504dac-2ed4-4100-a4f6-c9102d80b336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08d71b8b0>]}
[0m14:39:45.407743 [debug] [MainThread]: On master: ROLLBACK
[0m14:39:45.416151 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:45.419116 [debug] [MainThread]: On master: BEGIN
[0m14:39:45.431762 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:39:45.435520 [debug] [MainThread]: On master: COMMIT
[0m14:39:45.438296 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:45.441005 [debug] [MainThread]: On master: COMMIT
[0m14:39:45.448695 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:39:45.451963 [debug] [MainThread]: On master: Close
[0m14:39:45.456596 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:39:45.461602 [info ] [MainThread]: 
[0m14:39:45.503019 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m14:39:45.506864 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m14:39:45.511465 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m14:39:45.516626 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m14:39:45.524574 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m14:39:45.551611 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 14:39:45.519073 => 2024-02-08 14:39:45.551091
[0m14:39:45.554822 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m14:39:45.640230 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m14:39:45.660856 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:39:45.663606 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m14:39:45.666397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:45.708488 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:39:45.711353 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:39:45.714298 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:39:45.724200 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:39:45.743911 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:39:45.748767 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m14:39:45.757408 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:39:45.767739 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:39:45.770465 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:39:45.777235 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:39:45.827400 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m14:39:45.830589 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:39:45.833452 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m14:39:45.847756 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:39:45.860316 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:39:45.863456 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m14:39:45.877600 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:39:45.883403 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 14:39:45.557087 => 2024-02-08 14:39:45.883248
[0m14:39:45.886020 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m14:39:45.890745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84504dac-2ed4-4100-a4f6-c9102d80b336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08d790cd0>]}
[0m14:39:45.894962 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.38s]
[0m14:39:45.902097 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m14:39:45.905659 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m14:39:45.908470 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m14:39:45.912932 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m14:39:45.916012 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m14:39:45.926332 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m14:39:45.951389 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 14:39:45.919637 => 2024-02-08 14:39:45.951040
[0m14:39:45.954675 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m14:39:45.968536 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m14:39:45.988511 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:39:45.990725 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m14:39:45.993297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:46.033192 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:39:46.036130 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:39:46.038638 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:39:46.048652 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:39:46.059218 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:39:46.063090 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m14:39:46.073524 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:39:46.085972 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:39:46.089124 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:39:46.097948 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:39:46.106925 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m14:39:46.109603 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:39:46.112646 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m14:39:46.124207 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:39:46.131521 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:39:46.134556 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m14:39:46.147829 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:39:46.154983 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 14:39:45.958393 => 2024-02-08 14:39:46.154818
[0m14:39:46.157657 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m14:39:46.162812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84504dac-2ed4-4100-a4f6-c9102d80b336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08d790940>]}
[0m14:39:46.167145 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.25s]
[0m14:39:46.172103 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m14:39:46.175145 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m14:39:46.178557 [info ] [Thread-1 (]: 3 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m14:39:46.185889 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_ratings'
[0m14:39:46.190350 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_ratings
[0m14:39:46.208098 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (compile): 2024-02-08 14:39:46.194050 => 2024-02-08 14:39:46.207868
[0m14:39:46.215401 [debug] [Thread-1 (]: Compilation Error in model film_ratings (models/example/film_ratings.sql)
  'generate_film_ratings' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:39:46.219522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84504dac-2ed4-4100-a4f6-c9102d80b336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08d7f52a0>]}
[0m14:39:46.223578 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.03s]
[0m14:39:46.227816 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m14:39:46.232931 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m14:39:46.236254 [info ] [Thread-1 (]: 4 of 4 START sql table model public.films ...................................... [RUN]
[0m14:39:46.242235 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m14:39:46.245722 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m14:39:46.255887 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m14:39:46.276514 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 14:39:46.249418 => 2024-02-08 14:39:46.276174
[0m14:39:46.279289 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m14:39:46.292201 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m14:39:46.308573 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:39:46.310865 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m14:39:46.313971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:46.369133 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:39:46.372047 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:39:46.374753 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:39:46.384359 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:39:46.397021 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:39:46.400980 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m14:39:46.408777 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:39:46.419063 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:39:46.423205 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:39:46.431896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:39:46.439087 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m14:39:46.441757 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:39:46.444178 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m14:39:46.456823 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:39:46.464409 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:39:46.467262 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m14:39:46.481451 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:39:46.486679 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 14:39:46.283094 => 2024-02-08 14:39:46.486522
[0m14:39:46.489199 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m14:39:46.493442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84504dac-2ed4-4100-a4f6-c9102d80b336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08d7f6440>]}
[0m14:39:46.497157 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.25s]
[0m14:39:46.501489 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m14:39:46.507900 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:39:46.510961 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:46.513831 [debug] [MainThread]: On master: BEGIN
[0m14:39:46.516371 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:39:46.575849 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:39:46.581615 [debug] [MainThread]: On master: COMMIT
[0m14:39:46.586638 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:46.591065 [debug] [MainThread]: On master: COMMIT
[0m14:39:46.602059 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:39:46.606380 [debug] [MainThread]: On master: Close
[0m14:39:46.622357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:46.626852 [debug] [MainThread]: Connection 'model.Custom_postgres.films' was properly closed.
[0m14:39:46.632121 [info ] [MainThread]: 
[0m14:39:46.636508 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.53 seconds (1.53s).
[0m14:39:46.641288 [debug] [MainThread]: Command end result
[0m14:39:46.690307 [info ] [MainThread]: 
[0m14:39:46.696324 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:39:46.702894 [info ] [MainThread]: 
[0m14:39:46.709086 [error] [MainThread]: [33mCompilation Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m14:39:46.714932 [error] [MainThread]:   'generate_film_ratings' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:39:46.720680 [info ] [MainThread]: 
[0m14:39:46.726502 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m14:39:46.734227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08f18c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08d7b2230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08d9042e0>]}
[0m14:39:46.738845 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 14:48:59.479433 | 8bc5caad-a73f-4f9c-80f0-a87736131b28 ==============================
[0m14:48:59.479433 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:48:59.484278 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:48:59.486378 [debug] [MainThread]: Tracking: tracking
[0m14:48:59.491106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a5a50f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a5a57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6a5a5390>]}
[0m14:48:59.524763 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:48:59.912488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:48:59.914782 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:48:59.929885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bc5caad-a73f-4f9c-80f0-a87736131b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68ce4c70>]}
[0m14:48:59.967010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bc5caad-a73f-4f9c-80f0-a87736131b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68c322c0>]}
[0m14:48:59.969432 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:48:59.971727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bc5caad-a73f-4f9c-80f0-a87736131b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68c322f0>]}
[0m14:48:59.976699 [info ] [MainThread]: 
[0m14:48:59.982897 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:48:59.987639 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:49:00.018826 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:49:00.021738 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:49:00.024162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:00.064840 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m14:49:00.069600 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:49:00.074420 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:49:00.089649 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:49:00.091613 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:49:00.093398 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:00.124986 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:49:00.127026 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:49:00.128986 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:49:00.137380 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m14:49:00.141003 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:49:00.146712 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:49:00.160717 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:00.163099 [debug] [MainThread]: On master: BEGIN
[0m14:49:00.165175 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:49:00.200454 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:49:00.202853 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:00.205498 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:49:00.215181 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:49:00.220273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bc5caad-a73f-4f9c-80f0-a87736131b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68c30e80>]}
[0m14:49:00.222894 [debug] [MainThread]: On master: ROLLBACK
[0m14:49:00.229387 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:00.231381 [debug] [MainThread]: On master: BEGIN
[0m14:49:00.240693 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:49:00.243047 [debug] [MainThread]: On master: COMMIT
[0m14:49:00.245860 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:00.248169 [debug] [MainThread]: On master: COMMIT
[0m14:49:00.254028 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:49:00.256345 [debug] [MainThread]: On master: Close
[0m14:49:00.259491 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:49:00.264850 [info ] [MainThread]: 
[0m14:49:00.297050 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m14:49:00.299080 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m14:49:00.304137 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m14:49:00.306601 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m14:49:00.314829 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m14:49:00.333679 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 14:49:00.308575 => 2024-02-08 14:49:00.333426
[0m14:49:00.336836 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m14:49:00.423243 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m14:49:00.438585 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:49:00.440635 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m14:49:00.443233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:00.474243 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:49:00.476356 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:49:00.478261 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:49:00.483747 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m14:49:00.486326 [debug] [Thread-1 (]: On model.Custom_postgres.actors: ROLLBACK
[0m14:49:00.492716 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 14:49:00.339082 => 2024-02-08 14:49:00.492517
[0m14:49:00.495322 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m14:49:00.504147 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m14:49:00.507120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bc5caad-a73f-4f9c-80f0-a87736131b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68b86740>]}
[0m14:49:00.515398 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.20s]
[0m14:49:00.527275 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m14:49:00.531604 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m14:49:00.535902 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m14:49:00.543212 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m14:49:00.546325 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m14:49:00.560540 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m14:49:00.590901 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 14:49:00.549305 => 2024-02-08 14:49:00.590655
[0m14:49:00.594504 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m14:49:00.619517 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m14:49:00.647580 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:49:00.649868 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m14:49:00.652145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:00.691988 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:49:00.694169 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:49:00.698068 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:49:00.705906 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:49:00.731885 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:49:00.733603 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:49:00.742043 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "film_actors" already exists

[0m14:49:00.744360 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: ROLLBACK
[0m14:49:00.750111 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m14:49:00.752717 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m14:49:00.755266 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 14:49:00.597849 => 2024-02-08 14:49:00.755028
[0m14:49:00.758509 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m14:49:00.763897 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "film_actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m14:49:00.765931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bc5caad-a73f-4f9c-80f0-a87736131b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68b3a950>]}
[0m14:49:00.769255 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.22s]
[0m14:49:00.773716 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m14:49:00.775665 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m14:49:00.779270 [info ] [Thread-1 (]: 3 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m14:49:00.782643 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_ratings'
[0m14:49:00.785086 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_ratings
[0m14:49:00.794512 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (compile): 2024-02-08 14:49:00.788340 => 2024-02-08 14:49:00.794297
[0m14:49:00.798698 [debug] [Thread-1 (]: Compilation Error in model film_ratings (models/example/film_ratings.sql)
  'generate_film_ratings' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:49:00.801283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bc5caad-a73f-4f9c-80f0-a87736131b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68b86440>]}
[0m14:49:00.805507 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.02s]
[0m14:49:00.808238 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m14:49:00.811918 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m14:49:00.815385 [info ] [Thread-1 (]: 4 of 4 START sql table model public.films ...................................... [RUN]
[0m14:49:00.819326 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m14:49:00.822374 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m14:49:00.832664 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m14:49:00.857175 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 14:49:00.824178 => 2024-02-08 14:49:00.856893
[0m14:49:00.859550 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m14:49:00.877327 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m14:49:00.898562 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:49:00.900626 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m14:49:00.902677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:00.930616 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:49:00.932267 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:49:00.933908 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:49:00.940085 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:49:00.946814 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:49:00.949454 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:49:00.957810 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "films" already exists

[0m14:49:00.960319 [debug] [Thread-1 (]: On model.Custom_postgres.films: ROLLBACK
[0m14:49:00.965193 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m14:49:00.967195 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m14:49:00.970116 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 14:49:00.865551 => 2024-02-08 14:49:00.969883
[0m14:49:00.972916 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m14:49:00.978828 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "films" already exists
  compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m14:49:00.981605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bc5caad-a73f-4f9c-80f0-a87736131b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68ce58d0>]}
[0m14:49:00.984605 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.16s]
[0m14:49:00.988111 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m14:49:00.993007 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:49:00.994810 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:00.996758 [debug] [MainThread]: On master: BEGIN
[0m14:49:00.998788 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:49:01.030244 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:49:01.032374 [debug] [MainThread]: On master: COMMIT
[0m14:49:01.034522 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:01.037461 [debug] [MainThread]: On master: COMMIT
[0m14:49:01.043280 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:49:01.045439 [debug] [MainThread]: On master: Close
[0m14:49:01.048559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:01.051220 [debug] [MainThread]: Connection 'model.Custom_postgres.films' was properly closed.
[0m14:49:01.055363 [info ] [MainThread]: 
[0m14:49:01.058316 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m14:49:01.061955 [debug] [MainThread]: Command end result
[0m14:49:01.100130 [info ] [MainThread]: 
[0m14:49:01.103959 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m14:49:01.108266 [info ] [MainThread]: 
[0m14:49:01.111084 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m14:49:01.114535 [error] [MainThread]:   relation "public.actors" does not exist
[0m14:49:01.118220 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m14:49:01.122239 [error] [MainThread]:                             ^
[0m14:49:01.125358 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m14:49:01.128141 [info ] [MainThread]: 
[0m14:49:01.131596 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m14:49:01.135088 [error] [MainThread]:   relation "film_actors" already exists
[0m14:49:01.139195 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m14:49:01.142570 [info ] [MainThread]: 
[0m14:49:01.145364 [error] [MainThread]: [33mCompilation Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m14:49:01.148832 [error] [MainThread]:   'generate_film_ratings' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:49:01.151975 [info ] [MainThread]: 
[0m14:49:01.155457 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m14:49:01.158514 [error] [MainThread]:   relation "films" already exists
[0m14:49:01.161214 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m14:49:01.165047 [info ] [MainThread]: 
[0m14:49:01.168086 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m14:49:01.172094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68bbc880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68bbfee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc68bbceb0>]}
[0m14:49:01.174420 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 14:50:29.718828 | 8e66ab96-e4c2-4022-ad46-3164d1a232aa ==============================
[0m14:50:29.718828 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:50:29.723923 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:50:29.726283 [debug] [MainThread]: Tracking: tracking
[0m14:50:29.730785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0c2bd0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0c2bd7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0c2bd390>]}
[0m14:50:29.767912 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:50:30.172861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:50:30.175079 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:50:30.189317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e66ab96-e4c2-4022-ad46-3164d1a232aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0a9fccd0>]}
[0m14:50:30.224030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e66ab96-e4c2-4022-ad46-3164d1a232aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0a93e320>]}
[0m14:50:30.226261 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:50:30.229397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e66ab96-e4c2-4022-ad46-3164d1a232aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0a93e350>]}
[0m14:50:30.234796 [info ] [MainThread]: 
[0m14:50:30.240550 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:50:30.245661 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:50:30.270800 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:50:30.273447 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:50:30.275688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:30.318318 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m14:50:30.322141 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:50:30.327726 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:50:30.346457 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:50:30.349029 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:50:30.350855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:30.382779 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:50:30.385393 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:50:30.388387 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:50:30.400195 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m14:50:30.404141 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:50:30.408556 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:50:30.420887 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:30.422679 [debug] [MainThread]: On master: BEGIN
[0m14:50:30.425589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:30.456236 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:50:30.458166 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:30.459757 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:50:30.468799 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:50:30.472659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e66ab96-e4c2-4022-ad46-3164d1a232aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0a93cee0>]}
[0m14:50:30.474824 [debug] [MainThread]: On master: ROLLBACK
[0m14:50:30.480616 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:30.483092 [debug] [MainThread]: On master: BEGIN
[0m14:50:30.493348 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:50:30.495738 [debug] [MainThread]: On master: COMMIT
[0m14:50:30.497741 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:30.499997 [debug] [MainThread]: On master: COMMIT
[0m14:50:30.505862 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:50:30.509522 [debug] [MainThread]: On master: Close
[0m14:50:30.512882 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:50:30.515565 [info ] [MainThread]: 
[0m14:50:30.551452 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m14:50:30.553905 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m14:50:30.558076 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m14:50:30.560688 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m14:50:30.568159 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m14:50:30.582920 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 14:50:30.562777 => 2024-02-08 14:50:30.582619
[0m14:50:30.586079 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m14:50:30.680727 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m14:50:30.710082 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:50:30.713367 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m14:50:30.716394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:30.834476 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:50:30.836745 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:50:30.839760 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:50:30.851377 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0 seconds
[0m14:50:30.888584 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:50:30.892057 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:50:30.898120 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "actors" already exists

[0m14:50:30.901855 [debug] [Thread-1 (]: On model.Custom_postgres.actors: ROLLBACK
[0m14:50:30.908532 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m14:50:30.911621 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m14:50:30.914513 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 14:50:30.587807 => 2024-02-08 14:50:30.914116
[0m14:50:30.918478 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m14:50:30.926447 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m14:50:30.931789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e66ab96-e4c2-4022-ad46-3164d1a232aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0a850df0>]}
[0m14:50:30.936289 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.37s]
[0m14:50:30.945353 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m14:50:30.948016 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m14:50:30.952750 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m14:50:30.956506 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m14:50:30.958870 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m14:50:30.971187 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m14:50:30.989585 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 14:50:30.960933 => 2024-02-08 14:50:30.989317
[0m14:50:30.992542 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m14:50:31.008307 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m14:50:31.028028 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:50:31.029755 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m14:50:31.031503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:31.071778 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:50:31.073370 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:50:31.075913 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:50:31.087694 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:50:31.097129 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:50:31.101045 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:50:31.108903 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "film_actors" already exists

[0m14:50:31.111903 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: ROLLBACK
[0m14:50:31.118991 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m14:50:31.122130 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m14:50:31.125003 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 14:50:30.994734 => 2024-02-08 14:50:31.124777
[0m14:50:31.128046 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m14:50:31.134371 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "film_actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m14:50:31.137247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e66ab96-e4c2-4022-ad46-3164d1a232aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0a9ea380>]}
[0m14:50:31.140330 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.18s]
[0m14:50:31.144461 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m14:50:31.146624 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m14:50:31.149455 [info ] [Thread-1 (]: 3 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m14:50:31.153656 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_ratings'
[0m14:50:31.155793 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_ratings
[0m14:50:31.163449 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (compile): 2024-02-08 14:50:31.158305 => 2024-02-08 14:50:31.163292
[0m14:50:31.168490 [debug] [Thread-1 (]: Compilation Error in model film_ratings (models/example/film_ratings.sql)
  'generate_film_ratings' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:50:31.170724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e66ab96-e4c2-4022-ad46-3164d1a232aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0a88ad40>]}
[0m14:50:31.173645 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.02s]
[0m14:50:31.176720 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m14:50:31.179200 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m14:50:31.181655 [info ] [Thread-1 (]: 4 of 4 START sql table model public.films ...................................... [RUN]
[0m14:50:31.187090 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m14:50:31.189045 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m14:50:31.196203 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m14:50:31.213536 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 14:50:31.191163 => 2024-02-08 14:50:31.213335
[0m14:50:31.216022 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m14:50:31.229020 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m14:50:31.244470 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:50:31.246071 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m14:50:31.247918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:31.277214 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:50:31.278943 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:50:31.280851 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:50:31.287888 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:50:31.294443 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:50:31.296813 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:50:31.303565 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "films" already exists

[0m14:50:31.305785 [debug] [Thread-1 (]: On model.Custom_postgres.films: ROLLBACK
[0m14:50:31.312219 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m14:50:31.314065 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m14:50:31.316281 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 14:50:31.219015 => 2024-02-08 14:50:31.316051
[0m14:50:31.318793 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m14:50:31.323171 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "films" already exists
  compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m14:50:31.328382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e66ab96-e4c2-4022-ad46-3164d1a232aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0a8755a0>]}
[0m14:50:31.331860 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.14s]
[0m14:50:31.335311 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m14:50:31.340514 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:50:31.343363 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:31.345296 [debug] [MainThread]: On master: BEGIN
[0m14:50:31.347011 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:31.381413 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:50:31.383580 [debug] [MainThread]: On master: COMMIT
[0m14:50:31.385900 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:31.387900 [debug] [MainThread]: On master: COMMIT
[0m14:50:31.393791 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:50:31.395745 [debug] [MainThread]: On master: Close
[0m14:50:31.398551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:31.400856 [debug] [MainThread]: Connection 'model.Custom_postgres.films' was properly closed.
[0m14:50:31.403796 [info ] [MainThread]: 
[0m14:50:31.406184 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m14:50:31.411014 [debug] [MainThread]: Command end result
[0m14:50:31.443424 [info ] [MainThread]: 
[0m14:50:31.446401 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m14:50:31.450235 [info ] [MainThread]: 
[0m14:50:31.453824 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m14:50:31.456635 [error] [MainThread]:   relation "actors" already exists
[0m14:50:31.460978 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m14:50:31.464140 [info ] [MainThread]: 
[0m14:50:31.467284 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m14:50:31.470833 [error] [MainThread]:   relation "film_actors" already exists
[0m14:50:31.473429 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m14:50:31.476559 [info ] [MainThread]: 
[0m14:50:31.480381 [error] [MainThread]: [33mCompilation Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m14:50:31.483125 [error] [MainThread]:   'generate_film_ratings' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:50:31.486135 [info ] [MainThread]: 
[0m14:50:31.488811 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m14:50:31.491687 [error] [MainThread]:   relation "films" already exists
[0m14:50:31.495134 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m14:50:31.498324 [info ] [MainThread]: 
[0m14:50:31.501195 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m14:50:31.504967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0a8db550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0a8d8df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf0a8d8310>]}
[0m14:50:31.508483 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 14:51:57.979159 | 4da5cf7e-8aaa-44ae-82e1-38aaeae080d1 ==============================
[0m14:51:57.979159 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:51:57.983725 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:51:57.985919 [debug] [MainThread]: Tracking: tracking
[0m14:51:57.990214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0368450f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0368457b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc036845390>]}
[0m14:51:58.028391 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:51:58.452184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:51:58.454746 [debug] [MainThread]: Partial parsing: updated file: Custom_postgres://models/example/film_ratings.sql
[0m14:51:58.500526 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m14:51:58.640279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4da5cf7e-8aaa-44ae-82e1-38aaeae080d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02ff0ceb0>]}
[0m14:51:58.676200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4da5cf7e-8aaa-44ae-82e1-38aaeae080d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc036826680>]}
[0m14:51:58.678976 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:51:58.681587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4da5cf7e-8aaa-44ae-82e1-38aaeae080d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc036852140>]}
[0m14:51:58.686652 [info ] [MainThread]: 
[0m14:51:58.692286 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:51:58.697691 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:51:58.725115 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:51:58.727697 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:51:58.729725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:58.769362 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m14:51:58.773586 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:51:58.779328 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:51:58.793940 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:51:58.795821 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:51:58.797491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:58.828735 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:51:58.831033 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:51:58.833945 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:51:58.843196 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m14:51:58.847246 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:51:58.853009 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:51:58.864712 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:58.867473 [debug] [MainThread]: On master: BEGIN
[0m14:51:58.869545 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:58.901145 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:51:58.903392 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:58.905195 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:51:58.914866 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:51:58.919569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4da5cf7e-8aaa-44ae-82e1-38aaeae080d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02ff3b3d0>]}
[0m14:51:58.922922 [debug] [MainThread]: On master: ROLLBACK
[0m14:51:58.928288 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:58.930512 [debug] [MainThread]: On master: BEGIN
[0m14:51:58.940182 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:51:58.942472 [debug] [MainThread]: On master: COMMIT
[0m14:51:58.944473 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:58.946215 [debug] [MainThread]: On master: COMMIT
[0m14:51:58.951823 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:51:58.953645 [debug] [MainThread]: On master: Close
[0m14:51:58.956538 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:51:58.959653 [info ] [MainThread]: 
[0m14:51:58.997367 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m14:51:59.000280 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m14:51:59.004446 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m14:51:59.006732 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m14:51:59.015364 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m14:51:59.030593 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 14:51:59.009346 => 2024-02-08 14:51:59.030355
[0m14:51:59.033573 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m14:51:59.153864 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m14:51:59.181947 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:51:59.185444 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m14:51:59.187729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:59.229120 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:51:59.231577 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:51:59.234623 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:51:59.243849 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0 seconds
[0m14:51:59.270296 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:51:59.272636 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:51:59.283804 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "actors" already exists

[0m14:51:59.287303 [debug] [Thread-1 (]: On model.Custom_postgres.actors: ROLLBACK
[0m14:51:59.294043 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m14:51:59.296313 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m14:51:59.299217 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 14:51:59.036120 => 2024-02-08 14:51:59.299015
[0m14:51:59.301594 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m14:51:59.310504 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m14:51:59.312910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4da5cf7e-8aaa-44ae-82e1-38aaeae080d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc036847370>]}
[0m14:51:59.316299 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.31s]
[0m14:51:59.322625 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m14:51:59.327149 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m14:51:59.330522 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m14:51:59.334989 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m14:51:59.337288 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m14:51:59.347363 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m14:51:59.370469 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 14:51:59.338946 => 2024-02-08 14:51:59.370261
[0m14:51:59.372620 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m14:51:59.394765 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m14:51:59.421886 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:51:59.428190 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m14:51:59.430887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:59.471740 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:51:59.473745 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:51:59.480135 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:51:59.487950 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:51:59.496406 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:51:59.498876 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:51:59.505063 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "film_actors" already exists

[0m14:51:59.508120 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: ROLLBACK
[0m14:51:59.513621 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m14:51:59.515941 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m14:51:59.518259 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 14:51:59.377273 => 2024-02-08 14:51:59.518078
[0m14:51:59.519861 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m14:51:59.524642 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "film_actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m14:51:59.526984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4da5cf7e-8aaa-44ae-82e1-38aaeae080d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02ffc4130>]}
[0m14:51:59.529816 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.19s]
[0m14:51:59.533024 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m14:51:59.535254 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m14:51:59.537122 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m14:51:59.539748 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m14:51:59.541656 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m14:51:59.549509 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m14:51:59.567628 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 14:51:59.543252 => 2024-02-08 14:51:59.567395
[0m14:51:59.569859 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m14:51:59.581531 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m14:51:59.596522 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:51:59.598647 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m14:51:59.600519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:59.627665 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:51:59.629255 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:51:59.630925 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:51:59.637917 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:51:59.648536 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:51:59.651309 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:51:59.656738 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "films" already exists

[0m14:51:59.658661 [debug] [Thread-1 (]: On model.Custom_postgres.films: ROLLBACK
[0m14:51:59.663099 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m14:51:59.665845 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m14:51:59.668654 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 14:51:59.571521 => 2024-02-08 14:51:59.668447
[0m14:51:59.670881 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m14:51:59.675819 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "films" already exists
  compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m14:51:59.678290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4da5cf7e-8aaa-44ae-82e1-38aaeae080d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02de78520>]}
[0m14:51:59.682261 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.14s]
[0m14:51:59.685890 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m14:51:59.689452 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m14:51:59.692542 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m14:51:59.696039 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m14:51:59.702141 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:51:59.703817 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:59.705806 [debug] [MainThread]: On master: BEGIN
[0m14:51:59.708354 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:59.740506 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:51:59.742247 [debug] [MainThread]: On master: COMMIT
[0m14:51:59.744019 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:59.745517 [debug] [MainThread]: On master: COMMIT
[0m14:51:59.750650 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:51:59.752384 [debug] [MainThread]: On master: Close
[0m14:51:59.755127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:59.757213 [debug] [MainThread]: Connection 'model.Custom_postgres.films' was properly closed.
[0m14:51:59.759784 [info ] [MainThread]: 
[0m14:51:59.762370 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m14:51:59.766051 [debug] [MainThread]: Command end result
[0m14:51:59.807269 [info ] [MainThread]: 
[0m14:51:59.812453 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:51:59.819395 [info ] [MainThread]: 
[0m14:51:59.822284 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m14:51:59.825222 [error] [MainThread]:   relation "actors" already exists
[0m14:51:59.828558 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m14:51:59.832401 [info ] [MainThread]: 
[0m14:51:59.836035 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m14:51:59.839436 [error] [MainThread]:   relation "film_actors" already exists
[0m14:51:59.842907 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m14:51:59.846943 [info ] [MainThread]: 
[0m14:51:59.850587 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m14:51:59.854048 [error] [MainThread]:   relation "films" already exists
[0m14:51:59.857085 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m14:51:59.864235 [info ] [MainThread]: 
[0m14:51:59.868909 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m14:51:59.871461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02de7af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02de7ab60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02de799c0>]}
[0m14:51:59.873881 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 14:53:04.953916 | 71499d08-640b-46c9-934f-28883ba4f765 ==============================
[0m14:53:04.953916 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:53:04.958692 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:53:04.960764 [debug] [MainThread]: Tracking: tracking
[0m14:53:04.967019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9516c9d360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9516c9d7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9516c9d3c0>]}
[0m14:53:05.006657 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:53:05.428486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:53:05.431238 [debug] [MainThread]: Partial parsing: updated file: Custom_postgres://models/example/film_ratings.sql
[0m14:53:05.473815 [debug] [MainThread]: 1603: static parser failed on example/film_ratings.sql
[0m14:53:05.502540 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/film_ratings.sql
[0m14:53:05.642078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71499d08-640b-46c9-934f-28883ba4f765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f951444feb0>]}
[0m14:53:05.676228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71499d08-640b-46c9-934f-28883ba4f765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9516c6e650>]}
[0m14:53:05.679135 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:53:05.681873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71499d08-640b-46c9-934f-28883ba4f765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9516cb5d20>]}
[0m14:53:05.687942 [info ] [MainThread]: 
[0m14:53:05.695211 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:53:05.700521 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:53:05.726121 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:53:05.727834 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:53:05.730494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:05.771154 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m14:53:05.778300 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:53:05.785801 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:53:05.809567 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:53:05.812112 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:53:05.815361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:05.854186 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:53:05.856778 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:53:05.859602 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:53:05.873166 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m14:53:05.878256 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:53:05.886097 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:53:05.910788 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:05.915564 [debug] [MainThread]: On master: BEGIN
[0m14:53:05.919523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:05.956588 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:53:05.959972 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:05.962401 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:53:05.978980 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:53:05.984187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71499d08-640b-46c9-934f-28883ba4f765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95144673d0>]}
[0m14:53:05.987205 [debug] [MainThread]: On master: ROLLBACK
[0m14:53:05.994217 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:05.996896 [debug] [MainThread]: On master: BEGIN
[0m14:53:06.006744 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:53:06.010032 [debug] [MainThread]: On master: COMMIT
[0m14:53:06.012367 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:06.015336 [debug] [MainThread]: On master: COMMIT
[0m14:53:06.021202 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:53:06.024093 [debug] [MainThread]: On master: Close
[0m14:53:06.026815 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:06.029964 [info ] [MainThread]: 
[0m14:53:06.069103 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m14:53:06.071549 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m14:53:06.076103 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m14:53:06.078706 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m14:53:06.089808 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m14:53:06.113318 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 14:53:06.081740 => 2024-02-08 14:53:06.112962
[0m14:53:06.117169 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m14:53:06.205365 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m14:53:06.224554 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:53:06.226484 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m14:53:06.228390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:06.258240 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:53:06.260347 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:53:06.262498 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:53:06.269378 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:53:06.282363 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:53:06.284603 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m14:53:06.291258 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:53:06.299555 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:53:06.301670 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:53:06.308322 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:53:06.351915 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m14:53:06.354831 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:53:06.356850 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m14:53:06.366255 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:53:06.376728 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:53:06.379064 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m14:53:06.391206 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:53:06.395288 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 14:53:06.119773 => 2024-02-08 14:53:06.395169
[0m14:53:06.397260 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m14:53:06.400221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71499d08-640b-46c9-934f-28883ba4f765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95144d71f0>]}
[0m14:53:06.402986 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.33s]
[0m14:53:06.408862 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m14:53:06.411256 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m14:53:06.413578 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m14:53:06.416563 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m14:53:06.418879 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m14:53:06.425134 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m14:53:06.445285 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 14:53:06.420901 => 2024-02-08 14:53:06.444953
[0m14:53:06.448050 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m14:53:06.466372 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m14:53:06.485009 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:53:06.486942 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m14:53:06.488797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:06.519590 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:53:06.521590 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:53:06.523856 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:53:06.532879 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:53:06.542780 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:53:06.544917 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m14:53:06.552346 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:53:06.559352 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:53:06.561223 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:53:06.567779 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:53:06.574344 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m14:53:06.576359 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:53:06.578162 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m14:53:06.587393 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:53:06.593537 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:53:06.595438 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m14:53:06.606603 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:53:06.610395 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 14:53:06.450343 => 2024-02-08 14:53:06.610298
[0m14:53:06.612769 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m14:53:06.615649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71499d08-640b-46c9-934f-28883ba4f765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95144d6e60>]}
[0m14:53:06.618134 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.20s]
[0m14:53:06.621044 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m14:53:06.623179 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m14:53:06.625221 [info ] [Thread-1 (]: 3 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m14:53:06.628973 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_ratings'
[0m14:53:06.631132 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_ratings
[0m14:53:06.640030 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (compile): 2024-02-08 14:53:06.633513 => 2024-02-08 14:53:06.639874
[0m14:53:06.644394 [debug] [Thread-1 (]: Compilation Error in model film_ratings (models/example/film_ratings.sql)
  'generate_film_ratings' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:53:06.647227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71499d08-640b-46c9-934f-28883ba4f765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95144ee560>]}
[0m14:53:06.649954 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.02s]
[0m14:53:06.652879 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m14:53:06.656318 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m14:53:06.659360 [info ] [Thread-1 (]: 4 of 4 START sql table model public.films ...................................... [RUN]
[0m14:53:06.663020 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m14:53:06.666059 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m14:53:06.674439 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m14:53:06.691100 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 14:53:06.667660 => 2024-02-08 14:53:06.690859
[0m14:53:06.692805 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m14:53:06.704222 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m14:53:06.721068 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:53:06.722768 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m14:53:06.724455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:06.754263 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:53:06.756217 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:53:06.758003 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:53:06.764270 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:53:06.770906 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:53:06.772770 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m14:53:06.779296 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:53:06.788332 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:53:06.790467 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:53:06.795317 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:53:06.801883 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m14:53:06.804233 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:53:06.806393 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m14:53:06.815427 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:53:06.821076 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:53:06.822914 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m14:53:06.833650 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:53:06.837955 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 14:53:06.694204 => 2024-02-08 14:53:06.837851
[0m14:53:06.839844 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m14:53:06.842431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71499d08-640b-46c9-934f-28883ba4f765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95144d6c20>]}
[0m14:53:06.844769 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.18s]
[0m14:53:06.847460 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m14:53:06.851726 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:53:06.853851 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:06.856009 [debug] [MainThread]: On master: BEGIN
[0m14:53:06.858062 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:06.888570 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:53:06.890673 [debug] [MainThread]: On master: COMMIT
[0m14:53:06.893042 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:06.895073 [debug] [MainThread]: On master: COMMIT
[0m14:53:06.901093 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:53:06.903181 [debug] [MainThread]: On master: Close
[0m14:53:06.907011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:06.909391 [debug] [MainThread]: Connection 'model.Custom_postgres.films' was properly closed.
[0m14:53:06.912150 [info ] [MainThread]: 
[0m14:53:06.914981 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m14:53:06.918496 [debug] [MainThread]: Command end result
[0m14:53:06.954377 [info ] [MainThread]: 
[0m14:53:06.958695 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:53:06.962157 [info ] [MainThread]: 
[0m14:53:06.965961 [error] [MainThread]: [33mCompilation Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m14:53:06.968932 [error] [MainThread]:   'generate_film_ratings' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:53:06.971821 [info ] [MainThread]: 
[0m14:53:06.974928 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m14:53:06.977996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95153d4a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95143e3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95143e3c40>]}
[0m14:53:06.982042 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 14:54:27.017968 | 6d6f24e2-be90-43c0-bcf7-cabd500a412b ==============================
[0m14:54:27.017968 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:54:27.022686 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:54:27.024954 [debug] [MainThread]: Tracking: tracking
[0m14:54:27.029457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc6309360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc63097e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc63093c0>]}
[0m14:54:27.066189 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:54:27.479032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:54:27.481136 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:54:27.495246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d6f24e2-be90-43c0-bcf7-cabd500a412b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc4a40ca0>]}
[0m14:54:27.533149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d6f24e2-be90-43c0-bcf7-cabd500a412b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc4b822f0>]}
[0m14:54:27.535607 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:54:27.538053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d6f24e2-be90-43c0-bcf7-cabd500a412b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc4b82320>]}
[0m14:54:27.543414 [info ] [MainThread]: 
[0m14:54:27.549390 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:54:27.554184 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:54:27.576599 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:54:27.579210 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:54:27.581376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:27.623020 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m14:54:27.627541 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:54:27.633173 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:54:27.648513 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:54:27.650582 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:54:27.652477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:27.685865 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:54:27.687572 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:54:27.689228 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:54:27.698356 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m14:54:27.704801 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:54:27.710767 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:54:27.724295 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:27.726334 [debug] [MainThread]: On master: BEGIN
[0m14:54:27.728249 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:27.760880 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:54:27.763021 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:27.765028 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:54:27.773326 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:54:27.777117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d6f24e2-be90-43c0-bcf7-cabd500a412b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc4b80eb0>]}
[0m14:54:27.779557 [debug] [MainThread]: On master: ROLLBACK
[0m14:54:27.784236 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:27.786481 [debug] [MainThread]: On master: BEGIN
[0m14:54:27.794433 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:54:27.797209 [debug] [MainThread]: On master: COMMIT
[0m14:54:27.799230 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:27.801978 [debug] [MainThread]: On master: COMMIT
[0m14:54:27.807905 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:54:27.810303 [debug] [MainThread]: On master: Close
[0m14:54:27.813612 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:54:27.817096 [info ] [MainThread]: 
[0m14:54:27.852610 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m14:54:27.855512 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m14:54:27.860134 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m14:54:27.862850 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m14:54:27.870021 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m14:54:27.888065 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 14:54:27.864831 => 2024-02-08 14:54:27.887842
[0m14:54:27.890029 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m14:54:28.004464 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m14:54:28.032677 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:54:28.035834 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m14:54:28.039809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:28.085401 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:54:28.089102 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:54:28.092142 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:54:28.102608 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:54:28.135463 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:54:28.138673 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:54:28.145126 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "actors" already exists

[0m14:54:28.148150 [debug] [Thread-1 (]: On model.Custom_postgres.actors: ROLLBACK
[0m14:54:28.153795 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m14:54:28.155983 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m14:54:28.158112 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 14:54:27.891718 => 2024-02-08 14:54:28.157929
[0m14:54:28.160555 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m14:54:28.168675 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m14:54:28.171610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d6f24e2-be90-43c0-bcf7-cabd500a412b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc4a90cd0>]}
[0m14:54:28.174319 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.31s]
[0m14:54:28.183246 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m14:54:28.185379 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m14:54:28.188326 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m14:54:28.191375 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m14:54:28.193697 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m14:54:28.205136 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m14:54:28.224619 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 14:54:28.196902 => 2024-02-08 14:54:28.224409
[0m14:54:28.227740 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m14:54:28.243606 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m14:54:28.264725 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:54:28.266960 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m14:54:28.269969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:28.309140 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:54:28.311683 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:54:28.313515 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:54:28.320318 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:54:28.327164 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:54:28.329434 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:54:28.337570 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "film_actors" already exists

[0m14:54:28.339693 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: ROLLBACK
[0m14:54:28.344558 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m14:54:28.347063 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m14:54:28.349291 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 14:54:28.231359 => 2024-02-08 14:54:28.348908
[0m14:54:28.351834 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m14:54:28.356608 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "film_actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m14:54:28.358915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d6f24e2-be90-43c0-bcf7-cabd500a412b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc4a2d990>]}
[0m14:54:28.362112 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.17s]
[0m14:54:28.365319 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m14:54:28.367656 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m14:54:28.370224 [info ] [Thread-1 (]: 3 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m14:54:28.373788 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_ratings'
[0m14:54:28.375657 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_ratings
[0m14:54:28.383117 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (compile): 2024-02-08 14:54:28.377510 => 2024-02-08 14:54:28.382962
[0m14:54:28.388121 [debug] [Thread-1 (]: Compilation Error in model film_ratings (models/example/film_ratings.sql)
  'generate_film_ratings' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:54:28.390015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d6f24e2-be90-43c0-bcf7-cabd500a412b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc48ced40>]}
[0m14:54:28.391871 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.02s]
[0m14:54:28.394537 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m14:54:28.397632 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m14:54:28.399758 [info ] [Thread-1 (]: 4 of 4 START sql table model public.films ...................................... [RUN]
[0m14:54:28.404230 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m14:54:28.406261 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m14:54:28.415023 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m14:54:28.431687 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 14:54:28.408005 => 2024-02-08 14:54:28.431475
[0m14:54:28.433672 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m14:54:28.445532 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m14:54:28.462323 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:54:28.464495 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m14:54:28.466375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:28.498532 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:54:28.500132 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:54:28.501862 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:54:28.508387 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:54:28.516284 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:54:28.518487 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:54:28.524055 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "films" already exists

[0m14:54:28.525918 [debug] [Thread-1 (]: On model.Custom_postgres.films: ROLLBACK
[0m14:54:28.531489 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m14:54:28.533405 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m14:54:28.535348 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 14:54:28.436162 => 2024-02-08 14:54:28.535105
[0m14:54:28.537513 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m14:54:28.540609 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "films" already exists
  compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m14:54:28.542997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d6f24e2-be90-43c0-bcf7-cabd500a412b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc48b9540>]}
[0m14:54:28.546376 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.14s]
[0m14:54:28.549517 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m14:54:28.555673 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:54:28.557818 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:28.560131 [debug] [MainThread]: On master: BEGIN
[0m14:54:28.562596 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:54:28.595673 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:54:28.597903 [debug] [MainThread]: On master: COMMIT
[0m14:54:28.600080 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:28.601740 [debug] [MainThread]: On master: COMMIT
[0m14:54:28.606799 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:54:28.608794 [debug] [MainThread]: On master: Close
[0m14:54:28.611807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:28.616000 [debug] [MainThread]: Connection 'model.Custom_postgres.films' was properly closed.
[0m14:54:28.620187 [info ] [MainThread]: 
[0m14:54:28.623094 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m14:54:28.628961 [debug] [MainThread]: Command end result
[0m14:54:28.669363 [info ] [MainThread]: 
[0m14:54:28.674677 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m14:54:28.678423 [info ] [MainThread]: 
[0m14:54:28.681940 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m14:54:28.686452 [error] [MainThread]:   relation "actors" already exists
[0m14:54:28.691023 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m14:54:28.696467 [info ] [MainThread]: 
[0m14:54:28.700187 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m14:54:28.704032 [error] [MainThread]:   relation "film_actors" already exists
[0m14:54:28.708069 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m14:54:28.713465 [info ] [MainThread]: 
[0m14:54:28.717376 [error] [MainThread]: [33mCompilation Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m14:54:28.720572 [error] [MainThread]:   'generate_film_ratings' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:54:28.725822 [info ] [MainThread]: 
[0m14:54:28.729465 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m14:54:28.732586 [error] [MainThread]:   relation "films" already exists
[0m14:54:28.734839 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m14:54:28.739239 [info ] [MainThread]: 
[0m14:54:28.742450 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m14:54:28.745825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc491d2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc491fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc491f520>]}
[0m14:54:28.748972 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 14:58:14.881764 | b8a95eae-439e-4776-a674-83349453dcb2 ==============================
[0m14:58:14.881764 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:58:14.886521 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:58:14.888674 [debug] [MainThread]: Tracking: tracking
[0m14:58:14.892975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde81b1360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde81b17e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde81b13c0>]}
[0m14:58:14.928163 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:58:15.345456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:58:15.348094 [debug] [MainThread]: Partial parsing: updated file: Custom_postgres://macros/film_ratings_macro.sql
[0m14:58:15.389852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8a95eae-439e-4776-a674-83349453dcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde6919150>]}
[0m14:58:15.426862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8a95eae-439e-4776-a674-83349453dcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde6842350>]}
[0m14:58:15.429247 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:58:15.432156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8a95eae-439e-4776-a674-83349453dcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde6842500>]}
[0m14:58:15.437155 [info ] [MainThread]: 
[0m14:58:15.443096 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:58:15.447771 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:58:15.470432 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:58:15.473207 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:58:15.476081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:15.517778 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m14:58:15.521623 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:58:15.526963 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:58:15.539134 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:58:15.541267 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:58:15.543012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:15.573933 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:58:15.576007 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:58:15.577954 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:58:15.586496 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m14:58:15.590594 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:58:15.595929 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:58:15.610935 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:15.612798 [debug] [MainThread]: On master: BEGIN
[0m14:58:15.614841 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:58:15.649408 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:58:15.651521 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:15.653114 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:58:15.663849 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:58:15.667254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8a95eae-439e-4776-a674-83349453dcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde6841000>]}
[0m14:58:15.669236 [debug] [MainThread]: On master: ROLLBACK
[0m14:58:15.675473 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:15.677428 [debug] [MainThread]: On master: BEGIN
[0m14:58:15.685501 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:58:15.687119 [debug] [MainThread]: On master: COMMIT
[0m14:58:15.689028 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:15.691243 [debug] [MainThread]: On master: COMMIT
[0m14:58:15.695942 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:58:15.697837 [debug] [MainThread]: On master: Close
[0m14:58:15.700650 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:58:15.703528 [info ] [MainThread]: 
[0m14:58:15.738470 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m14:58:15.741534 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m14:58:15.746276 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m14:58:15.749451 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m14:58:15.757789 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m14:58:15.774152 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 14:58:15.751604 => 2024-02-08 14:58:15.773813
[0m14:58:15.776629 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m14:58:15.856332 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m14:58:15.872100 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:58:15.874472 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m14:58:15.876575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:15.915680 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:58:15.918136 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:58:15.920786 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:58:15.932272 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0 seconds
[0m14:58:15.967883 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m14:58:15.971140 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:58:15.979466 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "actors" already exists

[0m14:58:15.982101 [debug] [Thread-1 (]: On model.Custom_postgres.actors: ROLLBACK
[0m14:58:15.991013 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m14:58:15.994369 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m14:58:15.997366 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 14:58:15.778456 => 2024-02-08 14:58:15.997174
[0m14:58:15.999676 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m14:58:16.011386 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m14:58:16.014042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a95eae-439e-4776-a674-83349453dcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde6762b60>]}
[0m14:58:16.019012 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.27s]
[0m14:58:16.030147 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m14:58:16.035661 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m14:58:16.038647 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m14:58:16.045929 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m14:58:16.048470 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m14:58:16.061234 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m14:58:16.086100 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 14:58:16.052651 => 2024-02-08 14:58:16.085836
[0m14:58:16.088439 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m14:58:16.106588 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m14:58:16.128632 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:58:16.131266 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m14:58:16.133234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:16.170112 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:58:16.172568 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:58:16.175620 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:58:16.184064 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:58:16.192408 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m14:58:16.194143 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:58:16.203213 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "film_actors" already exists

[0m14:58:16.206125 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: ROLLBACK
[0m14:58:16.212310 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m14:58:16.214249 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m14:58:16.218362 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 14:58:16.092034 => 2024-02-08 14:58:16.218029
[0m14:58:16.222441 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m14:58:16.228386 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "film_actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m14:58:16.231067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a95eae-439e-4776-a674-83349453dcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde6919690>]}
[0m14:58:16.234923 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.19s]
[0m14:58:16.237920 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m14:58:16.242445 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m14:58:16.246587 [info ] [Thread-1 (]: 3 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m14:58:16.251138 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_ratings'
[0m14:58:16.254325 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_ratings
[0m14:58:16.274832 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (compile): 2024-02-08 14:58:16.258990 => 2024-02-08 14:58:16.274537
[0m14:58:16.281117 [debug] [Thread-1 (]: Compilation Error in model film_ratings (models/example/film_ratings.sql)
  dbt was unable to infer all dependencies for the model "film_ratings".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "film_ratings":
  
  -- depends_on: {{ ref('films') }}
  
  > in macro generate_film_ratings (macros/film_ratings_macro.sql)
  > called by model film_ratings (models/example/film_ratings.sql)
[0m14:58:16.285302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a95eae-439e-4776-a674-83349453dcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde6919660>]}
[0m14:58:16.288032 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.03s]
[0m14:58:16.291681 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m14:58:16.294905 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m14:58:16.297255 [info ] [Thread-1 (]: 4 of 4 START sql table model public.films ...................................... [RUN]
[0m14:58:16.301592 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m14:58:16.303784 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m14:58:16.316356 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m14:58:16.332032 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 14:58:16.306855 => 2024-02-08 14:58:16.331814
[0m14:58:16.333894 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m14:58:16.344193 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m14:58:16.358504 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:58:16.360090 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m14:58:16.361587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:16.389984 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:58:16.391681 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:58:16.393398 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:58:16.400970 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:58:16.409498 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m14:58:16.411574 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:58:16.417980 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "films" already exists

[0m14:58:16.420004 [debug] [Thread-1 (]: On model.Custom_postgres.films: ROLLBACK
[0m14:58:16.427396 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m14:58:16.429614 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m14:58:16.431708 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 14:58:16.335570 => 2024-02-08 14:58:16.431537
[0m14:58:16.434276 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m14:58:16.441393 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "films" already exists
  compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m14:58:16.445576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a95eae-439e-4776-a674-83349453dcb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde4656710>]}
[0m14:58:16.448241 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.15s]
[0m14:58:16.452613 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m14:58:16.458968 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:58:16.461560 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:16.463721 [debug] [MainThread]: On master: BEGIN
[0m14:58:16.466505 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:58:16.499581 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:58:16.501344 [debug] [MainThread]: On master: COMMIT
[0m14:58:16.503044 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:16.505233 [debug] [MainThread]: On master: COMMIT
[0m14:58:16.511235 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:58:16.513640 [debug] [MainThread]: On master: Close
[0m14:58:16.516900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:16.518903 [debug] [MainThread]: Connection 'model.Custom_postgres.films' was properly closed.
[0m14:58:16.521539 [info ] [MainThread]: 
[0m14:58:16.525951 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m14:58:16.529775 [debug] [MainThread]: Command end result
[0m14:58:16.562390 [info ] [MainThread]: 
[0m14:58:16.566214 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m14:58:16.570274 [info ] [MainThread]: 
[0m14:58:16.574568 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m14:58:16.582508 [error] [MainThread]:   relation "actors" already exists
[0m14:58:16.585844 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m14:58:16.589951 [info ] [MainThread]: 
[0m14:58:16.594045 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m14:58:16.597700 [error] [MainThread]:   relation "film_actors" already exists
[0m14:58:16.600492 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m14:58:16.604246 [info ] [MainThread]: 
[0m14:58:16.610419 [error] [MainThread]: [33mCompilation Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m14:58:16.614079 [error] [MainThread]:   dbt was unable to infer all dependencies for the model "film_ratings".
[0m14:58:16.617491 [error] [MainThread]:   This typically happens when ref() is placed within a conditional block.
[0m14:58:16.620135 [error] [MainThread]:   
[0m14:58:16.623168 [error] [MainThread]:   To fix this, add the following hint to the top of the model "film_ratings":
[0m14:58:16.627927 [error] [MainThread]:   
[0m14:58:16.630624 [error] [MainThread]:   -- depends_on: {{ ref('films') }}
[0m14:58:16.633779 [error] [MainThread]:   
[0m14:58:16.636614 [error] [MainThread]:   > in macro generate_film_ratings (macros/film_ratings_macro.sql)
[0m14:58:16.638644 [error] [MainThread]:   > called by model film_ratings (models/example/film_ratings.sql)
[0m14:58:16.641999 [info ] [MainThread]: 
[0m14:58:16.646242 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m14:58:16.648655 [error] [MainThread]:   relation "films" already exists
[0m14:58:16.651748 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m14:58:16.655374 [info ] [MainThread]: 
[0m14:58:16.658571 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m14:58:16.661982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde67c83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde68adcc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde68ad480>]}
[0m14:58:16.664203 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 15:00:08.285667 | 72900b98-7a7a-4ed5-aad4-0da2ddfff40a ==============================
[0m15:00:08.285667 [info ] [MainThread]: Running with dbt=1.4.7
[0m15:00:08.290535 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:00:08.292500 [debug] [MainThread]: Tracking: tracking
[0m15:00:08.296580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b584b50f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b584b57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b584b5390>]}
[0m15:00:08.337245 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m15:00:08.772721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:00:08.775246 [debug] [MainThread]: Partial parsing: updated file: Custom_postgres://macros/film_ratings_macro.sql
[0m15:00:08.777559 [debug] [MainThread]: Partial parsing: updated file: Custom_postgres://models/example/film_ratings.sql
[0m15:00:08.825263 [debug] [MainThread]: 1603: static parser failed on example/film_ratings.sql
[0m15:00:08.854141 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/film_ratings.sql
[0m15:00:08.970054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72900b98-7a7a-4ed5-aad4-0da2ddfff40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b56be8ca0>]}
[0m15:00:09.005035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72900b98-7a7a-4ed5-aad4-0da2ddfff40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b584b8b20>]}
[0m15:00:09.007522 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:00:09.011472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72900b98-7a7a-4ed5-aad4-0da2ddfff40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b584b81f0>]}
[0m15:00:09.016447 [info ] [MainThread]: 
[0m15:00:09.022017 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:00:09.026293 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m15:00:09.050006 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m15:00:09.052271 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m15:00:09.056597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:09.099606 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m15:00:09.104007 [debug] [ThreadPool]: On list_destination_db: Close
[0m15:00:09.110704 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m15:00:09.126397 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:00:09.128637 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m15:00:09.130555 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:09.161257 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:00:09.164303 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:00:09.166576 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:00:09.177014 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m15:00:09.180200 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m15:00:09.185099 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m15:00:09.198986 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:09.201456 [debug] [MainThread]: On master: BEGIN
[0m15:00:09.203575 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:00:09.234877 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:00:09.237214 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:09.239394 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:00:09.248308 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m15:00:09.254830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72900b98-7a7a-4ed5-aad4-0da2ddfff40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b56bf6a70>]}
[0m15:00:09.257355 [debug] [MainThread]: On master: ROLLBACK
[0m15:00:09.262676 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:09.265289 [debug] [MainThread]: On master: BEGIN
[0m15:00:09.274549 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:00:09.276773 [debug] [MainThread]: On master: COMMIT
[0m15:00:09.278758 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:09.281129 [debug] [MainThread]: On master: COMMIT
[0m15:00:09.286488 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:00:09.289543 [debug] [MainThread]: On master: Close
[0m15:00:09.292768 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:00:09.296100 [info ] [MainThread]: 
[0m15:00:09.329699 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m15:00:09.331987 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m15:00:09.335224 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m15:00:09.337809 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m15:00:09.347373 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m15:00:09.363547 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 15:00:09.340296 => 2024-02-08 15:00:09.363247
[0m15:00:09.365883 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m15:00:09.487709 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m15:00:09.513255 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:00:09.517234 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m15:00:09.519769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:09.557905 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:00:09.560252 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:00:09.563086 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m15:00:09.573543 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:00:09.603756 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:00:09.607137 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m15:00:09.614122 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "actors" already exists

[0m15:00:09.616819 [debug] [Thread-1 (]: On model.Custom_postgres.actors: ROLLBACK
[0m15:00:09.622213 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:00:09.624548 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:00:09.626557 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 15:00:09.367341 => 2024-02-08 15:00:09.626339
[0m15:00:09.628889 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m15:00:09.637409 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m15:00:09.640776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72900b98-7a7a-4ed5-aad4-0da2ddfff40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b56bf6d40>]}
[0m15:00:09.643581 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.31s]
[0m15:00:09.648982 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m15:00:09.651284 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m15:00:09.654253 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m15:00:09.658599 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m15:00:09.660603 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m15:00:09.667856 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m15:00:09.685114 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 15:00:09.662194 => 2024-02-08 15:00:09.684904
[0m15:00:09.687698 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m15:00:09.703139 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m15:00:09.728124 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:00:09.732277 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m15:00:09.735470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:09.778422 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:00:09.780426 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:00:09.782417 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m15:00:09.789832 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:00:09.800872 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:00:09.804467 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m15:00:09.812417 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "film_actors" already exists

[0m15:00:09.814793 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: ROLLBACK
[0m15:00:09.821842 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:00:09.824466 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:00:09.826378 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 15:00:09.689686 => 2024-02-08 15:00:09.826181
[0m15:00:09.828626 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m15:00:09.833659 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "film_actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m15:00:09.836351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72900b98-7a7a-4ed5-aad4-0da2ddfff40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b56bf6bc0>]}
[0m15:00:09.841343 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.18s]
[0m15:00:09.843917 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m15:00:09.846406 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m15:00:09.849637 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m15:00:09.853906 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m15:00:09.856993 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m15:00:09.869752 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m15:00:09.884449 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 15:00:09.859132 => 2024-02-08 15:00:09.884209
[0m15:00:09.886700 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m15:00:09.899725 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m15:00:09.914220 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:00:09.915850 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m15:00:09.917414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:09.943897 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:00:09.945723 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:00:09.947333 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m15:00:09.953279 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:00:09.960117 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:00:09.962073 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m15:00:09.968880 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "films" already exists

[0m15:00:09.971246 [debug] [Thread-1 (]: On model.Custom_postgres.films: ROLLBACK
[0m15:00:09.977287 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:00:09.980397 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:00:09.982446 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 15:00:09.889265 => 2024-02-08 15:00:09.982281
[0m15:00:09.984841 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m15:00:09.988917 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "films" already exists
  compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:00:09.991754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72900b98-7a7a-4ed5-aad4-0da2ddfff40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b559b62c0>]}
[0m15:00:09.994848 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.14s]
[0m15:00:09.997958 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m15:00:10.002686 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m15:00:10.005472 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m15:00:10.008756 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m15:00:10.013989 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:00:10.016564 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:10.018597 [debug] [MainThread]: On master: BEGIN
[0m15:00:10.020662 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:00:10.054242 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:00:10.056431 [debug] [MainThread]: On master: COMMIT
[0m15:00:10.058555 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:10.060102 [debug] [MainThread]: On master: COMMIT
[0m15:00:10.064287 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:00:10.066027 [debug] [MainThread]: On master: Close
[0m15:00:10.068737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:10.071268 [debug] [MainThread]: Connection 'model.Custom_postgres.films' was properly closed.
[0m15:00:10.074514 [info ] [MainThread]: 
[0m15:00:10.078038 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m15:00:10.080866 [debug] [MainThread]: Command end result
[0m15:00:10.113537 [info ] [MainThread]: 
[0m15:00:10.118580 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:00:10.122497 [info ] [MainThread]: 
[0m15:00:10.125824 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m15:00:10.128938 [error] [MainThread]:   relation "actors" already exists
[0m15:00:10.132356 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m15:00:10.136553 [info ] [MainThread]: 
[0m15:00:10.141304 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m15:00:10.144558 [error] [MainThread]:   relation "film_actors" already exists
[0m15:00:10.147332 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m15:00:10.151727 [info ] [MainThread]: 
[0m15:00:10.155146 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m15:00:10.158835 [error] [MainThread]:   relation "films" already exists
[0m15:00:10.161633 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:00:10.164904 [info ] [MainThread]: 
[0m15:00:10.169736 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m15:00:10.173417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b584b8a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b56c0ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b56c08460>]}
[0m15:00:10.176483 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 15:02:43.011505 | d926851e-df95-4721-bdd8-2f0c7bfc8e36 ==============================
[0m15:02:43.011505 [info ] [MainThread]: Running with dbt=1.4.7
[0m15:02:43.016724 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:02:43.019206 [debug] [MainThread]: Tracking: tracking
[0m15:02:43.023530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa222dc90f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa222dc97b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa222dc9390>]}
[0m15:02:43.063054 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m15:02:43.416758 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:02:43.418614 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:02:43.434176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd926851e-df95-4721-bdd8-2f0c7bfc8e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa221504d90>]}
[0m15:02:43.471450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd926851e-df95-4721-bdd8-2f0c7bfc8e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22144a2c0>]}
[0m15:02:43.473947 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:02:43.477030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd926851e-df95-4721-bdd8-2f0c7bfc8e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22144a380>]}
[0m15:02:43.483619 [info ] [MainThread]: 
[0m15:02:43.492930 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:02:43.498350 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m15:02:43.527677 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m15:02:43.530215 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m15:02:43.537758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:43.579343 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m15:02:43.583616 [debug] [ThreadPool]: On list_destination_db: Close
[0m15:02:43.590611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m15:02:43.605574 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:02:43.607892 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m15:02:43.609802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:43.644646 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:02:43.647530 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:02:43.649649 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:02:43.659828 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m15:02:43.663761 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m15:02:43.670866 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m15:02:43.686012 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:43.688318 [debug] [MainThread]: On master: BEGIN
[0m15:02:43.690084 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:02:43.723476 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:02:43.725937 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:43.728271 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:02:43.739370 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m15:02:43.743448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd926851e-df95-4721-bdd8-2f0c7bfc8e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa221341060>]}
[0m15:02:43.746876 [debug] [MainThread]: On master: ROLLBACK
[0m15:02:43.752350 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:43.754864 [debug] [MainThread]: On master: BEGIN
[0m15:02:43.763903 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:02:43.766294 [debug] [MainThread]: On master: COMMIT
[0m15:02:43.768976 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:43.771210 [debug] [MainThread]: On master: COMMIT
[0m15:02:43.776496 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:02:43.778845 [debug] [MainThread]: On master: Close
[0m15:02:43.782107 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:02:43.785496 [info ] [MainThread]: 
[0m15:02:43.822377 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m15:02:43.825053 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m15:02:43.828335 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m15:02:43.830587 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m15:02:43.839526 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m15:02:43.855747 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 15:02:43.832944 => 2024-02-08 15:02:43.855525
[0m15:02:43.857896 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m15:02:43.989733 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m15:02:44.017082 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:02:44.020630 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m15:02:44.022837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:44.134100 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:02:44.144284 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:02:44.151682 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m15:02:44.163364 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:02:44.192899 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:02:44.195680 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m15:02:44.201888 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "actors" already exists

[0m15:02:44.205310 [debug] [Thread-1 (]: On model.Custom_postgres.actors: ROLLBACK
[0m15:02:44.210970 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:02:44.213024 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:02:44.215052 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 15:02:43.860603 => 2024-02-08 15:02:44.214833
[0m15:02:44.218018 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m15:02:44.228360 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m15:02:44.231537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd926851e-df95-4721-bdd8-2f0c7bfc8e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa221396890>]}
[0m15:02:44.234774 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.40s]
[0m15:02:44.244039 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m15:02:44.246984 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m15:02:44.249428 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m15:02:44.255182 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m15:02:44.257613 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m15:02:44.265304 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m15:02:44.286662 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 15:02:44.259240 => 2024-02-08 15:02:44.286384
[0m15:02:44.290220 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m15:02:44.311427 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m15:02:44.336385 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:02:44.339487 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m15:02:44.341603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:44.388351 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:02:44.390078 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:02:44.391659 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m15:02:44.398227 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:02:44.405937 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:02:44.407810 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m15:02:44.413357 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "film_actors" already exists

[0m15:02:44.415063 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: ROLLBACK
[0m15:02:44.420071 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:02:44.421890 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:02:44.423651 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 15:02:44.292293 => 2024-02-08 15:02:44.423480
[0m15:02:44.425299 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m15:02:44.428779 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "film_actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m15:02:44.430920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd926851e-df95-4721-bdd8-2f0c7bfc8e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22135fdf0>]}
[0m15:02:44.434133 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.18s]
[0m15:02:44.437700 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m15:02:44.439850 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m15:02:44.443007 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m15:02:44.446717 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m15:02:44.449093 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m15:02:44.456356 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m15:02:44.476221 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 15:02:44.450788 => 2024-02-08 15:02:44.475940
[0m15:02:44.478473 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m15:02:44.488983 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m15:02:44.506983 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:02:44.508497 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m15:02:44.510015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:44.538620 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:02:44.540439 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:02:44.542373 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m15:02:44.549111 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:02:44.558757 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:02:44.561624 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m15:02:44.568925 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "films" already exists

[0m15:02:44.571269 [debug] [Thread-1 (]: On model.Custom_postgres.films: ROLLBACK
[0m15:02:44.576619 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:02:44.578092 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:02:44.579684 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 15:02:44.480248 => 2024-02-08 15:02:44.579531
[0m15:02:44.581242 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m15:02:44.585882 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "films" already exists
  compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:02:44.588304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd926851e-df95-4721-bdd8-2f0c7bfc8e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa222dc8160>]}
[0m15:02:44.591087 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.14s]
[0m15:02:44.595182 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m15:02:44.598658 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m15:02:44.601219 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m15:02:44.604618 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m15:02:44.609667 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:02:44.611651 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:44.613871 [debug] [MainThread]: On master: BEGIN
[0m15:02:44.615472 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:02:44.646049 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:02:44.647944 [debug] [MainThread]: On master: COMMIT
[0m15:02:44.649872 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:44.652482 [debug] [MainThread]: On master: COMMIT
[0m15:02:44.656829 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:02:44.658484 [debug] [MainThread]: On master: Close
[0m15:02:44.661197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:44.663101 [debug] [MainThread]: Connection 'model.Custom_postgres.films' was properly closed.
[0m15:02:44.665539 [info ] [MainThread]: 
[0m15:02:44.669169 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.18 seconds (1.18s).
[0m15:02:44.672397 [debug] [MainThread]: Command end result
[0m15:02:44.712498 [info ] [MainThread]: 
[0m15:02:44.716489 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:02:44.719958 [info ] [MainThread]: 
[0m15:02:44.723258 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m15:02:44.726085 [error] [MainThread]:   relation "actors" already exists
[0m15:02:44.729049 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m15:02:44.731893 [info ] [MainThread]: 
[0m15:02:44.737115 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m15:02:44.741809 [error] [MainThread]:   relation "film_actors" already exists
[0m15:02:44.744856 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m15:02:44.748900 [info ] [MainThread]: 
[0m15:02:44.752337 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m15:02:44.755658 [error] [MainThread]:   relation "films" already exists
[0m15:02:44.758201 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:02:44.764845 [info ] [MainThread]: 
[0m15:02:44.769371 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m15:02:44.774950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2213e7ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2213e7c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2213e7370>]}
[0m15:02:44.778067 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 15:07:30.182508 | a8081918-3b4b-48c0-aea9-bebc0fc141c5 ==============================
[0m15:07:30.182508 [info ] [MainThread]: Running with dbt=1.4.7
[0m15:07:30.187206 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:07:30.189309 [debug] [MainThread]: Tracking: tracking
[0m15:07:30.193657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2646f49360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2646f497e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2646f493c0>]}
[0m15:07:30.231009 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m15:07:30.672498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:07:30.675140 [debug] [MainThread]: Partial parsing: updated file: Custom_postgres://models/example/film_actors.sql
[0m15:07:30.717469 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m15:07:30.826104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8081918-3b4b-48c0-aea9-bebc0fc141c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26445100d0>]}
[0m15:07:30.861931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8081918-3b4b-48c0-aea9-bebc0fc141c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26456d9e10>]}
[0m15:07:30.864820 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:07:30.867854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8081918-3b4b-48c0-aea9-bebc0fc141c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2646f564a0>]}
[0m15:07:30.874319 [info ] [MainThread]: 
[0m15:07:30.879956 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:07:30.885669 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m15:07:30.909334 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m15:07:30.912204 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m15:07:30.914669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:30.952964 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m15:07:30.957073 [debug] [ThreadPool]: On list_destination_db: Close
[0m15:07:30.963379 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m15:07:30.979240 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:07:30.981636 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m15:07:30.983668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:31.018057 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:07:31.019926 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:07:31.021563 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:07:31.029912 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m15:07:31.034942 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m15:07:31.041087 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m15:07:31.055447 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:31.057342 [debug] [MainThread]: On master: BEGIN
[0m15:07:31.058942 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:31.090785 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:07:31.092796 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:31.095219 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:07:31.104011 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m15:07:31.108675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8081918-3b4b-48c0-aea9-bebc0fc141c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2644510610>]}
[0m15:07:31.111541 [debug] [MainThread]: On master: ROLLBACK
[0m15:07:31.117100 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:31.119297 [debug] [MainThread]: On master: BEGIN
[0m15:07:31.127642 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:07:31.130107 [debug] [MainThread]: On master: COMMIT
[0m15:07:31.132902 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:31.134921 [debug] [MainThread]: On master: COMMIT
[0m15:07:31.140347 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:07:31.141909 [debug] [MainThread]: On master: Close
[0m15:07:31.145458 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:07:31.151209 [info ] [MainThread]: 
[0m15:07:31.187580 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m15:07:31.189739 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m15:07:31.192917 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m15:07:31.195807 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m15:07:31.205092 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m15:07:31.222553 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 15:07:31.198576 => 2024-02-08 15:07:31.222353
[0m15:07:31.224598 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m15:07:31.349497 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m15:07:31.367961 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:07:31.369533 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m15:07:31.372062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:31.410163 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:07:31.414137 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:07:31.417612 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m15:07:31.425425 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0 seconds
[0m15:07:31.443067 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:07:31.446014 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m15:07:31.452444 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "actors" already exists

[0m15:07:31.455538 [debug] [Thread-1 (]: On model.Custom_postgres.actors: ROLLBACK
[0m15:07:31.461167 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:07:31.465272 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:07:31.467943 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 15:07:31.227025 => 2024-02-08 15:07:31.467714
[0m15:07:31.470407 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m15:07:31.481902 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m15:07:31.485542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8081918-3b4b-48c0-aea9-bebc0fc141c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264568a6b0>]}
[0m15:07:31.487797 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.29s]
[0m15:07:31.497828 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m15:07:31.501396 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m15:07:31.504517 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m15:07:31.510547 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m15:07:31.514032 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m15:07:31.524700 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m15:07:31.544834 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 15:07:31.516515 => 2024-02-08 15:07:31.544562
[0m15:07:31.548330 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m15:07:31.561623 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m15:07:31.582723 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:07:31.584873 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m15:07:31.587817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:31.625490 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:07:31.629926 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:07:31.633397 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m15:07:31.641281 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:07:31.651967 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:07:31.653991 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m15:07:31.661943 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "film_actors" already exists

[0m15:07:31.665045 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: ROLLBACK
[0m15:07:31.672432 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:07:31.674883 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:07:31.677978 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 15:07:31.550825 => 2024-02-08 15:07:31.677733
[0m15:07:31.681185 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m15:07:31.685691 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "film_actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m15:07:31.690212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8081918-3b4b-48c0-aea9-bebc0fc141c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26456cc820>]}
[0m15:07:31.692670 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.18s]
[0m15:07:31.696917 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m15:07:31.699561 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m15:07:31.701620 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m15:07:31.704688 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m15:07:31.706659 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m15:07:31.716410 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m15:07:31.732480 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 15:07:31.708387 => 2024-02-08 15:07:31.732273
[0m15:07:31.734424 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m15:07:31.744698 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m15:07:31.757804 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:07:31.759448 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m15:07:31.761395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:31.791757 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:07:31.793837 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:07:31.795589 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m15:07:31.801752 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:07:31.808251 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:07:31.810541 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m15:07:31.816999 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "films" already exists

[0m15:07:31.819886 [debug] [Thread-1 (]: On model.Custom_postgres.films: ROLLBACK
[0m15:07:31.825735 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:07:31.827982 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:07:31.830756 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 15:07:31.736436 => 2024-02-08 15:07:31.830512
[0m15:07:31.832994 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m15:07:31.837768 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "films" already exists
  compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:07:31.840446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8081918-3b4b-48c0-aea9-bebc0fc141c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26445bb9a0>]}
[0m15:07:31.843852 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.14s]
[0m15:07:31.847648 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m15:07:31.852385 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m15:07:31.856295 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m15:07:31.859681 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m15:07:31.865525 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:07:31.867374 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:31.869538 [debug] [MainThread]: On master: BEGIN
[0m15:07:31.872213 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:07:31.905244 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:07:31.907071 [debug] [MainThread]: On master: COMMIT
[0m15:07:31.908767 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:31.911192 [debug] [MainThread]: On master: COMMIT
[0m15:07:31.916209 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:07:31.918032 [debug] [MainThread]: On master: Close
[0m15:07:31.920890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:31.922745 [debug] [MainThread]: Connection 'model.Custom_postgres.films' was properly closed.
[0m15:07:31.925445 [info ] [MainThread]: 
[0m15:07:31.928445 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m15:07:31.932010 [debug] [MainThread]: Command end result
[0m15:07:31.967094 [info ] [MainThread]: 
[0m15:07:31.969937 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:07:31.973607 [info ] [MainThread]: 
[0m15:07:31.977490 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m15:07:31.981111 [error] [MainThread]:   relation "actors" already exists
[0m15:07:31.984116 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m15:07:31.987525 [info ] [MainThread]: 
[0m15:07:31.990464 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m15:07:31.993715 [error] [MainThread]:   relation "film_actors" already exists
[0m15:07:31.997755 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m15:07:32.001050 [info ] [MainThread]: 
[0m15:07:32.003813 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m15:07:32.006539 [error] [MainThread]:   relation "films" already exists
[0m15:07:32.011732 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:07:32.015899 [info ] [MainThread]: 
[0m15:07:32.020433 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m15:07:32.023317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264443ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264443fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264443f0d0>]}
[0m15:07:32.027643 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 15:08:23.924302 | 22157f5f-f131-4d13-b41f-69aefc6f57a3 ==============================
[0m15:08:23.924302 [info ] [MainThread]: Running with dbt=1.4.7
[0m15:08:23.928854 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:08:23.930917 [debug] [MainThread]: Tracking: tracking
[0m15:08:23.935414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff53651d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff53651d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff53651d390>]}
[0m15:08:23.974369 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m15:08:24.308738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:08:24.311260 [debug] [MainThread]: Partial parsing: updated file: Custom_postgres://macros/film_ratings_macro.sql
[0m15:08:24.313359 [debug] [MainThread]: Partial parsing: updated file: Custom_postgres://models/example/film_ratings.sql
[0m15:08:24.358443 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m15:08:24.496802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22157f5f-f131-4d13-b41f-69aefc6f57a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5340d10c0>]}
[0m15:08:24.533854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22157f5f-f131-4d13-b41f-69aefc6f57a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5364eece0>]}
[0m15:08:24.536224 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:08:24.538733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22157f5f-f131-4d13-b41f-69aefc6f57a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff536535390>]}
[0m15:08:24.544305 [info ] [MainThread]: 
[0m15:08:24.550246 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:08:24.555705 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m15:08:24.579929 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m15:08:24.582334 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m15:08:24.584933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:24.623084 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m15:08:24.626777 [debug] [ThreadPool]: On list_destination_db: Close
[0m15:08:24.632416 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m15:08:24.646336 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:08:24.648288 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m15:08:24.651377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:24.683184 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:08:24.685591 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:08:24.687390 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:08:24.699622 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m15:08:24.704853 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m15:08:24.710826 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m15:08:24.729182 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:24.731545 [debug] [MainThread]: On master: BEGIN
[0m15:08:24.733184 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:24.765213 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:08:24.767319 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:24.769608 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:08:24.779063 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m15:08:24.782830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22157f5f-f131-4d13-b41f-69aefc6f57a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5340a3520>]}
[0m15:08:24.785308 [debug] [MainThread]: On master: ROLLBACK
[0m15:08:24.789990 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:24.792227 [debug] [MainThread]: On master: BEGIN
[0m15:08:24.802351 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:08:24.805159 [debug] [MainThread]: On master: COMMIT
[0m15:08:24.807389 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:24.809400 [debug] [MainThread]: On master: COMMIT
[0m15:08:24.815131 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:08:24.817583 [debug] [MainThread]: On master: Close
[0m15:08:24.822063 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:08:24.825708 [info ] [MainThread]: 
[0m15:08:24.863434 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m15:08:24.865787 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m15:08:24.870733 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m15:08:24.872997 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m15:08:24.882173 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m15:08:24.897444 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 15:08:24.875162 => 2024-02-08 15:08:24.897245
[0m15:08:24.899441 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m15:08:25.025115 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m15:08:25.050032 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:08:25.052594 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m15:08:25.056026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:25.093860 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:08:25.096574 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:08:25.099489 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m15:08:25.109494 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0 seconds
[0m15:08:25.132275 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:08:25.134277 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m15:08:25.144760 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "actors" already exists

[0m15:08:25.147376 [debug] [Thread-1 (]: On model.Custom_postgres.actors: ROLLBACK
[0m15:08:25.153197 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:08:25.156031 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:08:25.159338 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 15:08:24.901757 => 2024-02-08 15:08:25.159090
[0m15:08:25.162089 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m15:08:25.167559 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m15:08:25.171364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22157f5f-f131-4d13-b41f-69aefc6f57a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff534096530>]}
[0m15:08:25.174131 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.30s]
[0m15:08:25.181418 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m15:08:25.186279 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m15:08:25.188994 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m15:08:25.191991 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m15:08:25.194541 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m15:08:25.202131 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m15:08:25.219463 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 15:08:25.196559 => 2024-02-08 15:08:25.219212
[0m15:08:25.222150 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m15:08:25.236215 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m15:08:25.252158 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:08:25.254344 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m15:08:25.256003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:25.289015 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:08:25.290791 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:08:25.292494 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m15:08:25.299864 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:08:25.310747 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:08:25.313506 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m15:08:25.321830 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "film_actors" already exists

[0m15:08:25.324784 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: ROLLBACK
[0m15:08:25.331920 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:08:25.335437 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:08:25.338568 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 15:08:25.224218 => 2024-02-08 15:08:25.338258
[0m15:08:25.341389 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m15:08:25.346294 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "film_actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m15:08:25.350255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22157f5f-f131-4d13-b41f-69aefc6f57a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5340bf340>]}
[0m15:08:25.353454 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.16s]
[0m15:08:25.357378 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m15:08:25.360777 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m15:08:25.364164 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m15:08:25.368660 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m15:08:25.371520 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m15:08:25.382432 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m15:08:25.407361 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 15:08:25.373697 => 2024-02-08 15:08:25.407152
[0m15:08:25.409369 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m15:08:25.421334 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m15:08:25.435201 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:08:25.436919 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m15:08:25.438627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:25.466198 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:08:25.467878 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:08:25.469627 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m15:08:25.476108 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:08:25.482322 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:08:25.484721 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m15:08:25.491698 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "films" already exists

[0m15:08:25.495716 [debug] [Thread-1 (]: On model.Custom_postgres.films: ROLLBACK
[0m15:08:25.501675 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:08:25.503661 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:08:25.505696 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 15:08:25.411643 => 2024-02-08 15:08:25.505531
[0m15:08:25.507522 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m15:08:25.512104 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "films" already exists
  compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:08:25.516763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22157f5f-f131-4d13-b41f-69aefc6f57a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff534c154e0>]}
[0m15:08:25.520118 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.15s]
[0m15:08:25.524408 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m15:08:25.529504 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m15:08:25.531984 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m15:08:25.534893 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m15:08:25.541893 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:08:25.544870 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:25.547305 [debug] [MainThread]: On master: BEGIN
[0m15:08:25.548926 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:25.582394 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:08:25.584337 [debug] [MainThread]: On master: COMMIT
[0m15:08:25.587379 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:25.589286 [debug] [MainThread]: On master: COMMIT
[0m15:08:25.595828 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:08:25.598162 [debug] [MainThread]: On master: Close
[0m15:08:25.602676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:25.606460 [debug] [MainThread]: Connection 'model.Custom_postgres.films' was properly closed.
[0m15:08:25.608539 [info ] [MainThread]: 
[0m15:08:25.611799 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m15:08:25.615010 [debug] [MainThread]: Command end result
[0m15:08:25.649358 [info ] [MainThread]: 
[0m15:08:25.652731 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:08:25.656812 [info ] [MainThread]: 
[0m15:08:25.660619 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m15:08:25.664725 [error] [MainThread]:   relation "actors" already exists
[0m15:08:25.667724 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m15:08:25.671550 [info ] [MainThread]: 
[0m15:08:25.675607 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m15:08:25.678813 [error] [MainThread]:   relation "film_actors" already exists
[0m15:08:25.682274 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m15:08:25.684965 [info ] [MainThread]: 
[0m15:08:25.689620 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m15:08:25.692472 [error] [MainThread]:   relation "films" already exists
[0m15:08:25.696216 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:08:25.699662 [info ] [MainThread]: 
[0m15:08:25.702042 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m15:08:25.704857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff534c17be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff536534b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff52f9ad060>]}
[0m15:08:25.707043 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 15:14:19.073343 | 1e9aa4ce-d5b0-4520-847a-a75528f07f12 ==============================
[0m15:14:19.073343 [info ] [MainThread]: Running with dbt=1.4.7
[0m15:14:19.078142 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:14:19.080137 [debug] [MainThread]: Tracking: tracking
[0m15:14:19.084671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5801db5360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5801db57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5801db53c0>]}
[0m15:14:19.120628 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m15:14:19.467163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:14:19.469154 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:14:19.483429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e9aa4ce-d5b0-4520-847a-a75528f07f12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58004f0ca0>]}
[0m15:14:19.520417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e9aa4ce-d5b0-4520-847a-a75528f07f12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58004362c0>]}
[0m15:14:19.522733 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:14:19.526332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e9aa4ce-d5b0-4520-847a-a75528f07f12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5800436320>]}
[0m15:14:19.532807 [info ] [MainThread]: 
[0m15:14:19.540694 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:14:19.555336 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m15:14:19.593116 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m15:14:19.595333 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m15:14:19.597083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:19.635301 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m15:14:19.639183 [debug] [ThreadPool]: On list_destination_db: Close
[0m15:14:19.644837 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m15:14:19.657385 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:14:19.659329 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m15:14:19.661082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:19.690884 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:14:19.693040 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:14:19.694930 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:14:19.705883 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m15:14:19.710353 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m15:14:19.715565 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m15:14:19.727954 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:19.730300 [debug] [MainThread]: On master: BEGIN
[0m15:14:19.732120 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:19.765399 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:14:19.767343 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:19.769144 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:14:19.778822 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m15:14:19.783110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e9aa4ce-d5b0-4520-847a-a75528f07f12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58003438b0>]}
[0m15:14:19.785639 [debug] [MainThread]: On master: ROLLBACK
[0m15:14:19.792055 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:19.794167 [debug] [MainThread]: On master: BEGIN
[0m15:14:19.816869 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:14:19.819280 [debug] [MainThread]: On master: COMMIT
[0m15:14:19.821699 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:19.824031 [debug] [MainThread]: On master: COMMIT
[0m15:14:19.828361 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:14:19.829995 [debug] [MainThread]: On master: Close
[0m15:14:19.832551 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:19.835770 [info ] [MainThread]: 
[0m15:14:19.894755 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m15:14:19.897631 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m15:14:19.902000 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m15:14:19.905335 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m15:14:19.916811 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m15:14:19.943539 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 15:14:19.909336 => 2024-02-08 15:14:19.943277
[0m15:14:19.947897 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m15:14:20.105006 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m15:14:20.124564 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:14:20.127387 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m15:14:20.129763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:20.167532 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:14:20.170529 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:14:20.173922 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m15:14:20.182451 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:14:20.223540 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:14:20.225545 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m15:14:20.231599 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "actors" already exists

[0m15:14:20.234003 [debug] [Thread-1 (]: On model.Custom_postgres.actors: ROLLBACK
[0m15:14:20.240532 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:14:20.243066 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:14:20.245658 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 15:14:19.950811 => 2024-02-08 15:14:20.245468
[0m15:14:20.247774 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m15:14:20.257378 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m15:14:20.260048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9aa4ce-d5b0-4520-847a-a75528f07f12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5800382890>]}
[0m15:14:20.262458 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.36s]
[0m15:14:20.267863 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m15:14:20.271704 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m15:14:20.274902 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m15:14:20.278757 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m15:14:20.281021 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m15:14:20.291064 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m15:14:20.326977 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 15:14:20.283284 => 2024-02-08 15:14:20.326677
[0m15:14:20.329650 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m15:14:20.340762 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m15:14:20.355159 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:14:20.357117 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m15:14:20.359717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:20.392356 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:14:20.394526 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:14:20.396234 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m15:14:20.401892 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:14:20.408520 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:14:20.410716 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m15:14:20.417021 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "film_actors" already exists

[0m15:14:20.420171 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: ROLLBACK
[0m15:14:20.425784 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:14:20.427473 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:14:20.429229 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 15:14:20.331745 => 2024-02-08 15:14:20.429068
[0m15:14:20.430770 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m15:14:20.434103 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "film_actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m15:14:20.437161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9aa4ce-d5b0-4520-847a-a75528f07f12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58004f05b0>]}
[0m15:14:20.441176 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.16s]
[0m15:14:20.443386 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m15:14:20.446278 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m15:14:20.448575 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m15:14:20.451907 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m15:14:20.454535 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m15:14:20.461740 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m15:14:20.478548 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 15:14:20.456872 => 2024-02-08 15:14:20.478248
[0m15:14:20.480662 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m15:14:20.490684 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m15:14:20.506854 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:14:20.508734 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m15:14:20.510335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:20.540858 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:14:20.542749 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:14:20.544678 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m15:14:20.570283 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:14:20.580392 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:14:20.582368 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m15:14:20.589456 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "films" already exists

[0m15:14:20.591762 [debug] [Thread-1 (]: On model.Custom_postgres.films: ROLLBACK
[0m15:14:20.597034 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:14:20.599195 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:14:20.602327 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 15:14:20.482242 => 2024-02-08 15:14:20.602076
[0m15:14:20.606005 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m15:14:20.611967 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "films" already exists
  compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:14:20.621409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9aa4ce-d5b0-4520-847a-a75528f07f12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5800382b00>]}
[0m15:14:20.624930 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.17s]
[0m15:14:20.628531 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m15:14:20.632368 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m15:14:20.634411 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m15:14:20.639243 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m15:14:20.645741 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:14:20.648183 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:20.650369 [debug] [MainThread]: On master: BEGIN
[0m15:14:20.653373 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:14:20.697320 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:14:20.699699 [debug] [MainThread]: On master: COMMIT
[0m15:14:20.702006 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:20.706038 [debug] [MainThread]: On master: COMMIT
[0m15:14:20.711350 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:14:20.713336 [debug] [MainThread]: On master: Close
[0m15:14:20.715979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:20.718042 [debug] [MainThread]: Connection 'model.Custom_postgres.films' was properly closed.
[0m15:14:20.721840 [info ] [MainThread]: 
[0m15:14:20.725107 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m15:14:20.727861 [debug] [MainThread]: Command end result
[0m15:14:20.762285 [info ] [MainThread]: 
[0m15:14:20.765519 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:14:20.768675 [info ] [MainThread]: 
[0m15:14:20.773211 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m15:14:20.775929 [error] [MainThread]:   relation "actors" already exists
[0m15:14:20.778724 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m15:14:20.781431 [info ] [MainThread]: 
[0m15:14:20.784162 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m15:14:20.787841 [error] [MainThread]:   relation "film_actors" already exists
[0m15:14:20.791405 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m15:14:20.793875 [info ] [MainThread]: 
[0m15:14:20.800884 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m15:14:20.809794 [error] [MainThread]:   relation "films" already exists
[0m15:14:20.820749 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:14:20.829841 [info ] [MainThread]: 
[0m15:14:20.833607 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m15:14:20.837377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f580038f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f580038d330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f580038dc90>]}
[0m15:14:20.840500 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 15:22:37.180339 | 46eea0c6-7c0a-4515-b9c5-79ddb0ea0744 ==============================
[0m15:22:37.180339 [info ] [MainThread]: Running with dbt=1.4.7
[0m15:22:37.185179 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:22:37.187696 [debug] [MainThread]: Tracking: tracking
[0m15:22:37.192644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce7b150f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce7b157b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce7b15390>]}
[0m15:22:37.233535 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m15:22:37.647180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m15:22:37.650188 [debug] [MainThread]: Partial parsing: updated file: Custom_postgres://models/example/film_actors.sql
[0m15:22:37.652634 [debug] [MainThread]: Partial parsing: updated file: Custom_postgres://models/example/actors.sql
[0m15:22:37.654855 [debug] [MainThread]: Partial parsing: updated file: Custom_postgres://models/example/films.sql
[0m15:22:37.696926 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m15:22:37.724127 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m15:22:37.731812 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m15:22:37.842765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce626d120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce628c100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce6236140>]}
[0m15:22:37.845017 [debug] [MainThread]: Flushing usage events
[0m15:22:38.527234 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.Custom_postgres.film_actors' (models/example/film_actors.sql) depends on a source named 'destination_db.film_actors2' which was not found


============================== 2024-02-08 15:23:21.410069 | 3bc3d5af-c222-42c2-9cae-ca4cbe77adeb ==============================
[0m15:23:21.410069 [info ] [MainThread]: Running with dbt=1.4.7
[0m15:23:21.414963 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:23:21.417256 [debug] [MainThread]: Tracking: tracking
[0m15:23:21.421515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdc4bf10f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdc4bf17b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdc4bf1390>]}
[0m15:23:21.460375 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m15:23:21.879522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:23:21.883016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:23:21.897083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bc3d5af-c222-42c2-9cae-ca4cbe77adeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdc3328c40>]}
[0m15:23:21.935227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bc3d5af-c222-42c2-9cae-ca4cbe77adeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdc3476260>]}
[0m15:23:21.937583 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:23:21.940127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bc3d5af-c222-42c2-9cae-ca4cbe77adeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdc34762c0>]}
[0m15:23:21.945015 [info ] [MainThread]: 
[0m15:23:21.950543 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:21.954668 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m15:23:21.979021 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m15:23:21.981659 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m15:23:21.984321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:22.022456 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m15:23:22.026603 [debug] [ThreadPool]: On list_destination_db: Close
[0m15:23:22.032145 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m15:23:22.044601 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:23:22.046622 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m15:23:22.048365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:22.078133 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:23:22.080288 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:23:22.082473 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:23:22.091725 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m15:23:22.095511 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m15:23:22.101340 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m15:23:22.114914 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:22.117005 [debug] [MainThread]: On master: BEGIN
[0m15:23:22.119019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:22.149954 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:23:22.152003 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:22.153811 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:23:22.165437 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m15:23:22.170422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bc3d5af-c222-42c2-9cae-ca4cbe77adeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdc33738b0>]}
[0m15:23:22.173167 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:22.179137 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:22.181673 [debug] [MainThread]: On master: BEGIN
[0m15:23:22.189270 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:23:22.192063 [debug] [MainThread]: On master: COMMIT
[0m15:23:22.194563 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:22.196534 [debug] [MainThread]: On master: COMMIT
[0m15:23:22.203288 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:23:22.235873 [debug] [MainThread]: On master: Close
[0m15:23:22.240298 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:22.276638 [info ] [MainThread]: 
[0m15:23:22.318236 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m15:23:22.320513 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m15:23:22.323993 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m15:23:22.326315 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m15:23:22.335441 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m15:23:22.354222 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 15:23:22.328591 => 2024-02-08 15:23:22.354009
[0m15:23:22.356109 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m15:23:22.440173 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m15:23:22.459159 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:23:22.461366 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m15:23:22.463502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:22.493931 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:23:22.495900 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:23:22.497716 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m15:23:22.503726 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m15:23:22.506593 [debug] [Thread-1 (]: On model.Custom_postgres.actors: ROLLBACK
[0m15:23:22.513355 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 15:23:22.358116 => 2024-02-08 15:23:22.513124
[0m15:23:22.515246 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m15:23:22.520544 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m15:23:22.522956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bc3d5af-c222-42c2-9cae-ca4cbe77adeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdc31b6890>]}
[0m15:23:22.531185 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.20s]
[0m15:23:22.541702 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m15:23:22.545121 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m15:23:22.548099 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m15:23:22.555571 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m15:23:22.558036 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m15:23:22.575416 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m15:23:22.600009 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 15:23:22.561329 => 2024-02-08 15:23:22.599779
[0m15:23:22.603144 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m15:23:22.620483 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m15:23:22.646675 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:23:22.649403 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m15:23:22.653099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:22.699014 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:23:22.701936 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:23:22.705721 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m15:23:22.715872 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:23:22.748602 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:23:22.750935 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m15:23:22.758794 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "film_actors" already exists

[0m15:23:22.762789 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: ROLLBACK
[0m15:23:22.769335 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:23:22.771273 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:23:22.774054 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 15:23:22.605806 => 2024-02-08 15:23:22.773783
[0m15:23:22.777897 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m15:23:22.783387 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "film_actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m15:23:22.787267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bc3d5af-c222-42c2-9cae-ca4cbe77adeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdc31d8280>]}
[0m15:23:22.790205 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.23s]
[0m15:23:22.794962 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m15:23:22.798417 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m15:23:22.800786 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m15:23:22.804995 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m15:23:22.808307 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m15:23:22.819682 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m15:23:22.842762 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 15:23:22.813047 => 2024-02-08 15:23:22.842480
[0m15:23:22.848612 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m15:23:22.867381 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m15:23:22.889679 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:23:22.892849 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m15:23:22.895023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:22.930068 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:23:22.932377 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:23:22.934429 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m15:23:22.941849 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:23:22.949060 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:23:22.951125 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m15:23:22.957763 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "films" already exists

[0m15:23:22.960534 [debug] [Thread-1 (]: On model.Custom_postgres.films: ROLLBACK
[0m15:23:22.966644 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:23:22.969138 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:23:22.971319 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 15:23:22.851791 => 2024-02-08 15:23:22.971103
[0m15:23:22.973073 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m15:23:22.977828 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "films" already exists
  compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:23:22.980624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bc3d5af-c222-42c2-9cae-ca4cbe77adeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdc3382e90>]}
[0m15:23:22.983945 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.18s]
[0m15:23:22.988424 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m15:23:22.992378 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m15:23:22.995209 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m15:23:22.997706 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m15:23:23.003601 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:23.005365 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:23.007661 [debug] [MainThread]: On master: BEGIN
[0m15:23:23.010782 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:23.045803 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:23:23.047753 [debug] [MainThread]: On master: COMMIT
[0m15:23:23.049513 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:23.052099 [debug] [MainThread]: On master: COMMIT
[0m15:23:23.058295 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:23:23.061009 [debug] [MainThread]: On master: Close
[0m15:23:23.065043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:23.067673 [debug] [MainThread]: Connection 'model.Custom_postgres.films' was properly closed.
[0m15:23:23.070727 [info ] [MainThread]: 
[0m15:23:23.073401 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m15:23:23.077424 [debug] [MainThread]: Command end result
[0m15:23:23.107232 [info ] [MainThread]: 
[0m15:23:23.110697 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:23:23.113936 [info ] [MainThread]: 
[0m15:23:23.117804 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m15:23:23.121127 [error] [MainThread]:   relation "public.actors" does not exist
[0m15:23:23.124744 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m15:23:23.128143 [error] [MainThread]:                             ^
[0m15:23:23.131357 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m15:23:23.134168 [info ] [MainThread]: 
[0m15:23:23.140207 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m15:23:23.143637 [error] [MainThread]:   relation "film_actors" already exists
[0m15:23:23.146504 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m15:23:23.149151 [info ] [MainThread]: 
[0m15:23:23.151242 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m15:23:23.153278 [error] [MainThread]:   relation "films" already exists
[0m15:23:23.155458 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:23:23.158647 [info ] [MainThread]: 
[0m15:23:23.163009 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m15:23:23.166053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdc31f4eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdc3381a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdc3373730>]}
[0m15:23:23.168783 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 15:26:46.838339 | 1c66e0c7-5cd5-4f09-9f8b-528a9bbb2ed4 ==============================
[0m15:26:46.838339 [info ] [MainThread]: Running with dbt=1.4.7
[0m15:26:46.842895 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:26:46.845061 [debug] [MainThread]: Tracking: tracking
[0m15:26:46.849398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b82395360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b823957e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b823953c0>]}
[0m15:26:46.884278 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m15:26:47.257227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:26:47.259845 [debug] [MainThread]: Partial parsing: updated file: Custom_postgres://models/example/actors.sql
[0m15:26:47.302982 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m15:26:47.410858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c66e0c7-5cd5-4f09-9f8b-528a9bbb2ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b6fb36980>]}
[0m15:26:47.451314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c66e0c7-5cd5-4f09-9f8b-528a9bbb2ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b6fb01bd0>]}
[0m15:26:47.453768 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:26:47.456569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c66e0c7-5cd5-4f09-9f8b-528a9bbb2ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b82399450>]}
[0m15:26:47.461859 [info ] [MainThread]: 
[0m15:26:47.468491 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:26:47.474958 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m15:26:47.503440 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m15:26:47.506207 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m15:26:47.508136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:47.547571 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m15:26:47.551592 [debug] [ThreadPool]: On list_destination_db: Close
[0m15:26:47.557225 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m15:26:47.570055 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:26:47.571879 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m15:26:47.573583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:47.603946 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:26:47.605896 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:26:47.608047 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:26:47.616767 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m15:26:47.621446 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m15:26:47.627844 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m15:26:47.640899 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:47.643060 [debug] [MainThread]: On master: BEGIN
[0m15:26:47.645501 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:26:47.678000 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:26:47.680421 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:47.682678 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:26:47.692391 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m15:26:47.698095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c66e0c7-5cd5-4f09-9f8b-528a9bbb2ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b6fb34250>]}
[0m15:26:47.701364 [debug] [MainThread]: On master: ROLLBACK
[0m15:26:47.708246 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:47.710408 [debug] [MainThread]: On master: BEGIN
[0m15:26:47.718671 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:26:47.721266 [debug] [MainThread]: On master: COMMIT
[0m15:26:47.724036 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:47.725989 [debug] [MainThread]: On master: COMMIT
[0m15:26:47.731536 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:26:47.733449 [debug] [MainThread]: On master: Close
[0m15:26:47.737303 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:26:47.742223 [info ] [MainThread]: 
[0m15:26:47.788611 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m15:26:47.791673 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m15:26:47.795150 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m15:26:47.797526 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m15:26:47.810446 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m15:26:47.836299 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 15:26:47.801086 => 2024-02-08 15:26:47.836004
[0m15:26:47.839555 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m15:26:47.977326 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m15:26:47.999341 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:26:48.001758 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m15:26:48.004478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:48.035428 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:26:48.037388 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:26:48.039143 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    -- films.sql
SELECT * FROM "destination_db"."public"."films"
  );
  
[0m15:26:48.046766 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:26:48.075089 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:26:48.077565 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m15:26:48.086610 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "actors" already exists

[0m15:26:48.090185 [debug] [Thread-1 (]: On model.Custom_postgres.actors: ROLLBACK
[0m15:26:48.095999 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:26:48.100317 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:26:48.103474 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 15:26:47.842831 => 2024-02-08 15:26:48.103202
[0m15:26:48.108555 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m15:26:48.115951 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m15:26:48.121146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c66e0c7-5cd5-4f09-9f8b-528a9bbb2ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b80ad37c0>]}
[0m15:26:48.126521 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.32s]
[0m15:26:48.133120 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m15:26:48.135177 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m15:26:48.139760 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m15:26:48.142762 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m15:26:48.144951 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m15:26:48.151665 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m15:26:48.168163 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 15:26:48.146530 => 2024-02-08 15:26:48.167961
[0m15:26:48.171579 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m15:26:48.182847 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m15:26:48.199035 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:26:48.200757 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m15:26:48.202435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:48.231541 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:26:48.233236 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:26:48.234827 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m15:26:48.241105 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:26:48.247512 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:26:48.249820 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m15:26:48.256568 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "film_actors" already exists

[0m15:26:48.259777 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: ROLLBACK
[0m15:26:48.265325 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:26:48.266863 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:26:48.268564 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 15:26:48.174265 => 2024-02-08 15:26:48.268402
[0m15:26:48.270965 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m15:26:48.275616 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "film_actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m15:26:48.278243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c66e0c7-5cd5-4f09-9f8b-528a9bbb2ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b80b106d0>]}
[0m15:26:48.281569 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.14s]
[0m15:26:48.284153 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m15:26:48.286810 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m15:26:48.289852 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m15:26:48.293654 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m15:26:48.296103 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m15:26:48.302463 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m15:26:48.318964 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 15:26:48.297801 => 2024-02-08 15:26:48.318709
[0m15:26:48.322076 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m15:26:48.334139 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m15:26:48.348535 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:26:48.350293 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m15:26:48.351935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:48.380422 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:26:48.382239 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:26:48.383840 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m15:26:48.390282 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:26:48.396545 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:26:48.398434 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m15:26:48.405587 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "films" already exists

[0m15:26:48.408110 [debug] [Thread-1 (]: On model.Custom_postgres.films: ROLLBACK
[0m15:26:48.414213 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:26:48.415998 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:26:48.418814 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 15:26:48.324609 => 2024-02-08 15:26:48.418386
[0m15:26:48.421249 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m15:26:48.425596 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "films" already exists
  compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:26:48.429078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c66e0c7-5cd5-4f09-9f8b-528a9bbb2ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b80b10a90>]}
[0m15:26:48.432053 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.14s]
[0m15:26:48.435255 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m15:26:48.440024 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m15:26:48.442577 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m15:26:48.445767 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m15:26:48.452561 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:26:48.455407 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:48.457893 [debug] [MainThread]: On master: BEGIN
[0m15:26:48.460280 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:26:48.497833 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:26:48.499626 [debug] [MainThread]: On master: COMMIT
[0m15:26:48.501283 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:48.503489 [debug] [MainThread]: On master: COMMIT
[0m15:26:48.507756 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:26:48.509453 [debug] [MainThread]: On master: Close
[0m15:26:48.513110 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:48.518385 [debug] [MainThread]: Connection 'model.Custom_postgres.films' was properly closed.
[0m15:26:48.520806 [info ] [MainThread]: 
[0m15:26:48.525486 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m15:26:48.529251 [debug] [MainThread]: Command end result
[0m15:26:48.577234 [info ] [MainThread]: 
[0m15:26:48.581434 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:26:48.584626 [info ] [MainThread]: 
[0m15:26:48.587933 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m15:26:48.592569 [error] [MainThread]:   relation "actors" already exists
[0m15:26:48.594997 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m15:26:48.597784 [info ] [MainThread]: 
[0m15:26:48.600847 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m15:26:48.604364 [error] [MainThread]:   relation "film_actors" already exists
[0m15:26:48.607643 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m15:26:48.610930 [info ] [MainThread]: 
[0m15:26:48.613217 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m15:26:48.616772 [error] [MainThread]:   relation "films" already exists
[0m15:26:48.619829 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:26:48.623198 [info ] [MainThread]: 
[0m15:26:48.626209 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m15:26:48.629078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b6fb01b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b6fa6b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b6fa6ad10>]}
[0m15:26:48.631130 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 15:28:09.885550 | 3e20be0a-1238-499d-a691-8785a258cd9b ==============================
[0m15:28:09.885550 [info ] [MainThread]: Running with dbt=1.4.7
[0m15:28:09.890192 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:28:09.892138 [debug] [MainThread]: Tracking: tracking
[0m15:28:09.895988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd49d8490f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd49d8497b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd49d849390>]}
[0m15:28:09.934108 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m15:28:10.335752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:28:10.338219 [debug] [MainThread]: Partial parsing: updated file: Custom_postgres://models/example/film_ratings.sql
[0m15:28:10.340308 [debug] [MainThread]: Partial parsing: updated file: Custom_postgres://macros/film_ratings_macro.sql
[0m15:28:10.390827 [debug] [MainThread]: 1603: static parser failed on example/film_ratings.sql
[0m15:28:10.420730 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/film_ratings.sql
[0m15:28:10.559630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e20be0a-1238-499d-a691-8785a258cd9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd49bf95060>]}
[0m15:28:10.597788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e20be0a-1238-499d-a691-8785a258cd9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd49d81ad70>]}
[0m15:28:10.600136 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:28:10.602853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e20be0a-1238-499d-a691-8785a258cd9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd49d863bb0>]}
[0m15:28:10.608292 [info ] [MainThread]: 
[0m15:28:10.615244 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:28:10.620633 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m15:28:10.648072 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m15:28:10.650389 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m15:28:10.653404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:10.692006 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m15:28:10.697002 [debug] [ThreadPool]: On list_destination_db: Close
[0m15:28:10.702279 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m15:28:10.725166 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:28:10.728245 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m15:28:10.730495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:28:10.770099 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:28:10.772917 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:28:10.775641 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:28:10.789160 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m15:28:10.798021 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m15:28:10.804754 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m15:28:10.831449 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:10.834546 [debug] [MainThread]: On master: BEGIN
[0m15:28:10.837775 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:28:10.880516 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:28:10.883222 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:10.886277 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:28:10.902671 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m15:28:10.907765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e20be0a-1238-499d-a691-8785a258cd9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd49ae4f9a0>]}
[0m15:28:10.910025 [debug] [MainThread]: On master: ROLLBACK
[0m15:28:10.915417 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:10.917953 [debug] [MainThread]: On master: BEGIN
[0m15:28:10.931513 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:28:10.933654 [debug] [MainThread]: On master: COMMIT
[0m15:28:10.936471 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:10.939779 [debug] [MainThread]: On master: COMMIT
[0m15:28:10.945701 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:28:10.947997 [debug] [MainThread]: On master: Close
[0m15:28:10.951091 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:28:10.956123 [info ] [MainThread]: 
[0m15:28:10.995484 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m15:28:10.998165 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m15:28:11.002486 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m15:28:11.005461 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m15:28:11.013307 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m15:28:11.034297 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 15:28:11.007247 => 2024-02-08 15:28:11.033962
[0m15:28:11.037952 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m15:28:11.145553 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m15:28:11.158549 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:28:11.160231 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m15:28:11.161712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:11.190179 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:28:11.192077 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:28:11.193803 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    -- films.sql
SELECT * FROM "destination_db"."public"."films"
  );
  
[0m15:28:11.201415 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:28:11.215714 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:28:11.218396 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m15:28:11.224839 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:28:11.231949 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:28:11.234223 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m15:28:11.240868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:28:11.285478 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m15:28:11.287601 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:28:11.289297 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m15:28:11.298848 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m15:28:11.310889 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:28:11.312766 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m15:28:11.324438 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m15:28:11.328134 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 15:28:11.040113 => 2024-02-08 15:28:11.328032
[0m15:28:11.330304 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m15:28:11.333109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e20be0a-1238-499d-a691-8785a258cd9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd49aeb0f70>]}
[0m15:28:11.335932 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.33s]
[0m15:28:11.341478 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m15:28:11.344022 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m15:28:11.346512 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m15:28:11.349709 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m15:28:11.352574 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m15:28:11.362548 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m15:28:11.382394 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 15:28:11.354869 => 2024-02-08 15:28:11.382174
[0m15:28:11.384445 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m15:28:11.395002 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m15:28:11.415015 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:28:11.417042 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m15:28:11.419310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:11.450080 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:28:11.452492 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:28:11.454509 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m15:28:11.465657 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:28:11.475023 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:28:11.477312 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m15:28:11.483263 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:28:11.494242 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:28:11.496552 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m15:28:11.502741 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:28:11.508455 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m15:28:11.510924 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:28:11.513793 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m15:28:11.525902 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m15:28:11.533224 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:28:11.535559 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m15:28:11.546537 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m15:28:11.551349 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 15:28:11.386751 => 2024-02-08 15:28:11.551225
[0m15:28:11.553875 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m15:28:11.557024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e20be0a-1238-499d-a691-8785a258cd9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd49ace0e80>]}
[0m15:28:11.559575 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.21s]
[0m15:28:11.562700 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m15:28:11.564948 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m15:28:11.566954 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m15:28:11.570798 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m15:28:11.573330 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m15:28:11.581566 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m15:28:11.599410 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 15:28:11.574808 => 2024-02-08 15:28:11.599215
[0m15:28:11.601840 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m15:28:11.613489 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m15:28:11.628665 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:28:11.630477 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m15:28:11.632197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:11.660496 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:28:11.662255 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:28:11.663904 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m15:28:11.670162 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:28:11.676517 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:28:11.678397 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m15:28:11.685912 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "films" already exists

[0m15:28:11.688268 [debug] [Thread-1 (]: On model.Custom_postgres.films: ROLLBACK
[0m15:28:11.695347 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:28:11.697674 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:28:11.699778 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 15:28:11.604187 => 2024-02-08 15:28:11.699528
[0m15:28:11.702490 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m15:28:11.708740 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "films" already exists
  compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:28:11.712056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e20be0a-1238-499d-a691-8785a258cd9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd49aeaa0b0>]}
[0m15:28:11.714616 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.14s]
[0m15:28:11.717071 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m15:28:11.722564 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m15:28:11.724589 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m15:28:11.728427 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m15:28:11.733026 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:28:11.735853 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:11.738748 [debug] [MainThread]: On master: BEGIN
[0m15:28:11.741265 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:28:11.773061 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:28:11.775406 [debug] [MainThread]: On master: COMMIT
[0m15:28:11.777716 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:11.780527 [debug] [MainThread]: On master: COMMIT
[0m15:28:11.785819 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:28:11.788083 [debug] [MainThread]: On master: Close
[0m15:28:11.791511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:11.793595 [debug] [MainThread]: Connection 'model.Custom_postgres.films' was properly closed.
[0m15:28:11.796237 [info ] [MainThread]: 
[0m15:28:11.798612 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.18 seconds (1.18s).
[0m15:28:11.802428 [debug] [MainThread]: Command end result
[0m15:28:11.837762 [info ] [MainThread]: 
[0m15:28:11.841203 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:28:11.844113 [info ] [MainThread]: 
[0m15:28:11.846965 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m15:28:11.849849 [error] [MainThread]:   relation "films" already exists
[0m15:28:11.853708 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:28:11.857409 [info ] [MainThread]: 
[0m15:28:11.860985 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m15:28:11.864955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd49acda0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd49acd9a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd49acd8d30>]}
[0m15:28:11.868417 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 15:28:51.499669 | 622a59d5-cce6-4e2f-86d3-5e31005d12c3 ==============================
[0m15:28:51.499669 [info ] [MainThread]: Running with dbt=1.4.7
[0m15:28:51.504396 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:28:51.506539 [debug] [MainThread]: Tracking: tracking
[0m15:28:51.510470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414d409360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414d4097e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414d4093c0>]}
[0m15:28:51.548003 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m15:28:51.982912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:28:51.985583 [debug] [MainThread]: Partial parsing: updated file: Custom_postgres://models/example/films.sql
[0m15:28:52.028900 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m15:28:52.164090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '622a59d5-cce6-4e2f-86d3-5e31005d12c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414a9b7eb0>]}
[0m15:28:52.206261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '622a59d5-cce6-4e2f-86d3-5e31005d12c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414d3d3040>]}
[0m15:28:52.209725 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:28:52.214075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '622a59d5-cce6-4e2f-86d3-5e31005d12c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414d4208b0>]}
[0m15:28:52.220752 [info ] [MainThread]: 
[0m15:28:52.226469 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:28:52.230849 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m15:28:52.261551 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m15:28:52.263409 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m15:28:52.265015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:52.310921 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m15:28:52.315034 [debug] [ThreadPool]: On list_destination_db: Close
[0m15:28:52.320638 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m15:28:52.334365 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:28:52.336234 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m15:28:52.338021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:28:52.368404 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:28:52.370456 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:28:52.372056 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:28:52.380137 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m15:28:52.384171 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m15:28:52.388862 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m15:28:52.400042 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:52.402196 [debug] [MainThread]: On master: BEGIN
[0m15:28:52.404628 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:28:52.435982 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:28:52.437806 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:52.439477 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:28:52.450000 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m15:28:52.456926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '622a59d5-cce6-4e2f-86d3-5e31005d12c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414a9eb4f0>]}
[0m15:28:52.462106 [debug] [MainThread]: On master: ROLLBACK
[0m15:28:52.468455 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:52.472125 [debug] [MainThread]: On master: BEGIN
[0m15:28:52.483484 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:28:52.486665 [debug] [MainThread]: On master: COMMIT
[0m15:28:52.489693 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:52.492511 [debug] [MainThread]: On master: COMMIT
[0m15:28:52.499232 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:28:52.502505 [debug] [MainThread]: On master: Close
[0m15:28:52.508204 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:28:52.511751 [info ] [MainThread]: 
[0m15:28:52.564672 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m15:28:52.567721 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m15:28:52.574334 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m15:28:52.576421 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m15:28:52.587705 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m15:28:52.609780 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 15:28:52.580343 => 2024-02-08 15:28:52.609529
[0m15:28:52.612329 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m15:28:52.746509 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m15:28:52.772369 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:28:52.775216 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m15:28:52.778528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:52.876071 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:28:52.879152 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:28:52.882669 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    -- films.sql
SELECT * FROM "destination_db"."public"."films"
  );
  
[0m15:28:52.891960 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:28:52.915309 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:28:52.917929 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m15:28:52.925141 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "actors" already exists

[0m15:28:52.927494 [debug] [Thread-1 (]: On model.Custom_postgres.actors: ROLLBACK
[0m15:28:52.933002 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:28:52.935435 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:28:52.938093 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 15:28:52.614694 => 2024-02-08 15:28:52.937910
[0m15:28:52.939922 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m15:28:52.945578 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m15:28:52.947889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '622a59d5-cce6-4e2f-86d3-5e31005d12c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414a981cc0>]}
[0m15:28:52.950674 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.37s]
[0m15:28:52.956983 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m15:28:52.959448 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m15:28:52.961537 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m15:28:52.964587 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m15:28:52.966810 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m15:28:52.975395 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m15:28:52.989194 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 15:28:52.969346 => 2024-02-08 15:28:52.988959
[0m15:28:52.991191 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m15:28:53.002736 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m15:28:53.015070 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:28:53.017105 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m15:28:53.019075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:53.048055 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:28:53.049855 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:28:53.051605 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m15:28:53.058004 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:28:53.065769 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:28:53.068414 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m15:28:53.076853 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "film_actors" already exists

[0m15:28:53.079855 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: ROLLBACK
[0m15:28:53.085947 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:28:53.088262 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:28:53.090657 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 15:28:52.993079 => 2024-02-08 15:28:53.090485
[0m15:28:53.092819 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m15:28:53.097635 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "film_actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m15:28:53.100740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '622a59d5-cce6-4e2f-86d3-5e31005d12c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414a9812a0>]}
[0m15:28:53.104244 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.14s]
[0m15:28:53.107605 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m15:28:53.109790 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m15:28:53.112956 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m15:28:53.116041 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m15:28:53.118915 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m15:28:53.126856 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m15:28:53.145474 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 15:28:53.121315 => 2024-02-08 15:28:53.145250
[0m15:28:53.147331 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m15:28:53.162402 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m15:28:53.178706 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:28:53.180845 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m15:28:53.186168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:53.220669 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:28:53.222443 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:28:53.224415 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    -- films.sql
SELECT * FROM "destination_db"."public"."films"
  );
  
[0m15:28:53.233416 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:28:53.246074 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:28:53.248237 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m15:28:53.259999 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "films" already exists

[0m15:28:53.263169 [debug] [Thread-1 (]: On model.Custom_postgres.films: ROLLBACK
[0m15:28:53.272860 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:28:53.277040 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:28:53.280125 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 15:28:53.149032 => 2024-02-08 15:28:53.279844
[0m15:28:53.282280 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m15:28:53.287335 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "films" already exists
  compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:28:53.291116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '622a59d5-cce6-4e2f-86d3-5e31005d12c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414a920a90>]}
[0m15:28:53.294356 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.18s]
[0m15:28:53.297511 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m15:28:53.302406 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m15:28:53.305095 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m15:28:53.308648 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m15:28:53.314315 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:28:53.316440 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:53.319049 [debug] [MainThread]: On master: BEGIN
[0m15:28:53.321567 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:28:53.354643 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:28:53.356997 [debug] [MainThread]: On master: COMMIT
[0m15:28:53.359001 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:53.361352 [debug] [MainThread]: On master: COMMIT
[0m15:28:53.365731 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:28:53.368336 [debug] [MainThread]: On master: Close
[0m15:28:53.371511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:53.375850 [debug] [MainThread]: Connection 'model.Custom_postgres.films' was properly closed.
[0m15:28:53.377805 [info ] [MainThread]: 
[0m15:28:53.379834 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m15:28:53.382663 [debug] [MainThread]: Command end result
[0m15:28:53.411624 [info ] [MainThread]: 
[0m15:28:53.414275 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:28:53.417407 [info ] [MainThread]: 
[0m15:28:53.420814 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m15:28:53.424503 [error] [MainThread]:   relation "actors" already exists
[0m15:28:53.427354 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m15:28:53.430793 [info ] [MainThread]: 
[0m15:28:53.433511 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m15:28:53.436741 [error] [MainThread]:   relation "film_actors" already exists
[0m15:28:53.439887 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m15:28:53.442329 [info ] [MainThread]: 
[0m15:28:53.445271 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m15:28:53.448365 [error] [MainThread]:   relation "films" already exists
[0m15:28:53.451452 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:28:53.455290 [info ] [MainThread]: 
[0m15:28:53.458164 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m15:28:53.462280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414a9235e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414a922d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414a921f90>]}
[0m15:28:53.464475 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 15:29:15.840248 | 2409aba7-e04d-4660-bdb9-04c1517fec21 ==============================
[0m15:29:15.840248 [info ] [MainThread]: Running with dbt=1.4.7
[0m15:29:15.844974 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:29:15.846927 [debug] [MainThread]: Tracking: tracking
[0m15:29:15.851826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32349450f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32349457b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3234945390>]}
[0m15:29:15.888224 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m15:29:16.227886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:29:16.229805 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:29:16.243498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2409aba7-e04d-4660-bdb9-04c1517fec21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3233080e80>]}
[0m15:29:16.279618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2409aba7-e04d-4660-bdb9-04c1517fec21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32331ba440>]}
[0m15:29:16.282149 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:29:16.284747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2409aba7-e04d-4660-bdb9-04c1517fec21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32331ba4a0>]}
[0m15:29:16.289492 [info ] [MainThread]: 
[0m15:29:16.296065 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:29:16.301358 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m15:29:16.324309 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m15:29:16.326525 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m15:29:16.328189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:16.366893 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m15:29:16.370702 [debug] [ThreadPool]: On list_destination_db: Close
[0m15:29:16.375849 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m15:29:16.388932 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:29:16.390946 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m15:29:16.392888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:16.424417 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:29:16.426561 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:29:16.428655 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:29:16.437887 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m15:29:16.441461 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m15:29:16.447422 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m15:29:16.460280 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:16.462272 [debug] [MainThread]: On master: BEGIN
[0m15:29:16.463932 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:29:16.495406 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:29:16.497683 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:16.500026 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:29:16.510014 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m15:29:16.513256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2409aba7-e04d-4660-bdb9-04c1517fec21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32330bd030>]}
[0m15:29:16.515244 [debug] [MainThread]: On master: ROLLBACK
[0m15:29:16.520696 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:16.522761 [debug] [MainThread]: On master: BEGIN
[0m15:29:16.532501 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:29:16.534995 [debug] [MainThread]: On master: COMMIT
[0m15:29:16.537371 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:16.539397 [debug] [MainThread]: On master: COMMIT
[0m15:29:16.545035 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:29:16.547501 [debug] [MainThread]: On master: Close
[0m15:29:16.550971 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:29:16.554907 [info ] [MainThread]: 
[0m15:29:16.592704 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m15:29:16.595129 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m15:29:16.598989 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m15:29:16.601204 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m15:29:16.609739 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m15:29:16.625585 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 15:29:16.603872 => 2024-02-08 15:29:16.625365
[0m15:29:16.627556 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m15:29:16.711256 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m15:29:16.726337 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:29:16.728098 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m15:29:16.729761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:16.760042 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:29:16.762006 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:29:16.763879 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    -- films.sql
SELECT * FROM "destination_db"."public"."films"
  );
  
[0m15:29:16.769582 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 9: SELECT * FROM "destination_db"."public"."films"
                      ^

[0m15:29:16.772299 [debug] [Thread-1 (]: On model.Custom_postgres.actors: ROLLBACK
[0m15:29:16.778790 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 15:29:16.629598 => 2024-02-08 15:29:16.778439
[0m15:29:16.781292 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m15:29:16.788580 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.films" does not exist
  LINE 9: SELECT * FROM "destination_db"."public"."films"
                        ^
  compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m15:29:16.791348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2409aba7-e04d-4660-bdb9-04c1517fec21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32330cfeb0>]}
[0m15:29:16.793779 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.19s]
[0m15:29:16.799745 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m15:29:16.803287 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m15:29:16.805557 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m15:29:16.810497 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m15:29:16.812619 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m15:29:16.820835 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m15:29:16.838411 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 15:29:16.814778 => 2024-02-08 15:29:16.838201
[0m15:29:16.840801 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m15:29:16.863370 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m15:29:16.888964 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:29:16.891082 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m15:29:16.893926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:16.936704 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:29:16.940039 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:29:16.942204 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m15:29:16.954653 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0 seconds
[0m15:29:16.986926 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:29:16.989834 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m15:29:16.997874 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "film_actors" already exists

[0m15:29:17.000391 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: ROLLBACK
[0m15:29:17.007124 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:29:17.009363 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:29:17.013562 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 15:29:16.843455 => 2024-02-08 15:29:17.013236
[0m15:29:17.016648 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m15:29:17.021811 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "film_actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m15:29:17.024393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2409aba7-e04d-4660-bdb9-04c1517fec21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32330d8700>]}
[0m15:29:17.028508 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.22s]
[0m15:29:17.033803 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m15:29:17.037476 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m15:29:17.040392 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m15:29:17.045163 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m15:29:17.048249 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m15:29:17.061798 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m15:29:17.079307 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 15:29:17.050974 => 2024-02-08 15:29:17.079035
[0m15:29:17.081350 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m15:29:17.096235 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m15:29:17.117139 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:29:17.119856 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m15:29:17.122188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:17.156674 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:29:17.159461 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:29:17.161345 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    -- films.sql
SELECT * FROM "destination_db"."public"."films"
  );
  
[0m15:29:17.169328 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:29:17.179032 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:29:17.184242 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m15:29:17.192399 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "films" already exists

[0m15:29:17.194372 [debug] [Thread-1 (]: On model.Custom_postgres.films: ROLLBACK
[0m15:29:17.201582 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:29:17.205136 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:29:17.207813 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 15:29:17.084729 => 2024-02-08 15:29:17.207594
[0m15:29:17.210098 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m15:29:17.216361 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "films" already exists
  compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:29:17.219941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2409aba7-e04d-4660-bdb9-04c1517fec21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32330cfeb0>]}
[0m15:29:17.223911 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.18s]
[0m15:29:17.228081 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m15:29:17.233315 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m15:29:17.237066 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m15:29:17.240293 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m15:29:17.245360 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:29:17.247659 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:17.249837 [debug] [MainThread]: On master: BEGIN
[0m15:29:17.252494 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:29:17.288007 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:29:17.289799 [debug] [MainThread]: On master: COMMIT
[0m15:29:17.291560 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:17.293240 [debug] [MainThread]: On master: COMMIT
[0m15:29:17.297720 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:29:17.299926 [debug] [MainThread]: On master: Close
[0m15:29:17.302987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:17.304954 [debug] [MainThread]: Connection 'model.Custom_postgres.films' was properly closed.
[0m15:29:17.308337 [info ] [MainThread]: 
[0m15:29:17.311636 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m15:29:17.314603 [debug] [MainThread]: Command end result
[0m15:29:17.355449 [info ] [MainThread]: 
[0m15:29:17.358058 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:29:17.362175 [info ] [MainThread]: 
[0m15:29:17.366304 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m15:29:17.370509 [error] [MainThread]:   relation "public.films" does not exist
[0m15:29:17.374091 [error] [MainThread]:   LINE 9: SELECT * FROM "destination_db"."public"."films"
[0m15:29:17.377508 [error] [MainThread]:                         ^
[0m15:29:17.381824 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m15:29:17.386483 [info ] [MainThread]: 
[0m15:29:17.390203 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m15:29:17.393339 [error] [MainThread]:   relation "film_actors" already exists
[0m15:29:17.396528 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m15:29:17.400888 [info ] [MainThread]: 
[0m15:29:17.404826 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m15:29:17.407873 [error] [MainThread]:   relation "films" already exists
[0m15:29:17.410975 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:29:17.414055 [info ] [MainThread]: 
[0m15:29:17.417338 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m15:29:17.421134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3232f16140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3232f14280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3232f17820>]}
[0m15:29:17.423394 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 15:30:18.728017 | afba0b7b-96db-4317-ba8f-345ac1441fc4 ==============================
[0m15:30:18.728017 [info ] [MainThread]: Running with dbt=1.4.7
[0m15:30:18.732816 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:30:18.735088 [debug] [MainThread]: Tracking: tracking
[0m15:30:18.739523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc402110f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc402117b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc40211390>]}
[0m15:30:18.779635 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m15:30:19.219223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:30:19.221924 [debug] [MainThread]: Partial parsing: updated file: Custom_postgres://models/example/films.sql
[0m15:30:19.264705 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m15:30:19.398190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afba0b7b-96db-4317-ba8f-345ac1441fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3d7b7eb0>]}
[0m15:30:19.437158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afba0b7b-96db-4317-ba8f-345ac1441fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc401f2680>]}
[0m15:30:19.439805 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:30:19.442537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afba0b7b-96db-4317-ba8f-345ac1441fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc4021dd50>]}
[0m15:30:19.448791 [info ] [MainThread]: 
[0m15:30:19.455538 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:30:19.460817 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m15:30:19.490742 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m15:30:19.492894 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m15:30:19.494645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:19.535744 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m15:30:19.539467 [debug] [ThreadPool]: On list_destination_db: Close
[0m15:30:19.544416 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m15:30:19.556704 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:30:19.558861 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m15:30:19.560623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:19.590844 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:30:19.592751 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:30:19.594775 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:30:19.602995 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m15:30:19.607679 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m15:30:19.613033 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m15:30:19.627952 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:19.630030 [debug] [MainThread]: On master: BEGIN
[0m15:30:19.633200 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:30:19.663599 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:30:19.666061 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:19.668472 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:30:19.677754 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m15:30:19.681682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afba0b7b-96db-4317-ba8f-345ac1441fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3d7f3670>]}
[0m15:30:19.684299 [debug] [MainThread]: On master: ROLLBACK
[0m15:30:19.689680 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:19.692464 [debug] [MainThread]: On master: BEGIN
[0m15:30:19.701501 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:30:19.703935 [debug] [MainThread]: On master: COMMIT
[0m15:30:19.705848 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:19.707763 [debug] [MainThread]: On master: COMMIT
[0m15:30:19.712651 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:30:19.715075 [debug] [MainThread]: On master: Close
[0m15:30:19.718737 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:30:19.721908 [info ] [MainThread]: 
[0m15:30:19.760373 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m15:30:19.765106 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m15:30:19.770274 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m15:30:19.773322 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m15:30:19.786063 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m15:30:19.810587 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 15:30:19.775664 => 2024-02-08 15:30:19.810296
[0m15:30:19.813175 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m15:30:19.981389 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m15:30:20.041496 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:30:20.044448 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m15:30:20.047416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:20.084370 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:30:20.087076 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:30:20.089156 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    -- films.sql
SELECT * FROM "destination_db"."public"."films"
  );
  
[0m15:30:20.101624 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:30:20.122519 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m15:30:20.124626 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m15:30:20.139003 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "actors" already exists

[0m15:30:20.141837 [debug] [Thread-1 (]: On model.Custom_postgres.actors: ROLLBACK
[0m15:30:20.150918 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:30:20.155019 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:30:20.157303 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 15:30:19.815744 => 2024-02-08 15:30:20.157087
[0m15:30:20.159597 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m15:30:20.170344 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m15:30:20.172879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afba0b7b-96db-4317-ba8f-345ac1441fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3e903ac0>]}
[0m15:30:20.175302 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.40s]
[0m15:30:20.183064 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m15:30:20.185608 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m15:30:20.188335 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m15:30:20.191467 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m15:30:20.193552 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m15:30:20.201182 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m15:30:20.215800 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 15:30:20.195151 => 2024-02-08 15:30:20.215538
[0m15:30:20.218373 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m15:30:20.228699 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m15:30:20.242958 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:30:20.244416 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m15:30:20.245874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:20.273828 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:30:20.275624 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:30:20.277248 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m15:30:20.283477 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:30:20.290371 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m15:30:20.293146 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m15:30:20.299542 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "film_actors" already exists

[0m15:30:20.302104 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: ROLLBACK
[0m15:30:20.306809 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:30:20.308753 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:30:20.310436 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 15:30:20.220267 => 2024-02-08 15:30:20.310285
[0m15:30:20.312083 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m15:30:20.315923 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "film_actors" already exists
  compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m15:30:20.319265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afba0b7b-96db-4317-ba8f-345ac1441fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3e980760>]}
[0m15:30:20.321679 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.13s]
[0m15:30:20.324799 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m15:30:20.327829 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m15:30:20.329983 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m15:30:20.333821 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m15:30:20.336188 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m15:30:20.344753 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m15:30:20.366479 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 15:30:20.338013 => 2024-02-08 15:30:20.366075
[0m15:30:20.369941 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m15:30:20.383012 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m15:30:20.399521 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:30:20.401770 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m15:30:20.403765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:20.435410 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:30:20.437421 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:30:20.439445 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m15:30:20.445721 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:30:20.457383 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m15:30:20.459460 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m15:30:20.467057 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "films" already exists

[0m15:30:20.470592 [debug] [Thread-1 (]: On model.Custom_postgres.films: ROLLBACK
[0m15:30:20.476738 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:30:20.478602 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m15:30:20.480819 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 15:30:20.372105 => 2024-02-08 15:30:20.480609
[0m15:30:20.483695 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m15:30:20.489783 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "films" already exists
  compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:30:20.494957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afba0b7b-96db-4317-ba8f-345ac1441fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3d720a30>]}
[0m15:30:20.498852 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.16s]
[0m15:30:20.503873 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m15:30:20.508111 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m15:30:20.510393 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m15:30:20.513440 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m15:30:20.520978 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:30:20.524105 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:20.527130 [debug] [MainThread]: On master: BEGIN
[0m15:30:20.531420 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:30:20.567491 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:30:20.569892 [debug] [MainThread]: On master: COMMIT
[0m15:30:20.571687 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:20.573552 [debug] [MainThread]: On master: COMMIT
[0m15:30:20.579051 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:30:20.581224 [debug] [MainThread]: On master: Close
[0m15:30:20.584971 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:20.591569 [debug] [MainThread]: Connection 'model.Custom_postgres.films' was properly closed.
[0m15:30:20.596335 [info ] [MainThread]: 
[0m15:30:20.601710 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m15:30:20.607291 [debug] [MainThread]: Command end result
[0m15:30:20.641373 [info ] [MainThread]: 
[0m15:30:20.645164 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:30:20.648362 [info ] [MainThread]: 
[0m15:30:20.652388 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m15:30:20.655469 [error] [MainThread]:   relation "actors" already exists
[0m15:30:20.658324 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/actors.sql
[0m15:30:20.661701 [info ] [MainThread]: 
[0m15:30:20.665449 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m15:30:20.668789 [error] [MainThread]:   relation "film_actors" already exists
[0m15:30:20.671950 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/film_actors.sql
[0m15:30:20.674695 [info ] [MainThread]: 
[0m15:30:20.679089 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m15:30:20.682034 [error] [MainThread]:   relation "films" already exists
[0m15:30:20.685327 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/films.sql
[0m15:30:20.687880 [info ] [MainThread]: 
[0m15:30:20.690526 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m15:30:20.694178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3d723310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3d722ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3d721f30>]}
[0m15:30:20.696132 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 19:33:20.122310 | e2ebc642-fa93-439d-8344-9a34e3e0b9b3 ==============================
[0m19:33:20.122310 [info ] [MainThread]: Running with dbt=1.4.7
[0m19:33:20.135661 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:33:20.143897 [debug] [MainThread]: Tracking: tracking
[0m19:33:20.156590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee6b090f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee6b097b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee6b09390>]}
[0m19:33:20.274962 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m19:33:20.920263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:33:20.923331 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:33:20.940451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2ebc642-fa93-439d-8344-9a34e3e0b9b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee5250e80>]}
[0m19:33:20.987411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2ebc642-fa93-439d-8344-9a34e3e0b9b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee520e440>]}
[0m19:33:20.991491 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m19:33:20.995558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2ebc642-fa93-439d-8344-9a34e3e0b9b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee520e4a0>]}
[0m19:33:21.002781 [info ] [MainThread]: 
[0m19:33:21.014259 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:33:21.036235 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m19:33:21.073880 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m19:33:21.077252 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:33:21.079324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:21.136648 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m19:33:21.143237 [debug] [ThreadPool]: On list_destination_db: Close
[0m19:33:21.150734 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m19:33:21.170334 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:33:21.174537 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m19:33:21.177903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:33:21.218474 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m19:33:21.221782 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:33:21.224212 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:33:21.235643 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m19:33:21.242283 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m19:33:21.253460 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m19:33:21.277851 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:21.281173 [debug] [MainThread]: On master: BEGIN
[0m19:33:21.283562 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:33:21.323749 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:33:21.326414 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:21.328530 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:33:21.346751 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m19:33:21.352248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2ebc642-fa93-439d-8344-9a34e3e0b9b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee5091030>]}
[0m19:33:21.357374 [debug] [MainThread]: On master: ROLLBACK
[0m19:33:21.366514 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:21.370279 [debug] [MainThread]: On master: BEGIN
[0m19:33:21.382963 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:33:21.385885 [debug] [MainThread]: On master: COMMIT
[0m19:33:21.388211 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:21.391883 [debug] [MainThread]: On master: COMMIT
[0m19:33:21.398820 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:33:21.402194 [debug] [MainThread]: On master: Close
[0m19:33:21.407383 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:33:21.412828 [info ] [MainThread]: 
[0m19:33:21.456210 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m19:33:21.460505 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m19:33:21.465507 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m19:33:21.468113 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m19:33:21.482180 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m19:33:21.505837 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 19:33:21.470404 => 2024-02-08 19:33:21.505365
[0m19:33:21.511090 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m19:33:21.616196 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m19:33:21.640883 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:33:21.644263 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m19:33:21.647557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:21.694281 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:33:21.698605 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:33:21.702677 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    -- films.sql
SELECT * FROM "destination_db"."public"."films"
  );
  
[0m19:33:21.713423 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m19:33:21.732522 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:33:21.735513 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m19:33:21.744340 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:33:21.753899 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:33:21.757832 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m19:33:21.765635 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:33:21.812060 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m19:33:21.815793 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:33:21.818647 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m19:33:21.831770 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:33:21.844364 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:33:21.847350 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m19:33:21.862655 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:33:21.868308 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 19:33:21.513992 => 2024-02-08 19:33:21.868154
[0m19:33:21.871580 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m19:33:21.876345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ebc642-fa93-439d-8344-9a34e3e0b9b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee510d210>]}
[0m19:33:21.880945 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.41s]
[0m19:33:21.887939 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m19:33:21.891323 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m19:33:21.894266 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m19:33:21.899112 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m19:33:21.902665 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m19:33:21.915461 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m19:33:21.941295 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 19:33:21.906567 => 2024-02-08 19:33:21.940908
[0m19:33:21.945363 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m19:33:21.960465 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m19:33:21.984168 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:33:21.987040 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m19:33:21.990537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:22.032647 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:33:22.036046 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:33:22.039071 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m19:33:22.049117 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m19:33:22.060568 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:33:22.064061 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m19:33:22.071700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:33:22.082643 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:33:22.086468 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m19:33:22.096101 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:33:22.106022 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m19:33:22.109159 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:33:22.112031 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m19:33:22.124475 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:33:22.131415 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:33:22.134107 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m19:33:22.148417 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:33:22.154116 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 19:33:21.947953 => 2024-02-08 19:33:22.153905
[0m19:33:22.157752 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m19:33:22.162136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ebc642-fa93-439d-8344-9a34e3e0b9b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee5155e40>]}
[0m19:33:22.167351 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.26s]
[0m19:33:22.172276 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m19:33:22.176082 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m19:33:22.179504 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m19:33:22.184113 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m19:33:22.188198 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m19:33:22.198603 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m19:33:22.219861 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 19:33:22.191200 => 2024-02-08 19:33:22.219516
[0m19:33:22.223789 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m19:33:22.241218 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m19:33:22.262394 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:33:22.264885 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m19:33:22.267254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:22.306955 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:33:22.309620 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:33:22.312239 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m19:33:22.321406 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m19:33:22.331218 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:33:22.335297 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m19:33:22.345827 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:33:22.356807 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:33:22.360407 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m19:33:22.368018 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:33:22.375467 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m19:33:22.378147 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:33:22.380490 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m19:33:22.392046 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:33:22.398755 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:33:22.401619 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m19:33:22.417741 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:33:22.423344 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 19:33:22.227794 => 2024-02-08 19:33:22.423191
[0m19:33:22.426885 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m19:33:22.431659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ebc642-fa93-439d-8344-9a34e3e0b9b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee5155e40>]}
[0m19:33:22.439234 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.25s]
[0m19:33:22.443502 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m19:33:22.449208 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m19:33:22.452956 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m19:33:22.459454 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_ratings'
[0m19:33:22.462970 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_ratings
[0m19:33:22.485065 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_ratings"
[0m19:33:22.514888 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (compile): 2024-02-08 19:33:22.468083 => 2024-02-08 19:33:22.514539
[0m19:33:22.517928 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_ratings
[0m19:33:22.534046 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_ratings"
[0m19:33:22.549896 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m19:33:22.552703 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: BEGIN
[0m19:33:22.556387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:22.595263 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:33:22.597424 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m19:33:22.599416 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m19:33:22.608035 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.actor_id does not exist
LINE 34: ...tination_db"."public"."actors" a ON fa.actor_id = a.actor_id
                                                              ^
HINT:  Perhaps you meant to reference the column "fa.actor_id".

[0m19:33:22.611875 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: ROLLBACK
[0m19:33:22.623073 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (execute): 2024-02-08 19:33:22.521164 => 2024-02-08 19:33:22.622592
[0m19:33:22.628987 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: Close
[0m19:33:22.646718 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  column a.actor_id does not exist
  LINE 34: ...tination_db"."public"."actors" a ON fa.actor_id = a.actor_id
                                                                ^
  HINT:  Perhaps you meant to reference the column "fa.actor_id".
  compiled Code at target/run/Custom_postgres/models/example/film_ratings.sql
[0m19:33:22.650108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ebc642-fa93-439d-8344-9a34e3e0b9b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee510c6d0>]}
[0m19:33:22.653189 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.19s]
[0m19:33:22.657743 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m19:33:22.666120 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:33:22.669592 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:22.673747 [debug] [MainThread]: On master: BEGIN
[0m19:33:22.678200 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:33:22.729010 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:33:22.731927 [debug] [MainThread]: On master: COMMIT
[0m19:33:22.734259 [debug] [MainThread]: Using postgres connection "master"
[0m19:33:22.736547 [debug] [MainThread]: On master: COMMIT
[0m19:33:22.743666 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:33:22.747039 [debug] [MainThread]: On master: Close
[0m19:33:22.751933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:22.758164 [debug] [MainThread]: Connection 'model.Custom_postgres.film_ratings' was properly closed.
[0m19:33:22.762804 [info ] [MainThread]: 
[0m19:33:22.766235 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.76 seconds (1.76s).
[0m19:33:22.769786 [debug] [MainThread]: Command end result
[0m19:33:22.815658 [info ] [MainThread]: 
[0m19:33:22.820133 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:33:22.828247 [info ] [MainThread]: 
[0m19:33:22.835075 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m19:33:22.840398 [error] [MainThread]:   column a.actor_id does not exist
[0m19:33:22.847603 [error] [MainThread]:   LINE 34: ...tination_db"."public"."actors" a ON fa.actor_id = a.actor_id
[0m19:33:22.853350 [error] [MainThread]:                                                                 ^
[0m19:33:22.858645 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "fa.actor_id".
[0m19:33:22.864729 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/film_ratings.sql
[0m19:33:22.868133 [info ] [MainThread]: 
[0m19:33:22.874651 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:33:22.880367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1edef11540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1edef13e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1edef13f10>]}
[0m19:33:22.883116 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 19:35:00.973720 | 44b82a42-5a7d-41a4-8c38-c67dd24773eb ==============================
[0m19:35:00.973720 [info ] [MainThread]: Running with dbt=1.4.7
[0m19:35:00.980175 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:35:00.982705 [debug] [MainThread]: Tracking: tracking
[0m19:35:00.989055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4bb21360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4bb217e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4bb213c0>]}
[0m19:35:01.047587 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m19:35:01.572732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:35:01.575811 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:35:01.592912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44b82a42-5a7d-41a4-8c38-c67dd24773eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4a268f40>]}
[0m19:35:01.645071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44b82a42-5a7d-41a4-8c38-c67dd24773eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4a1a2500>]}
[0m19:35:01.650316 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m19:35:01.656638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44b82a42-5a7d-41a4-8c38-c67dd24773eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4a1a2560>]}
[0m19:35:01.666489 [info ] [MainThread]: 
[0m19:35:01.677859 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:35:01.686142 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m19:35:01.720462 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m19:35:01.724766 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:35:01.727395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:01.772554 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m19:35:01.777306 [debug] [ThreadPool]: On list_destination_db: Close
[0m19:35:01.784203 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m19:35:01.799098 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:35:01.802374 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m19:35:01.805143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:35:01.845378 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m19:35:01.848252 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:35:01.850840 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:35:01.863703 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m19:35:01.870210 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m19:35:01.878650 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m19:35:01.907288 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:01.910141 [debug] [MainThread]: On master: BEGIN
[0m19:35:01.912446 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:35:01.951089 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:35:01.954204 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:01.957061 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:35:01.972307 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m19:35:01.980762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44b82a42-5a7d-41a4-8c38-c67dd24773eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4a0a90f0>]}
[0m19:35:01.985390 [debug] [MainThread]: On master: ROLLBACK
[0m19:35:01.995782 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:01.999168 [debug] [MainThread]: On master: BEGIN
[0m19:35:02.014348 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:35:02.017959 [debug] [MainThread]: On master: COMMIT
[0m19:35:02.021455 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:02.024662 [debug] [MainThread]: On master: COMMIT
[0m19:35:02.032343 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:35:02.035898 [debug] [MainThread]: On master: Close
[0m19:35:02.041120 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:35:02.045459 [info ] [MainThread]: 
[0m19:35:02.087282 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m19:35:02.091770 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m19:35:02.096766 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m19:35:02.100301 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m19:35:02.111802 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m19:35:02.133356 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 19:35:02.104581 => 2024-02-08 19:35:02.132929
[0m19:35:02.138477 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m19:35:02.235749 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m19:35:02.254646 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:35:02.257602 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m19:35:02.260077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:02.305348 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:35:02.308871 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:35:02.312941 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    -- films.sql
SELECT * FROM "destination_db"."public"."films"
  );
  
[0m19:35:02.325878 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m19:35:02.350019 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:35:02.353098 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m19:35:02.361565 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:35:02.373416 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:35:02.376290 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m19:35:02.382987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:35:02.433172 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m19:35:02.436136 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:35:02.438649 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m19:35:02.448104 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:35:02.460964 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:35:02.463775 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m19:35:02.477017 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:35:02.482807 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 19:35:02.141977 => 2024-02-08 19:35:02.482657
[0m19:35:02.485629 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m19:35:02.489859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44b82a42-5a7d-41a4-8c38-c67dd24773eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4a128f40>]}
[0m19:35:02.494133 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.39s]
[0m19:35:02.501370 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m19:35:02.504778 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m19:35:02.508008 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m19:35:02.512392 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m19:35:02.517068 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m19:35:02.528054 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m19:35:02.559838 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 19:35:02.520362 => 2024-02-08 19:35:02.559358
[0m19:35:02.563950 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m19:35:02.577869 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m19:35:02.595087 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:35:02.597237 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m19:35:02.599585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:02.638784 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:35:02.641818 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:35:02.644745 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m19:35:02.656170 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m19:35:02.668604 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:35:02.672229 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m19:35:02.680507 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:35:02.690200 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:35:02.693959 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m19:35:02.703507 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:35:02.714308 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m19:35:02.716886 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:35:02.719830 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m19:35:02.730246 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:35:02.739056 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:35:02.741482 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m19:35:02.753223 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:35:02.758430 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 19:35:02.566811 => 2024-02-08 19:35:02.758268
[0m19:35:02.761089 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m19:35:02.764881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44b82a42-5a7d-41a4-8c38-c67dd24773eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4a169f00>]}
[0m19:35:02.768278 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.25s]
[0m19:35:02.772250 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m19:35:02.776428 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m19:35:02.820413 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m19:35:02.860422 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m19:35:02.867735 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m19:35:02.877269 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m19:35:02.916010 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 19:35:02.870715 => 2024-02-08 19:35:02.915541
[0m19:35:02.920084 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m19:35:02.943223 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m19:35:02.969906 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:35:02.973512 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m19:35:02.978086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:03.020622 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:35:03.023890 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:35:03.026279 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m19:35:03.035522 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m19:35:03.049172 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:35:03.052868 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m19:35:03.063607 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:35:03.076033 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:35:03.079489 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m19:35:03.088727 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:35:03.096461 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m19:35:03.099268 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:35:03.101494 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m19:35:03.112923 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:35:03.121381 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:35:03.123706 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m19:35:03.136126 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:35:03.140784 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 19:35:02.924621 => 2024-02-08 19:35:03.140656
[0m19:35:03.143136 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m19:35:03.146728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44b82a42-5a7d-41a4-8c38-c67dd24773eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4a169f00>]}
[0m19:35:03.149872 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.29s]
[0m19:35:03.154228 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m19:35:03.158264 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m19:35:03.161024 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m19:35:03.165981 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_ratings'
[0m19:35:03.169856 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_ratings
[0m19:35:03.185940 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_ratings"
[0m19:35:03.211754 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (compile): 2024-02-08 19:35:03.173056 => 2024-02-08 19:35:03.211430
[0m19:35:03.214104 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_ratings
[0m19:35:03.226684 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_ratings"
[0m19:35:03.247186 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m19:35:03.249606 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: BEGIN
[0m19:35:03.251891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:03.290955 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:35:03.294185 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m19:35:03.296766 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m19:35:03.305929 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.actor_id does not exist
LINE 34: ...tination_db"."public"."actors" a ON fa.actor_id = a.actor_id
                                                              ^
HINT:  Perhaps you meant to reference the column "fa.actor_id".

[0m19:35:03.310530 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: ROLLBACK
[0m19:35:03.319883 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (execute): 2024-02-08 19:35:03.216095 => 2024-02-08 19:35:03.319559
[0m19:35:03.324866 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: Close
[0m19:35:03.333594 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  column a.actor_id does not exist
  LINE 34: ...tination_db"."public"."actors" a ON fa.actor_id = a.actor_id
                                                                ^
  HINT:  Perhaps you meant to reference the column "fa.actor_id".
  compiled Code at target/run/Custom_postgres/models/example/film_ratings.sql
[0m19:35:03.339292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44b82a42-5a7d-41a4-8c38-c67dd24773eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4a169d50>]}
[0m19:35:03.344911 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.17s]
[0m19:35:03.349189 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m19:35:03.357310 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:35:03.360435 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:03.363196 [debug] [MainThread]: On master: BEGIN
[0m19:35:03.365425 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:35:03.412085 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:35:03.415084 [debug] [MainThread]: On master: COMMIT
[0m19:35:03.417597 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:03.421353 [debug] [MainThread]: On master: COMMIT
[0m19:35:03.430516 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:35:03.435515 [debug] [MainThread]: On master: Close
[0m19:35:03.441020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:03.445451 [debug] [MainThread]: Connection 'model.Custom_postgres.film_ratings' was properly closed.
[0m19:35:03.449179 [info ] [MainThread]: 
[0m19:35:03.452753 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.78 seconds (1.78s).
[0m19:35:03.458671 [debug] [MainThread]: Command end result
[0m19:35:03.513352 [info ] [MainThread]: 
[0m19:35:03.518070 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:35:03.522904 [info ] [MainThread]: 
[0m19:35:03.527035 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m19:35:03.532417 [error] [MainThread]:   column a.actor_id does not exist
[0m19:35:03.537990 [error] [MainThread]:   LINE 34: ...tination_db"."public"."actors" a ON fa.actor_id = a.actor_id
[0m19:35:03.542481 [error] [MainThread]:                                                                 ^
[0m19:35:03.549619 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "fa.actor_id".
[0m19:35:03.554801 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/film_ratings.sql
[0m19:35:03.561650 [info ] [MainThread]: 
[0m19:35:03.566075 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:35:03.570657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3bf13670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3bf13640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3bf13fd0>]}
[0m19:35:03.576522 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 19:36:21.208579 | b807e3a5-59e0-49a0-b8c9-ef988000f0c7 ==============================
[0m19:36:21.208579 [info ] [MainThread]: Running with dbt=1.4.7
[0m19:36:21.215693 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:36:21.219538 [debug] [MainThread]: Tracking: tracking
[0m19:36:21.226130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2938d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2938d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2938d390>]}
[0m19:36:21.286127 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m19:36:21.967450 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:36:21.970241 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:36:21.991219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b807e3a5-59e0-49a0-b8c9-ef988000f0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f27ac4eb0>]}
[0m19:36:22.038358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b807e3a5-59e0-49a0-b8c9-ef988000f0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f27c02470>]}
[0m19:36:22.042557 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m19:36:22.046686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b807e3a5-59e0-49a0-b8c9-ef988000f0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f27c024d0>]}
[0m19:36:22.053497 [info ] [MainThread]: 
[0m19:36:22.061874 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:36:22.068157 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m19:36:22.100503 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m19:36:22.104832 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:36:22.108257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:22.156277 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m19:36:22.161254 [debug] [ThreadPool]: On list_destination_db: Close
[0m19:36:22.169169 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m19:36:22.186617 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:36:22.189416 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m19:36:22.192331 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:22.239487 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m19:36:22.243221 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:36:22.246484 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:36:22.262988 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m19:36:22.271451 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m19:36:22.281589 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m19:36:22.322490 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:22.324989 [debug] [MainThread]: On master: BEGIN
[0m19:36:22.327192 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:36:22.376213 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:36:22.378533 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:22.380590 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:36:22.396103 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m19:36:22.400279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b807e3a5-59e0-49a0-b8c9-ef988000f0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f27b05060>]}
[0m19:36:22.404682 [debug] [MainThread]: On master: ROLLBACK
[0m19:36:22.411322 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:22.416165 [debug] [MainThread]: On master: BEGIN
[0m19:36:22.429362 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:36:22.433435 [debug] [MainThread]: On master: COMMIT
[0m19:36:22.438233 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:22.441732 [debug] [MainThread]: On master: COMMIT
[0m19:36:22.448123 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:36:22.452061 [debug] [MainThread]: On master: Close
[0m19:36:22.457107 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:36:22.461667 [info ] [MainThread]: 
[0m19:36:22.506461 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m19:36:22.510704 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m19:36:22.515836 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m19:36:22.521185 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m19:36:22.530725 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m19:36:22.559137 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 19:36:22.525030 => 2024-02-08 19:36:22.558346
[0m19:36:22.562089 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m19:36:22.650936 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m19:36:22.670890 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:36:22.673381 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m19:36:22.675884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:22.726237 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:36:22.729454 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:36:22.732376 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    -- films.sql
SELECT * FROM "destination_db"."public"."films"
  );
  
[0m19:36:22.742166 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m19:36:22.763228 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:36:22.766230 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m19:36:22.777124 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:36:22.787814 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:36:22.790755 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m19:36:22.799678 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:36:22.854221 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m19:36:22.857133 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:36:22.859563 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m19:36:22.871504 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:36:22.884059 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:36:22.887454 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m19:36:22.903017 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:36:22.908605 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 19:36:22.565128 => 2024-02-08 19:36:22.908452
[0m19:36:22.911470 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m19:36:22.915604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b807e3a5-59e0-49a0-b8c9-ef988000f0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f279891e0>]}
[0m19:36:22.919608 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.40s]
[0m19:36:22.926946 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m19:36:22.930359 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m19:36:22.933697 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m19:36:22.938228 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m19:36:22.942064 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m19:36:22.955006 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m19:36:22.981066 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 19:36:22.946198 => 2024-02-08 19:36:22.980584
[0m19:36:22.986275 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m19:36:22.998239 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m19:36:23.015190 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:36:23.017927 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m19:36:23.020905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:23.062184 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:36:23.064822 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:36:23.067374 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m19:36:23.078506 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m19:36:23.090422 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:36:23.093797 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m19:36:23.101567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:36:23.112716 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:36:23.115814 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m19:36:23.124707 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:36:23.135462 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m19:36:23.139057 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:36:23.144516 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m19:36:23.165360 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:36:23.187368 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:36:23.191877 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m19:36:23.210161 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:36:23.218949 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 19:36:22.989756 => 2024-02-08 19:36:23.218750
[0m19:36:23.225806 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m19:36:23.232457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b807e3a5-59e0-49a0-b8c9-ef988000f0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f279c9e70>]}
[0m19:36:23.237613 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.29s]
[0m19:36:23.249955 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m19:36:23.255890 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m19:36:23.260865 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m19:36:23.272750 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m19:36:23.280784 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m19:36:23.309727 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m19:36:23.346491 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 19:36:23.285793 => 2024-02-08 19:36:23.346056
[0m19:36:23.352912 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m19:36:23.374612 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m19:36:23.401659 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:36:23.404761 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m19:36:23.407947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:23.460784 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:36:23.468169 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:36:23.474578 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m19:36:23.491836 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m19:36:23.511497 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:36:23.514643 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m19:36:23.524115 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:36:23.535894 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:36:23.541632 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m19:36:23.553473 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:36:23.572598 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m19:36:23.577254 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:36:23.581451 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m19:36:23.599237 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:36:23.621004 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:36:23.625819 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m19:36:23.647912 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:36:23.658359 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 19:36:23.356904 => 2024-02-08 19:36:23.658102
[0m19:36:23.670177 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m19:36:23.677236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b807e3a5-59e0-49a0-b8c9-ef988000f0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f279c9e70>]}
[0m19:36:23.682410 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.41s]
[0m19:36:23.688076 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m19:36:23.697356 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m19:36:23.702614 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m19:36:23.709341 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_ratings'
[0m19:36:23.713623 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_ratings
[0m19:36:23.752176 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_ratings"
[0m19:36:23.785245 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (compile): 2024-02-08 19:36:23.717925 => 2024-02-08 19:36:23.784842
[0m19:36:23.788839 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_ratings
[0m19:36:23.817130 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_ratings"
[0m19:36:23.835279 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m19:36:23.838030 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: BEGIN
[0m19:36:23.841110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:23.898253 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:36:23.901195 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m19:36:23.903656 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m19:36:23.913178 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.actor_id does not exist
LINE 34: ...tination_db"."public"."actors" a ON fa.actor_id = a.actor_id
                                                              ^
HINT:  Perhaps you meant to reference the column "fa.actor_id".

[0m19:36:23.918638 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: ROLLBACK
[0m19:36:23.931523 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (execute): 2024-02-08 19:36:23.792681 => 2024-02-08 19:36:23.930980
[0m19:36:23.937121 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: Close
[0m19:36:23.949475 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  column a.actor_id does not exist
  LINE 34: ...tination_db"."public"."actors" a ON fa.actor_id = a.actor_id
                                                                ^
  HINT:  Perhaps you meant to reference the column "fa.actor_id".
  compiled Code at target/run/Custom_postgres/models/example/film_ratings.sql
[0m19:36:23.958376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b807e3a5-59e0-49a0-b8c9-ef988000f0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f279c9cc0>]}
[0m19:36:23.962242 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.25s]
[0m19:36:23.966501 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m19:36:23.976333 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:36:23.978995 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:23.981567 [debug] [MainThread]: On master: BEGIN
[0m19:36:23.984350 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:36:24.032441 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:36:24.035632 [debug] [MainThread]: On master: COMMIT
[0m19:36:24.039723 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:24.042492 [debug] [MainThread]: On master: COMMIT
[0m19:36:24.050609 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:36:24.054589 [debug] [MainThread]: On master: Close
[0m19:36:24.060060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:24.062939 [debug] [MainThread]: Connection 'model.Custom_postgres.film_ratings' was properly closed.
[0m19:36:24.071424 [info ] [MainThread]: 
[0m19:36:24.077731 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 2.01 seconds (2.01s).
[0m19:36:24.081919 [debug] [MainThread]: Command end result
[0m19:36:24.136100 [info ] [MainThread]: 
[0m19:36:24.142119 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:36:24.147276 [info ] [MainThread]: 
[0m19:36:24.152468 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m19:36:24.158823 [error] [MainThread]:   column a.actor_id does not exist
[0m19:36:24.163424 [error] [MainThread]:   LINE 34: ...tination_db"."public"."actors" a ON fa.actor_id = a.actor_id
[0m19:36:24.170258 [error] [MainThread]:                                                                 ^
[0m19:36:24.176234 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "fa.actor_id".
[0m19:36:24.182929 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/film_ratings.sql
[0m19:36:24.187668 [info ] [MainThread]: 
[0m19:36:24.193309 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:36:24.200584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f27a01b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f27a00490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f27a03fd0>]}
[0m19:36:24.207440 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 19:39:46.621416 | 3252aafc-b6c5-42d2-a178-e5379fb7060f ==============================
[0m19:39:46.621416 [info ] [MainThread]: Running with dbt=1.4.7
[0m19:39:46.640901 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:39:46.646843 [debug] [MainThread]: Tracking: tracking
[0m19:39:46.656910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfdc1cd0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfdc1cd7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfdc1cd390>]}
[0m19:39:46.772270 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m19:39:47.359814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:39:47.363087 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:39:47.381358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3252aafc-b6c5-42d2-a178-e5379fb7060f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfda904e80>]}
[0m19:39:47.426938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3252aafc-b6c5-42d2-a178-e5379fb7060f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfda8c6440>]}
[0m19:39:47.430555 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m19:39:47.435280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3252aafc-b6c5-42d2-a178-e5379fb7060f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfda8c64a0>]}
[0m19:39:47.442267 [info ] [MainThread]: 
[0m19:39:47.455556 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:39:47.462700 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m19:39:47.512066 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m19:39:47.515248 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:39:47.517312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:47.563868 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m19:39:47.569146 [debug] [ThreadPool]: On list_destination_db: Close
[0m19:39:47.580681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m19:39:47.600719 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:39:47.605209 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m19:39:47.608113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:39:47.655094 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m19:39:47.657679 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:39:47.659710 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:39:47.671654 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m19:39:47.676476 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m19:39:47.684396 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m19:39:47.708500 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:47.712326 [debug] [MainThread]: On master: BEGIN
[0m19:39:47.717026 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:47.755147 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:39:47.757765 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:47.759949 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:39:47.773538 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m19:39:47.778121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3252aafc-b6c5-42d2-a178-e5379fb7060f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfda945030>]}
[0m19:39:47.781910 [debug] [MainThread]: On master: ROLLBACK
[0m19:39:47.789798 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:47.794938 [debug] [MainThread]: On master: BEGIN
[0m19:39:47.807362 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:39:47.811128 [debug] [MainThread]: On master: COMMIT
[0m19:39:47.816478 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:47.820440 [debug] [MainThread]: On master: COMMIT
[0m19:39:47.827754 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:39:47.831424 [debug] [MainThread]: On master: Close
[0m19:39:47.836974 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:39:47.842302 [info ] [MainThread]: 
[0m19:39:47.887579 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m19:39:47.890770 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m19:39:47.897945 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m19:39:47.902651 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m19:39:47.911455 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m19:39:47.937698 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 19:39:47.905046 => 2024-02-08 19:39:47.937315
[0m19:39:47.940278 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m19:39:48.034351 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m19:39:48.053921 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:39:48.056513 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m19:39:48.058763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:48.098144 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:39:48.101426 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:39:48.104329 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    -- films.sql
SELECT * FROM "destination_db"."public"."films"
  );
  
[0m19:39:48.114583 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m19:39:48.140516 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:39:48.145722 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m19:39:48.157095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:39:48.170018 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:39:48.173776 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m19:39:48.183469 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:39:48.239835 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m19:39:48.242704 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:39:48.246407 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m19:39:48.258957 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:39:48.273697 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:39:48.277692 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m19:39:48.292929 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:39:48.298209 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 19:39:47.942160 => 2024-02-08 19:39:48.298056
[0m19:39:48.300923 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m19:39:48.304675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3252aafc-b6c5-42d2-a178-e5379fb7060f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfda7bd210>]}
[0m19:39:48.308202 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.41s]
[0m19:39:48.315245 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m19:39:48.318407 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m19:39:48.321633 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m19:39:48.327893 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m19:39:48.331295 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m19:39:48.343109 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m19:39:48.368071 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 19:39:48.334953 => 2024-02-08 19:39:48.367716
[0m19:39:48.371208 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m19:39:48.383246 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m19:39:48.399013 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:39:48.401352 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m19:39:48.403729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:48.442734 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:39:48.445564 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:39:48.448572 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m19:39:48.457297 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m19:39:48.469321 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:39:48.472057 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m19:39:48.483066 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:39:48.496893 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:39:48.501946 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m19:39:48.509689 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:39:48.521414 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m19:39:48.524674 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:39:48.527202 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m19:39:48.541745 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:39:48.549802 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:39:48.552204 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m19:39:48.566186 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:39:48.571323 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 19:39:48.374024 => 2024-02-08 19:39:48.571179
[0m19:39:48.574073 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m19:39:48.577879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3252aafc-b6c5-42d2-a178-e5379fb7060f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfda80de40>]}
[0m19:39:48.582171 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.25s]
[0m19:39:48.586603 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m19:39:48.589931 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m19:39:48.593127 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m19:39:48.598101 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m19:39:48.602050 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m19:39:48.611620 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m19:39:48.639640 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 19:39:48.605261 => 2024-02-08 19:39:48.639305
[0m19:39:48.643976 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m19:39:48.656754 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m19:39:48.678111 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:39:48.681860 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m19:39:48.685522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:48.729472 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:39:48.732600 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:39:48.735341 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m19:39:48.744962 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m19:39:48.755067 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:39:48.758049 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m19:39:48.768791 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:39:48.779707 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:39:48.784159 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m19:39:48.792269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:39:48.799325 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m19:39:48.802356 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:39:48.805116 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m19:39:48.817151 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:39:48.824207 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:39:48.827140 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m19:39:48.842024 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:39:48.847795 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 19:39:48.647561 => 2024-02-08 19:39:48.847650
[0m19:39:48.850688 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m19:39:48.855177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3252aafc-b6c5-42d2-a178-e5379fb7060f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfda80de40>]}
[0m19:39:48.859272 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.26s]
[0m19:39:48.863933 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m19:39:48.868401 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m19:39:48.871741 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m19:39:48.877053 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_ratings'
[0m19:39:48.882093 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_ratings
[0m19:39:48.903202 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_ratings"
[0m19:39:48.929101 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (compile): 2024-02-08 19:39:48.885321 => 2024-02-08 19:39:48.928678
[0m19:39:48.934353 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_ratings
[0m19:39:48.945492 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_ratings"
[0m19:39:48.967162 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m19:39:48.969664 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: BEGIN
[0m19:39:48.971946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:49.011123 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:39:49.015147 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m19:39:49.017817 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m19:39:49.025967 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.actor_id does not exist
LINE 34: ...tination_db"."public"."actors" a ON fa.actor_id = a.actor_id
                                                              ^
HINT:  Perhaps you meant to reference the column "fa.actor_id".

[0m19:39:49.031405 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: ROLLBACK
[0m19:39:49.043083 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (execute): 2024-02-08 19:39:48.937270 => 2024-02-08 19:39:49.042651
[0m19:39:49.050012 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: Close
[0m19:39:49.059677 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  column a.actor_id does not exist
  LINE 34: ...tination_db"."public"."actors" a ON fa.actor_id = a.actor_id
                                                                ^
  HINT:  Perhaps you meant to reference the column "fa.actor_id".
  compiled Code at target/run/Custom_postgres/models/example/film_ratings.sql
[0m19:39:49.064709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3252aafc-b6c5-42d2-a178-e5379fb7060f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfda80dba0>]}
[0m19:39:49.071031 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.19s]
[0m19:39:49.076472 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m19:39:49.085191 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:39:49.089536 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:49.092797 [debug] [MainThread]: On master: BEGIN
[0m19:39:49.095371 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:39:49.155327 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:39:49.158449 [debug] [MainThread]: On master: COMMIT
[0m19:39:49.161127 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:49.164205 [debug] [MainThread]: On master: COMMIT
[0m19:39:49.173418 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:39:49.177849 [debug] [MainThread]: On master: Close
[0m19:39:49.185176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:49.191330 [debug] [MainThread]: Connection 'model.Custom_postgres.film_ratings' was properly closed.
[0m19:39:49.197656 [info ] [MainThread]: 
[0m19:39:49.205932 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m19:39:49.212171 [debug] [MainThread]: Command end result
[0m19:39:49.280059 [info ] [MainThread]: 
[0m19:39:49.288554 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:39:49.294665 [info ] [MainThread]: 
[0m19:39:49.301197 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m19:39:49.308109 [error] [MainThread]:   column a.actor_id does not exist
[0m19:39:49.313169 [error] [MainThread]:   LINE 34: ...tination_db"."public"."actors" a ON fa.actor_id = a.actor_id
[0m19:39:49.318852 [error] [MainThread]:                                                                 ^
[0m19:39:49.326408 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "fa.actor_id".
[0m19:39:49.331018 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/film_ratings.sql
[0m19:39:49.336163 [info ] [MainThread]: 
[0m19:39:49.341534 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:39:49.347945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfda8423e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfda843e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfda843f40>]}
[0m19:39:49.353547 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 19:40:29.021512 | 91db6da8-cbee-49b0-af7d-aa95fc02d047 ==============================
[0m19:40:29.021512 [info ] [MainThread]: Running with dbt=1.4.7
[0m19:40:29.028300 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:40:29.031615 [debug] [MainThread]: Tracking: tracking
[0m19:40:29.038436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17293950f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17293957b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1729395390>]}
[0m19:40:29.092843 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m19:40:29.676776 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:40:29.680050 [debug] [MainThread]: Partial parsing: updated file: Custom_postgres://macros/film_ratings_macro.sql
[0m19:40:29.759406 [debug] [MainThread]: 1603: static parser failed on example/film_ratings.sql
[0m19:40:29.796541 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/film_ratings.sql
[0m19:40:29.940877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91db6da8-cbee-49b0-af7d-aa95fc02d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1727ae1000>]}
[0m19:40:29.988072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91db6da8-cbee-49b0-af7d-aa95fc02d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1729366e00>]}
[0m19:40:29.991790 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m19:40:29.995810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91db6da8-cbee-49b0-af7d-aa95fc02d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17293acb50>]}
[0m19:40:30.002298 [info ] [MainThread]: 
[0m19:40:30.009668 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:40:30.016516 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m19:40:30.047373 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m19:40:30.051929 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:40:30.054981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:30.107310 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m19:40:30.112451 [debug] [ThreadPool]: On list_destination_db: Close
[0m19:40:30.119389 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m19:40:30.134280 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:40:30.136959 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m19:40:30.139189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:40:30.191783 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m19:40:30.196376 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:40:30.199817 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:40:30.215634 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m19:40:30.222039 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m19:40:30.231632 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m19:40:30.253942 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:30.256741 [debug] [MainThread]: On master: BEGIN
[0m19:40:30.258937 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:40:30.297650 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:40:30.300455 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:30.302758 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:40:30.318110 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m19:40:30.325544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91db6da8-cbee-49b0-af7d-aa95fc02d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1726d9f8e0>]}
[0m19:40:30.329767 [debug] [MainThread]: On master: ROLLBACK
[0m19:40:30.339526 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:30.343463 [debug] [MainThread]: On master: BEGIN
[0m19:40:30.357212 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:40:30.361003 [debug] [MainThread]: On master: COMMIT
[0m19:40:30.365145 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:30.369091 [debug] [MainThread]: On master: COMMIT
[0m19:40:30.376275 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:40:30.380077 [debug] [MainThread]: On master: Close
[0m19:40:30.385555 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:40:30.392594 [info ] [MainThread]: 
[0m19:40:30.436387 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m19:40:30.439755 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m19:40:30.445995 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m19:40:30.450168 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m19:40:30.458769 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m19:40:30.482028 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 19:40:30.452779 => 2024-02-08 19:40:30.481510
[0m19:40:30.486330 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m19:40:30.574285 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m19:40:30.591940 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:40:30.594257 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m19:40:30.596582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:30.642342 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:40:30.645405 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:40:30.648126 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    -- films.sql
SELECT * FROM "destination_db"."public"."films"
  );
  
[0m19:40:30.658427 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m19:40:30.679147 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:40:30.683339 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m19:40:30.693100 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:40:30.703675 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:40:30.706763 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m19:40:30.714744 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:40:30.762644 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m19:40:30.765792 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:40:30.768810 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m19:40:30.779114 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:40:30.792173 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:40:30.795274 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m19:40:30.809024 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:40:30.815375 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 19:40:30.488611 => 2024-02-08 19:40:30.815141
[0m19:40:30.818405 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m19:40:30.823147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91db6da8-cbee-49b0-af7d-aa95fc02d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1726dfcbe0>]}
[0m19:40:30.827321 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.38s]
[0m19:40:30.837686 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m19:40:30.841358 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m19:40:30.846117 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m19:40:30.851722 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m19:40:30.854998 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m19:40:30.870420 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m19:40:30.893391 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 19:40:30.861226 => 2024-02-08 19:40:30.892971
[0m19:40:30.898071 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m19:40:30.911111 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m19:40:30.934365 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:40:30.936857 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m19:40:30.939852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:30.990846 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:40:30.994064 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:40:30.997196 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m19:40:31.007474 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m19:40:31.022035 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:40:31.028660 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m19:40:31.041847 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:40:31.057250 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:40:31.060530 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m19:40:31.070964 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:40:31.079823 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m19:40:31.082991 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:40:31.085931 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m19:40:31.095434 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:40:31.104370 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:40:31.107202 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m19:40:31.118235 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:40:31.123416 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 19:40:30.901836 => 2024-02-08 19:40:31.123272
[0m19:40:31.126162 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m19:40:31.130587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91db6da8-cbee-49b0-af7d-aa95fc02d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1726c49c30>]}
[0m19:40:31.133875 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.28s]
[0m19:40:31.138559 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m19:40:31.141957 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m19:40:31.145066 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m19:40:31.149635 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m19:40:31.153238 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m19:40:31.170358 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m19:40:31.195763 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 19:40:31.156334 => 2024-02-08 19:40:31.195349
[0m19:40:31.199504 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m19:40:31.211329 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m19:40:31.226339 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:40:31.228970 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m19:40:31.231110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:31.276102 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:40:31.279688 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:40:31.282296 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m19:40:31.292288 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m19:40:31.302644 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:40:31.307237 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m19:40:31.317447 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:40:31.325627 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:40:31.329091 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m19:40:31.337965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:40:31.348138 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m19:40:31.351793 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:40:31.354270 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m19:40:31.364100 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:40:31.374009 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:40:31.376536 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m19:40:31.389952 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:40:31.395269 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 19:40:31.202658 => 2024-02-08 19:40:31.395120
[0m19:40:31.398038 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m19:40:31.401953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91db6da8-cbee-49b0-af7d-aa95fc02d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1726c861d0>]}
[0m19:40:31.406283 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.25s]
[0m19:40:31.411016 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m19:40:31.416219 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m19:40:31.419963 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m19:40:31.424921 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_ratings'
[0m19:40:31.427727 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_ratings
[0m19:40:31.440966 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_ratings"
[0m19:40:31.467910 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (compile): 2024-02-08 19:40:31.433733 => 2024-02-08 19:40:31.467524
[0m19:40:31.471551 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_ratings
[0m19:40:31.484504 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_ratings"
[0m19:40:31.503172 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m19:40:31.506585 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: BEGIN
[0m19:40:31.509228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:31.556272 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:40:31.559308 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m19:40:31.561868 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.film_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m19:40:31.570189 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.actor_name does not exist
LINE 31:         STRING_AGG(a.actor_name, ', ') AS actors  -- Aggrega...
                            ^

[0m19:40:31.575203 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: ROLLBACK
[0m19:40:31.586490 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (execute): 2024-02-08 19:40:31.473941 => 2024-02-08 19:40:31.586210
[0m19:40:31.590664 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: Close
[0m19:40:31.602881 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  column a.actor_name does not exist
  LINE 31:         STRING_AGG(a.actor_name, ', ') AS actors  -- Aggrega...
                              ^
  compiled Code at target/run/Custom_postgres/models/example/film_ratings.sql
[0m19:40:31.608288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91db6da8-cbee-49b0-af7d-aa95fc02d047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1726c85600>]}
[0m19:40:31.613362 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.18s]
[0m19:40:31.619435 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m19:40:31.625093 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:40:31.628091 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:31.633145 [debug] [MainThread]: On master: BEGIN
[0m19:40:31.636380 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:40:31.687956 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:40:31.690310 [debug] [MainThread]: On master: COMMIT
[0m19:40:31.692434 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:31.694757 [debug] [MainThread]: On master: COMMIT
[0m19:40:31.701783 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:40:31.705685 [debug] [MainThread]: On master: Close
[0m19:40:31.710002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:31.715123 [debug] [MainThread]: Connection 'model.Custom_postgres.film_ratings' was properly closed.
[0m19:40:31.720694 [info ] [MainThread]: 
[0m19:40:31.725089 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m19:40:31.729283 [debug] [MainThread]: Command end result
[0m19:40:31.775783 [info ] [MainThread]: 
[0m19:40:31.782642 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:40:31.787842 [info ] [MainThread]: 
[0m19:40:31.792702 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m19:40:31.797427 [error] [MainThread]:   column a.actor_name does not exist
[0m19:40:31.805772 [error] [MainThread]:   LINE 31:         STRING_AGG(a.actor_name, ', ') AS actors  -- Aggrega...
[0m19:40:31.810281 [error] [MainThread]:                               ^
[0m19:40:31.817157 [error] [MainThread]:   compiled Code at target/run/Custom_postgres/models/example/film_ratings.sql
[0m19:40:31.822700 [info ] [MainThread]: 
[0m19:40:31.826203 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:40:31.831285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1729366aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1727a9da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1726c97d30>]}
[0m19:40:31.835446 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 19:45:51.399209 | 7da0a3bd-e048-48cf-afb3-500267a8f27d ==============================
[0m19:45:51.399209 [info ] [MainThread]: Running with dbt=1.4.7
[0m19:45:51.405525 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:45:51.408737 [debug] [MainThread]: Tracking: tracking
[0m19:45:51.414731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d093a5360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d093a57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d093a53c0>]}
[0m19:45:51.472983 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m19:45:52.046254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:45:52.050139 [debug] [MainThread]: Partial parsing: updated file: Custom_postgres://models/example/actors.sql
[0m19:45:52.053309 [debug] [MainThread]: Partial parsing: updated file: Custom_postgres://macros/film_ratings_macro.sql
[0m19:45:52.106960 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m19:45:52.134854 [debug] [MainThread]: 1603: static parser failed on example/film_ratings.sql
[0m19:45:52.149939 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/film_ratings.sql
[0m19:45:52.294362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7da0a3bd-e048-48cf-afb3-500267a8f27d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d06967e20>]}
[0m19:45:52.339923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7da0a3bd-e048-48cf-afb3-500267a8f27d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d093bd450>]}
[0m19:45:52.344502 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m19:45:52.348671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7da0a3bd-e048-48cf-afb3-500267a8f27d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d07ae5d50>]}
[0m19:45:52.356436 [info ] [MainThread]: 
[0m19:45:52.364951 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:45:52.373183 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m19:45:52.405211 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m19:45:52.409574 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:45:52.414034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:52.475579 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m19:45:52.480509 [debug] [ThreadPool]: On list_destination_db: Close
[0m19:45:52.488703 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m19:45:52.504917 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:45:52.507760 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m19:45:52.510024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:45:52.549433 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m19:45:52.552391 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:45:52.556115 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:45:52.568970 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m19:45:52.576327 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m19:45:52.585611 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m19:45:52.612864 [debug] [MainThread]: Using postgres connection "master"
[0m19:45:52.615992 [debug] [MainThread]: On master: BEGIN
[0m19:45:52.618789 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:45:52.660726 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:45:52.663655 [debug] [MainThread]: Using postgres connection "master"
[0m19:45:52.665994 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:45:52.681573 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m19:45:52.687331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7da0a3bd-e048-48cf-afb3-500267a8f27d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d06977af0>]}
[0m19:45:52.691972 [debug] [MainThread]: On master: ROLLBACK
[0m19:45:52.700728 [debug] [MainThread]: Using postgres connection "master"
[0m19:45:52.703260 [debug] [MainThread]: On master: BEGIN
[0m19:45:52.715455 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:45:52.718847 [debug] [MainThread]: On master: COMMIT
[0m19:45:52.724956 [debug] [MainThread]: Using postgres connection "master"
[0m19:45:52.729630 [debug] [MainThread]: On master: COMMIT
[0m19:45:52.738056 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:45:52.742423 [debug] [MainThread]: On master: Close
[0m19:45:52.747417 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:45:52.751297 [info ] [MainThread]: 
[0m19:45:52.793938 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m19:45:52.797686 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m19:45:52.804336 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m19:45:52.809600 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m19:45:52.819798 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m19:45:52.846514 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 19:45:52.813649 => 2024-02-08 19:45:52.846140
[0m19:45:52.849420 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m19:45:52.935219 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m19:45:52.957288 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:45:52.960249 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m19:45:52.963519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:53.005528 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:45:53.008339 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:45:53.010894 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    -- films.sql
SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m19:45:53.021111 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m19:45:53.041163 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:45:53.045767 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m19:45:53.054236 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:45:53.065042 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:45:53.067954 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m19:45:53.076649 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:45:53.123333 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m19:45:53.126202 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:45:53.128517 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m19:45:53.143943 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:45:53.158923 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:45:53.161877 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m19:45:53.176579 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:45:53.182419 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 19:45:52.853535 => 2024-02-08 19:45:53.182263
[0m19:45:53.185293 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m19:45:53.189944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7da0a3bd-e048-48cf-afb3-500267a8f27d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d06835db0>]}
[0m19:45:53.193788 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.39s]
[0m19:45:53.201371 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m19:45:53.204879 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m19:45:53.209319 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m19:45:53.215501 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m19:45:53.219608 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m19:45:53.231616 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m19:45:53.263429 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 19:45:53.224428 => 2024-02-08 19:45:53.263051
[0m19:45:53.266097 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m19:45:53.279867 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m19:45:53.299860 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:45:53.302515 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m19:45:53.305118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:53.346572 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:45:53.349827 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:45:53.352494 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m19:45:53.363563 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m19:45:53.372452 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:45:53.376721 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m19:45:53.385625 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:45:53.397007 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:45:53.400451 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m19:45:53.413018 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:45:53.420069 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m19:45:53.423455 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:45:53.427117 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m19:45:53.439248 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:45:53.447013 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:45:53.449551 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m19:45:53.463491 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:45:53.468809 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 19:45:53.268658 => 2024-02-08 19:45:53.468162
[0m19:45:53.472841 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m19:45:53.477733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7da0a3bd-e048-48cf-afb3-500267a8f27d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d06835f60>]}
[0m19:45:53.481491 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.26s]
[0m19:45:53.485951 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m19:45:53.490099 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m19:45:53.493540 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m19:45:53.498127 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m19:45:53.502612 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m19:45:53.515053 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m19:45:53.536534 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 19:45:53.505705 => 2024-02-08 19:45:53.536149
[0m19:45:53.540105 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m19:45:53.551990 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m19:45:53.568724 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:45:53.570954 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m19:45:53.573749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:53.610749 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:45:53.613198 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:45:53.615921 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m19:45:53.627182 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m19:45:53.639520 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:45:53.643349 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m19:45:53.651073 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:45:53.664762 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:45:53.669292 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m19:45:53.679438 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:45:53.685760 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m19:45:53.688855 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:45:53.692569 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m19:45:53.706581 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:45:53.713414 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:45:53.716178 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m19:45:53.731109 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:45:53.736343 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 19:45:53.543416 => 2024-02-08 19:45:53.736203
[0m19:45:53.739104 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m19:45:53.743740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7da0a3bd-e048-48cf-afb3-500267a8f27d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0689f1c0>]}
[0m19:45:53.747391 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.25s]
[0m19:45:53.752349 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m19:45:53.756765 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m19:45:53.760507 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m19:45:53.767242 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_ratings'
[0m19:45:53.770239 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_ratings
[0m19:45:53.784464 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_ratings"
[0m19:45:53.812159 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (compile): 2024-02-08 19:45:53.774539 => 2024-02-08 19:45:53.811808
[0m19:45:53.815254 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_ratings
[0m19:45:53.826189 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_ratings"
[0m19:45:53.847366 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m19:45:53.849935 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: BEGIN
[0m19:45:53.852315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:53.895463 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:45:53.898030 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m19:45:53.900905 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m19:45:53.934028 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m19:45:53.946173 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m19:45:53.949723 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m19:45:53.961032 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:45:53.967137 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: COMMIT
[0m19:45:53.969541 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m19:45:53.972296 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: COMMIT
[0m19:45:53.985144 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:45:53.993250 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m19:45:53.995981 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m19:45:54.003274 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:45:54.008797 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (execute): 2024-02-08 19:45:53.817357 => 2024-02-08 19:45:54.008645
[0m19:45:54.012435 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: Close
[0m19:45:54.017312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7da0a3bd-e048-48cf-afb3-500267a8f27d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d06883040>]}
[0m19:45:54.021372 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.25s]
[0m19:45:54.026032 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m19:45:54.031849 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:45:54.034842 [debug] [MainThread]: Using postgres connection "master"
[0m19:45:54.037273 [debug] [MainThread]: On master: BEGIN
[0m19:45:54.040055 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:45:54.089888 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:45:54.094576 [debug] [MainThread]: On master: COMMIT
[0m19:45:54.097804 [debug] [MainThread]: Using postgres connection "master"
[0m19:45:54.100548 [debug] [MainThread]: On master: COMMIT
[0m19:45:54.108772 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:45:54.113130 [debug] [MainThread]: On master: Close
[0m19:45:54.117301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:45:54.121472 [debug] [MainThread]: Connection 'model.Custom_postgres.film_ratings' was properly closed.
[0m19:45:54.127663 [info ] [MainThread]: 
[0m19:45:54.131648 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.77 seconds (1.77s).
[0m19:45:54.135324 [debug] [MainThread]: Command end result
[0m19:45:54.187219 [info ] [MainThread]: 
[0m19:45:54.194518 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:45:54.200964 [info ] [MainThread]: 
[0m19:45:54.205559 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:45:54.211751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d06977af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0689fa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0689f880>]}
[0m19:45:54.216720 [debug] [MainThread]: Flushing usage events


============================== 2024-02-08 19:50:31.214865 | de8c1adb-2142-4d5c-b69e-c26406ef3e55 ==============================
[0m19:50:31.214865 [info ] [MainThread]: Running with dbt=1.4.7
[0m19:50:31.223001 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:50:31.226874 [debug] [MainThread]: Tracking: tracking
[0m19:50:31.234951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f1c88b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f1c8afb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f1c88b20>]}
[0m19:50:31.294575 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m19:50:31.860677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:50:31.864025 [debug] [MainThread]: Partial parsing: added file: Custom_postgres://models/example/specific_movie.sql
[0m19:50:31.907290 [debug] [MainThread]: 1603: static parser failed on example/specific_movie.sql
[0m19:50:31.940045 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/specific_movie.sql
[0m19:50:31.981139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de8c1adb-2142-4d5c-b69e-c26406ef3e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f01ba0e0>]}
[0m19:50:32.029415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de8c1adb-2142-4d5c-b69e-c26406ef3e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f0363010>]}
[0m19:50:32.033980 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m19:50:32.038464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de8c1adb-2142-4d5c-b69e-c26406ef3e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f0362fb0>]}
[0m19:50:32.045365 [info ] [MainThread]: 
[0m19:50:32.054300 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:50:32.061945 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m19:50:32.094454 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m19:50:32.100640 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:50:32.105045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:32.150305 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m19:50:32.154958 [debug] [ThreadPool]: On list_destination_db: Close
[0m19:50:32.161700 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m19:50:32.176577 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:50:32.179500 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m19:50:32.181667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:32.223288 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m19:50:32.226544 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:50:32.229885 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:50:32.248373 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m19:50:32.258775 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m19:50:32.267731 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m19:50:32.295766 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:32.298681 [debug] [MainThread]: On master: BEGIN
[0m19:50:32.302103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:50:32.343740 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:50:32.346695 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:32.349934 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:50:32.370095 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m19:50:32.378089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de8c1adb-2142-4d5c-b69e-c26406ef3e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f0393190>]}
[0m19:50:32.381591 [debug] [MainThread]: On master: ROLLBACK
[0m19:50:32.391728 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:32.395277 [debug] [MainThread]: On master: BEGIN
[0m19:50:32.409289 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:50:32.412945 [debug] [MainThread]: On master: COMMIT
[0m19:50:32.415864 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:32.420563 [debug] [MainThread]: On master: COMMIT
[0m19:50:32.428120 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:50:32.430569 [debug] [MainThread]: On master: Close
[0m19:50:32.434700 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:50:32.439787 [info ] [MainThread]: 
[0m19:50:32.461920 [debug] [Thread-1 (]: Began running node model.Custom_postgres.actors
[0m19:50:32.468412 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m19:50:32.476731 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.actors'
[0m19:50:32.479968 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.actors
[0m19:50:32.490899 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.actors"
[0m19:50:32.512003 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (compile): 2024-02-08 19:50:32.482879 => 2024-02-08 19:50:32.511631
[0m19:50:32.514153 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.actors
[0m19:50:32.608943 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.actors"
[0m19:50:32.630207 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:50:32.632829 [debug] [Thread-1 (]: On model.Custom_postgres.actors: BEGIN
[0m19:50:32.635397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:32.676179 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:50:32.678766 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:50:32.681408 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    -- films.sql
SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m19:50:32.691373 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m19:50:32.713831 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:50:32.717324 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m19:50:32.727456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:50:32.738958 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:50:32.743084 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m19:50:32.751481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:50:32.803818 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m19:50:32.806723 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:50:32.809239 [debug] [Thread-1 (]: On model.Custom_postgres.actors: COMMIT
[0m19:50:32.820860 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:50:32.834055 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.actors"
[0m19:50:32.836926 [debug] [Thread-1 (]: On model.Custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m19:50:32.850642 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:50:32.856094 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.actors (execute): 2024-02-08 19:50:32.516342 => 2024-02-08 19:50:32.855945
[0m19:50:32.859176 [debug] [Thread-1 (]: On model.Custom_postgres.actors: Close
[0m19:50:32.863527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de8c1adb-2142-4d5c-b69e-c26406ef3e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f02017e0>]}
[0m19:50:32.871680 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 40[0m in 0.39s]
[0m19:50:32.878560 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.actors
[0m19:50:32.881812 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_actors
[0m19:50:32.885297 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m19:50:32.890029 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_actors'
[0m19:50:32.894008 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_actors
[0m19:50:32.906125 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_actors"
[0m19:50:32.936783 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (compile): 2024-02-08 19:50:32.897608 => 2024-02-08 19:50:32.936246
[0m19:50:32.940679 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_actors
[0m19:50:32.954472 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_actors"
[0m19:50:32.973218 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:50:32.975585 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: BEGIN
[0m19:50:32.978005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:33.019203 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:50:33.021466 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:50:33.023610 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m19:50:33.036212 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m19:50:33.051640 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:50:33.055806 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m19:50:33.064402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:50:33.077956 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:50:33.082442 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m19:50:33.092232 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:50:33.098691 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m19:50:33.101562 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:50:33.104218 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: COMMIT
[0m19:50:33.116455 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:50:33.124387 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_actors"
[0m19:50:33.126568 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m19:50:33.139295 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:50:33.144299 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_actors (execute): 2024-02-08 19:50:32.943970 => 2024-02-08 19:50:33.144052
[0m19:50:33.146998 [debug] [Thread-1 (]: On model.Custom_postgres.film_actors: Close
[0m19:50:33.151209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de8c1adb-2142-4d5c-b69e-c26406ef3e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f0201b70>]}
[0m19:50:33.154715 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 40[0m in 0.26s]
[0m19:50:33.158741 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_actors
[0m19:50:33.161625 [debug] [Thread-1 (]: Began running node model.Custom_postgres.films
[0m19:50:33.164220 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m19:50:33.168812 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.films'
[0m19:50:33.171743 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.films
[0m19:50:33.189408 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.films"
[0m19:50:33.215058 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (compile): 2024-02-08 19:50:33.174913 => 2024-02-08 19:50:33.214454
[0m19:50:33.218571 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.films
[0m19:50:33.239480 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.films"
[0m19:50:33.254377 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:50:33.256868 [debug] [Thread-1 (]: On model.Custom_postgres.films: BEGIN
[0m19:50:33.258971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:33.300085 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:50:33.302701 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:50:33.305553 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m19:50:33.314540 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m19:50:33.332249 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:50:33.336703 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m19:50:33.345605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:50:33.356704 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:50:33.359119 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m19:50:33.366059 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:50:33.373560 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m19:50:33.376244 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:50:33.378192 [debug] [Thread-1 (]: On model.Custom_postgres.films: COMMIT
[0m19:50:33.389226 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:50:33.396135 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.films"
[0m19:50:33.398640 [debug] [Thread-1 (]: On model.Custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m19:50:33.412202 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:50:33.418761 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.films (execute): 2024-02-08 19:50:33.222003 => 2024-02-08 19:50:33.418615
[0m19:50:33.421382 [debug] [Thread-1 (]: On model.Custom_postgres.films: Close
[0m19:50:33.426206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de8c1adb-2142-4d5c-b69e-c26406ef3e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ee095720>]}
[0m19:50:33.429686 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 40[0m in 0.26s]
[0m19:50:33.434437 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.films
[0m19:50:33.439703 [debug] [Thread-1 (]: Began running node model.Custom_postgres.film_ratings
[0m19:50:33.443554 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m19:50:33.448601 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.film_ratings'
[0m19:50:33.453321 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.film_ratings
[0m19:50:33.469929 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.film_ratings"
[0m19:50:33.498985 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (compile): 2024-02-08 19:50:33.458155 => 2024-02-08 19:50:33.498652
[0m19:50:33.503429 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.film_ratings
[0m19:50:33.515494 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.film_ratings"
[0m19:50:33.538181 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m19:50:33.540813 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: BEGIN
[0m19:50:33.543297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:33.583731 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:50:33.586771 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m19:50:33.589190 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m19:50:33.616385 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m19:50:33.627712 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m19:50:33.631159 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings" rename to "film_ratings__dbt_backup"
[0m19:50:33.640650 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:50:33.650158 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m19:50:33.653450 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m19:50:33.662359 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:50:33.668689 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: COMMIT
[0m19:50:33.671687 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m19:50:33.674013 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: COMMIT
[0m19:50:33.689397 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:50:33.700229 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.film_ratings"
[0m19:50:33.703031 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m19:50:33.716776 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:50:33.721735 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.film_ratings (execute): 2024-02-08 19:50:33.507039 => 2024-02-08 19:50:33.721597
[0m19:50:33.724540 [debug] [Thread-1 (]: On model.Custom_postgres.film_ratings: Close
[0m19:50:33.728671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de8c1adb-2142-4d5c-b69e-c26406ef3e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ee0c2ce0>]}
[0m19:50:33.732668 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 40[0m in 0.28s]
[0m19:50:33.737381 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.film_ratings
[0m19:50:33.740673 [debug] [Thread-1 (]: Began running node model.Custom_postgres.specific_movie
[0m19:50:33.744369 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m19:50:33.750041 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Custom_postgres.specific_movie'
[0m19:50:33.755080 [debug] [Thread-1 (]: Began compiling node model.Custom_postgres.specific_movie
[0m19:50:33.768955 [debug] [Thread-1 (]: Writing injected SQL for node "model.Custom_postgres.specific_movie"
[0m19:50:33.799672 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.specific_movie (compile): 2024-02-08 19:50:33.758452 => 2024-02-08 19:50:33.799114
[0m19:50:33.804129 [debug] [Thread-1 (]: Began executing node model.Custom_postgres.specific_movie
[0m19:50:33.817222 [debug] [Thread-1 (]: Writing runtime sql for node "model.Custom_postgres.specific_movie"
[0m19:50:33.835169 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.specific_movie"
[0m19:50:33.837654 [debug] [Thread-1 (]: On model.Custom_postgres.specific_movie: BEGIN
[0m19:50:33.840291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:33.879601 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m19:50:33.881963 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.specific_movie"
[0m19:50:33.884899 [debug] [Thread-1 (]: On model.Custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    

SELECT *
FROM "destination_db"."public"."films"
WHERE title = 'Dunkirk'
  );
  
[0m19:50:33.894993 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m19:50:33.907470 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.specific_movie"
[0m19:50:33.911588 [debug] [Thread-1 (]: On model.Custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m19:50:33.921543 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m19:50:33.927412 [debug] [Thread-1 (]: On model.Custom_postgres.specific_movie: COMMIT
[0m19:50:33.930103 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.specific_movie"
[0m19:50:33.932632 [debug] [Thread-1 (]: On model.Custom_postgres.specific_movie: COMMIT
[0m19:50:33.950436 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m19:50:33.959910 [debug] [Thread-1 (]: Using postgres connection "model.Custom_postgres.specific_movie"
[0m19:50:33.962554 [debug] [Thread-1 (]: On model.Custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "Custom_postgres", "target_name": "dev", "node_id": "model.Custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m19:50:33.969654 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m19:50:33.975115 [debug] [Thread-1 (]: Timing info for model.Custom_postgres.specific_movie (execute): 2024-02-08 19:50:33.807876 => 2024-02-08 19:50:33.974963
[0m19:50:33.977360 [debug] [Thread-1 (]: On model.Custom_postgres.specific_movie: Close
[0m19:50:33.981481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de8c1adb-2142-4d5c-b69e-c26406ef3e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ee0cb850>]}
[0m19:50:33.985408 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 2[0m in 0.23s]
[0m19:50:33.989774 [debug] [Thread-1 (]: Finished running node model.Custom_postgres.specific_movie
[0m19:50:33.996214 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:50:33.999184 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:34.002342 [debug] [MainThread]: On master: BEGIN
[0m19:50:34.006103 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:50:34.053294 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:50:34.057377 [debug] [MainThread]: On master: COMMIT
[0m19:50:34.059455 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:34.061321 [debug] [MainThread]: On master: COMMIT
[0m19:50:34.069135 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:50:34.074337 [debug] [MainThread]: On master: Close
[0m19:50:34.080149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:34.087655 [debug] [MainThread]: Connection 'model.Custom_postgres.specific_movie' was properly closed.
[0m19:50:34.094331 [info ] [MainThread]: 
[0m19:50:34.099184 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m19:50:34.107715 [debug] [MainThread]: Command end result
[0m19:50:34.163552 [info ] [MainThread]: 
[0m19:50:34.169266 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:50:34.175286 [info ] [MainThread]: 
[0m19:50:34.182260 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:50:34.188668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f0363a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f0393190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f033e860>]}
[0m19:50:34.194226 [debug] [MainThread]: Flushing usage events
